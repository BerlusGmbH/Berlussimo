#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass scrbook
\begin_preamble
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize a4paper
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Subsection
BAUSTELLEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BAUSTELLEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `A_DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `E_DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BESCHREIBUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`,`KOSTENTRAEGER_TYP`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=74 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
A_DATUM 
\end_layout
\begin_layout Description
E_DATUM 
\end_layout
\begin_layout Description
BESCHREIBUNG 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' && AKTIV='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BAUSTELLEN ORDER BY DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BAUSTELLEN ORDER BY DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM BAUSTELLEN_EXT WHERE BEZ='$bau_bez' && AKTUELL = '1' ORDER BY ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BAUSTELLEN_EXT WHERE ID='$bau_id' && AKTUELL = '1' ORDER BY ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->bez = $row ['BEZ'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BAUSTELLEN_EXT VALUES (NULL, '$last_id', '$bau_bez', '$p_id', '1','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BAUSTELLEN_EXT WHERE AKTUELL='1' && AKTIV='$aktiv' ORDER BY BEZ, PARTNER_ID";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BAUSTELLEN_EXT SET AKTIV='$aktiv' WHERE ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BAUSTELLEN_EXT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BAUSTELLEN_EXT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZ` varchar(200) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTIV` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=41 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BEZ 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
AKTIV 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' && AKTIV='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM BAUSTELLEN_EXT WHERE BEZ='$bau_bez' && AKTUELL = '1' ORDER BY ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BAUSTELLEN_EXT WHERE ID='$bau_id' && AKTUELL = '1' ORDER BY ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->bez = $row ['BEZ'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BAUSTELLEN_EXT VALUES (NULL, '$last_id', '$bau_bez', '$p_id', '1','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BAUSTELLEN_EXT WHERE AKTUELL='1' && AKTIV='$aktiv' ORDER BY BEZ, PARTNER_ID";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BAUSTELLEN_EXT SET AKTIV='$aktiv' WHERE ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, BEZ  FROM `BAUSTELLEN_EXT`  WHERE AKTUELL='1' ORDER BY BEZ ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $ID, $BEZ ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BAU_BELEG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BAU_BELEG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `BAU_BELEG`" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BELEG2RG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BELEG2RG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_P_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=145 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
EMPF_P_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `BELEG2RG` ORDER BY EMPF_P_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BELEG2RG VALUES (NULL, '$beleg_nr', '$p_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'BELEG2RG', $last_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BENUTZER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BENUTZER` (

\end_layout
\begin_layout Plain Layout

  `benutzer_id` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `benutzername` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `passwort` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STUNDENSATZ` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEB_DAT` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `GEWERK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINTRITT` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSTRITT` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `URLAUB` int(2) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `STUNDEN_PW` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  KEY `benutzer_id` (`benutzer_id`),

\end_layout
\begin_layout Plain Layout

  KEY `benutzername` (`benutzername`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=74 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
benutzer_id 
\end_layout
\begin_layout Description
benutzername 
\end_layout
\begin_layout Description
passwort 
\end_layout
\begin_layout Description
STUNDENSATZ 
\end_layout
\begin_layout Description
GEB_DAT 
\end_layout
\begin_layout Description
GEWERK_ID 
\end_layout
\begin_layout Description
EINTRITT 
\end_layout
\begin_layout Description
AUSTRITT 
\end_layout
\begin_layout Description
URLAUB 
\end_layout
\begin_layout Description
STUNDEN_PW 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT benutzer_id, benutzername  FROM `BENUTZER` ORDER BY benutzername ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $benutzer_id, $benutzername ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BM_DAT FROM BENUTZER_MODULE WHERE BENUTZER_ID='$benutzer_id' && (MODUL_NAME='$module_name' OR MODUL_NAME='*') && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO ZUGRIFF_ERROR VALUES(NULL, '$benutzer_id','$wer', NULL, '$module_name', '$ip', '$host')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BM_DAT FROM BENUTZER_MODULE WHERE BENUTZER_ID='$benutzer_id' && (MODUL_NAME='$module_name' OR MODUL_NAME='*') && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS STUNDEN  FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) WHERE `BENUTZER_ID` = '$mitarbeiter_id' AND STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$typ' && KOSTENTRAEGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS G_STD FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM(DAUER_MIN)/60 AS STD, $preis*(SUM(DAUER_MIN)/60) AS LEISTUNG_EUR FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id' GROUP BY STUNDENZETTEL.BENUTZER_ID ORDER BY STD DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage.'<br>';
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_personal.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$gk_id' && `AKTUELL` = '1' && VERWENDUNGSZWECK LIKE '%$benutzername%' && KONTENRAHMEN_KONTO='$konto' ORDER BY G_BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO TODO_LISTE VALUES (NULL, '$last_id', '$t_id', '$_REQUEST[text]', NULL, '$anz_ab','$typ', '$_REQUEST[benutzer_id]','$_SESSION[benutzer_id]', '0','$_REQUEST[akut]','$_REQUEST[kostentraeger_typ]','$kostentraeger_id', '$wert_eur','1')";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function rss_feed_ok_test($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID!='0' && ERLEDIGT='$erl' ORDER BY KOS_TYP, KOS_ID, UE_ID, VERFASSER_ID, ANZEIGEN_AB ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' && T_ID NOT IN (SELECT UE_ID FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID!='0' && ERLEDIGT='$erl') ORDER BY KOS_TYP, KOS_ID, UE_ID, VERFASSER_ID, ANZEIGEN_AB ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' ORDER BY VERFASSER_ID, BENUTZER_ID, TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * 	FROM `TODO_LISTE` 	WHERE (	`BENUTZER_ID` ='$benutzer_id'	OR `VERFASSER_ID` ='$benutzer_id' )
        \end_layout
            \begin_layout Plain Layout
        AND `AKTUELL` = '1' AND ERLEDIGT='$erl' ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE TODO_LISTE SET TEXT='$_REQUEST[text]', ANZEIGEN_AB='$anz_ab', BENUTZER_ID='$_REQUEST[benutzer_id]', ERLEDIGT='$erledigt', AKUT='$_REQUEST[akut]', KOS_TYP='$_REQUEST[kostentraeger_typ]', KOS_ID='$kostentraeger_id' WHERE T_DAT='$this->t_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten ( "?daten=todo" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * 	FROM `TODO_LISTE` 	WHERE BENUTZER_TYP='$typ' && `BENUTZER_ID` ='$id' AND `AKTUELL` = '1' AND ERLEDIGT='$erl' ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage."<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GEWERK_ID FROM BENUTZER  WHERE benutzer_id='$benutzer_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->gewerk_id = $row ['GEWERK_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT STUNDENSATZ FROM `BENUTZER` WHERE `BENUTZER_ID` = '$benutzer_id' ORDER BY benutzer_id DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['STUNDENSATZ'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID, STUNDENZETTEL.BENUTZER_ID, BESCHREIBUNG, ERFASSUNGSDATUM, benutzername, STUNDENSATZ, STUNDEN_PW  FROM STUNDENZETTEL JOIN  BENUTZER ON (STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id) WHERE ZETTEL_ID='$id' && AKTUELL = '1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(*) AS ZAHL FROM `STUNDENZETTEL` WHERE `BENUTZER_ID` = '$benutzer_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZAHL'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID, BESCHREIBUNG, ERFASSUNGSDATUM FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY ERFASSUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function stundenzettel_anlegen($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function stundenzettel_speichern($benutzer_id, $beschreibung) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY ZETTEL_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BP_PARTNER_ID FROM BENUTZER_PARTNER WHERE BP_BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY BP_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzername FROM BENUTZER WHERE benutzer_id='$benutzer_id' ORDER BY benutzer_id DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID) WHERE AUSTRITT > '$datum_h' OR AUSTRITT ='0000-00-00' GROUP BY benutzer_id  ORDER BY  benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  GROUP BY benutzer_id  ORDER BY benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  GROUP BY benutzer_id  ORDER BY benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id'  && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BENUTZER_ID FROM STUNDENZETTEL WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1' ORDER BY ZETTEL_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_tage_urlaub_offen_arr($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM NOT IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM  IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT STUNDENZETTEL_POS.ZETTEL_ID, STUNDENZETTEL.BESCHREIBUNG FROM `STUNDENZETTEL_POS` , STUNDENZETTEL
        \end_layout
            \begin_layout Plain Layout
        WHERE `DATUM` = '$datum' AND STUNDENZETTEL_POS.`AKTUELL` = '1' && STUNDENZETTEL.`AKTUELL` = '1' && STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID && STUNDENZETTEL.BENUTZER_ID = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $zettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID,BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60 ) AS STD, SUM( BENUTZER.STUNDENSATZ * DAUER_MIN /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `W_TERMINE` WHERE DATE_FORMAT( TERMIN, '%Y-%m-%d' ) = '$datum_sql'  && DATE_FORMAT( TERMIN, '%H:%i' )= '$zeit' && BENUTZER_ID='$benutzer_id' && PLAN_ID='$plan_id' && ABGESAGT='0'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATE_FORMAT(TERMIN, '%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN, '%H:%i') AS ZEIT, BENUTZER_ID FROM `W_TERMINE` WHERE GERAETE_ID='$geraete_id' && DATE_FORMAT( TERMIN, '%Y' ) = YEAR( NOW( ) )  && PLAN_ID='$plan_id'  && ABGESAGT='0'  && TERMIN >NOW()  ORDER BY TERMIN DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(TERMIN,'%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT FROM W_TERMINE WHERE PLAN_ID='$plan_id' && BENUTZER_ID='$benutzer_id' && DATE_FORMAT(TERMIN,'%Y-%m-%d') BETWEEN '$ab' AND '$bis' ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(TERMIN,'%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT FROM W_TERMINE WHERE PLAN_ID='$plan_id' && DATE_FORMAT(TERMIN,'%Y-%m-%d') BETWEEN '$ab' AND '$bis' ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT, GERAETE_ID, ABGESAGT, DAUER_MIN FROM `W_TERMINE` WHERE DATE_FORMAT( TERMIN, '%Y-%m-%d' ) = '$datum_sql'  &&  BENUTZER_ID='$benutzer_id' && AKTUELL='1' && PLAN_ID='$plan_id'   ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO W_TERMINE VALUES (NULL, '$plan_id', '$termin_dat_zeit', '$dauer','$geraete_id', '$benutzer_id', '0', NULL, NULL,NULL,NULL, NULL, '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WARTUNGEN VALUES (NULL, '$geraete_id', '$plan_id', '$wartungsdatum','$benutzer_id', '$bemerkung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, URLAUB, EINTRITT, AUSTRITT FROM BENUTZER WHERE DATE_FORMAT(EINTRITT, '%Y') <= '$jahr' &&  (DATE_FORMAT(AUSTRITT, '%Y') >= '$jahr' OR AUSTRITT='0000-00-00') && DATE_FORMAT(AUSTRITT, '%Y-%m-%d') < '$datum_h' ORDER BY benutzername ASC " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzername, URLAUB AS ANSPRUCH, SUM( ANTEIL )  AS GEPLANT , URLAUB - SUM( ANTEIL ) AS REST
        \end_layout
            \begin_layout Plain Layout
        FROM `URLAUB` , BENUTZER
        \end_layout
            \begin_layout Plain Layout
        WHERE URLAUB.ART = '$art' && URLAUB.BENUTZER_ID = BENUTZER.benutzer_id && URLAUB.BENUTZER_ID='$benutzer_id' && DATE_FORMAT( DATUM, '%Y' ) = '$jahr' && DATUM> CURDATE() && AKTUELL='1'  GROUP BY URLAUB.`BENUTZER_ID` LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzername, URLAUB AS ANSPRUCH, SUM( ANTEIL )  AS GENOMMEN , URLAUB - SUM( ANTEIL ) AS REST
        \end_layout
            \begin_layout Plain Layout
        FROM `URLAUB` , BENUTZER
        \end_layout
            \begin_layout Plain Layout
        WHERE URLAUB.ART = '$art' && URLAUB.BENUTZER_ID = BENUTZER.benutzer_id && URLAUB.BENUTZER_ID='$benutzer_id' && DATE_FORMAT( DATUM, '%Y' ) = '$jahr' && DATUM<= CURDATE() && AKTUELL='1' GROUP BY URLAUB.`BENUTZER_ID` LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BENUTZER WHERE benutzer_id='$benutzer_id'  LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BENUTZER WHERE benutzer_id='$benutzer_id'  LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_DAT, benutzername, ANTRAG_D, DATUM, ANTEIL, ART from BENUTZER JOIN URLAUB ON (BENUTZER.benutzer_id = URLAUB.BENUTZER_ID) WHERE BENUTZER.benutzer_id='$benutzer_id' && DATE_FORMAT(URLAUB.DATUM, '%Y') = '$jahr' && AKTUELL='1' ORDER BY  DATUM ASC " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_DAT, benutzername, ANTRAG_D, DATUM, ANTEIL, ART from BENUTZER JOIN URLAUB ON (BENUTZER.benutzer_id = URLAUB.BENUTZER_ID) WHERE BENUTZER.benutzer_id='$benutzer_id' && DATE_FORMAT(URLAUB.DATUM, '%Y') = '$jahr' && AKTUELL='1' ORDER BY DATUM ASC " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function tage_arr($benutzer_id, $datum_a, $datum_e, $art = 'Urlaub') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO URLAUB VALUES (NULL, '$benutzer_id','$datum_heute','$datum', '$anteil', '1', '$art')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM URLAUB WHERE DATUM='$datum' && BENUTZER_ID='$benutzer_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE URLAUB SET AKTUELL='0' WHERE DATUM='$datum' && BENUTZER_ID='$benutzer_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "gelöscht";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM URLAUB WHERE AKTUELL='1' && BENUTZER_ID='$benutzer_id' && DATUM='$datum'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM BENUTZER WHERE BENUTZER_ID='$benutzer_id' && DATE_FORMAT(GEB_DAT, '%d-%m') ='$tag-$monat' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID IS NOT NULL ORDER BY BENUTZER_ID, ARTIKEL_NR";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID=NULL WHERE AKTUELL='1' && ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID=NULL WHERE AKTUELL='1' && BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID='$b_id' WHERE ID='$w_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BENUTZER .  *  FROM BENUTZER  ORDER BY `BENUTZER`.`benutzername` ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BENUTZER .  *  FROM BENUTZER  ORDER BY `BENUTZER`.`benutzername` ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $heute = date ( "Y-m-d" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BENUTZER .  *  FROM BENUTZER WHERE (AUSTRITT='0000-00-00' OR AUSTRITT>='$heute') ORDER BY `BENUTZER`.`benutzername` ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  WHERE benutzer_id='$b_id' GROUP BY benutzer_id  ORDER BY `BP_PARTNER_ID`, GEWERK_ID, benutzername ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BENUTZER  WHERE benutzer_id='$b_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id FROM BENUTZER WHERE benutzername='$benutzername' ORDER BY benutzer_id DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['benutzer_id'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *  FROM BENUTZER_MODULE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY MODUL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"benutzer_id\">Mitarbeiter wählen</label><select id=\"benutzer_id\" name=\"benutzer_id\" size=\"1\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anz; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $benutzername = $benutzer_arr [$a] ['benutzername'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\" selected>$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\">$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\" selected>$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\">$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "Keine Mitarbeiter, bitte mitarbeiter unter Menüpunkt -> Benutzer anlegen";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"Alle\" selected>Alle</option>";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anz; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $benutzername = $benutzer_arr [$a] [benutzername];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\" selected>$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$benutzer_id\">$benutzername</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "Keine Mitarbeiter, bitte mitarbeiter unter Menüpunkt -> Benutzer anlegen";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER VALUES ('$last_id', '$benutzername', '$passwort', '$stundensatz', '$geb_dat', '$gewerk_id', '$eintritt', '$austritt', '$urlaub', '$stunden_pw')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_PARTNER VALUES (NULL, '$last_id', '$partner_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Benutzer ID zurückgeben */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BENUTZER SET benutzername='$benutzername', passwort='$passwort', STUNDENSATZ='$stundensatz', GEB_DAT='$geb_dat', GEWERK_ID='$gewerk_id', EINTRITT='$eintritt', AUSTRITT='$austritt', URLAUB='$urlaub', STUNDEN_PW='$stunden_pw' WHERE benutzer_id='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BENUTZER_PARTNER SET BP_PARTNER_ID='$partner_id' WHERE BP_BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '*', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '$mod', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '$modul_name', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id' && MODUL_NAME='$modul_name'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    index.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT benutzername FROM BENUTZER WHERE benutzername='$benutzername' && passwort='$passwort' ";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage1 = mysql_escape_string($db_abfrage);
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage; die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    index.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id FROM BENUTZER WHERE benutzername='$benutzername' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BENUTZER_MODULE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BENUTZER_MODULE` (

\end_layout
\begin_layout Plain Layout

  `BM_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BM_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MODUL_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BM_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1844 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BM_DAT 
\end_layout
\begin_layout Description
BM_ID 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
MODUL_NAME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BM_DAT FROM BENUTZER_MODULE WHERE BENUTZER_ID='$benutzer_id' && (MODUL_NAME='$module_name' OR MODUL_NAME='*') && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BM_DAT FROM BENUTZER_MODULE WHERE BENUTZER_ID='$benutzer_id' && (MODUL_NAME='$module_name' OR MODUL_NAME='*') && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *  FROM BENUTZER_MODULE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY MODUL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '*', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '$mod', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_MODULE VALUES(NULL,'0', '$b_id', '$modul_name', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE  FROM BENUTZER_MODULE WHERE BENUTZER_ID='$b_id' && MODUL_NAME='$modul_name'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BENUTZER_PARTNER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BENUTZER_PARTNER` (

\end_layout
\begin_layout Plain Layout

  `BP_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BP_BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BP_PARTNER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BP_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=72 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BP_DAT 
\end_layout
\begin_layout Description
BP_BENUTZER_ID 
\end_layout
\begin_layout Description
BP_PARTNER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BP_PARTNER_ID FROM BENUTZER_PARTNER WHERE BP_BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY BP_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID) WHERE AUSTRITT > '$datum_h' OR AUSTRITT ='0000-00-00' GROUP BY benutzer_id  ORDER BY  benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  GROUP BY benutzer_id  ORDER BY benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, BP_PARTNER_ID FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  GROUP BY benutzer_id  ORDER BY benutzername ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BENUTZER JOIN BENUTZER_PARTNER ON (benutzer_id=BP_BENUTZER_ID)  WHERE benutzer_id='$b_id' GROUP BY benutzer_id  ORDER BY `BP_PARTNER_ID`, GEWERK_ID, benutzername ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER_PARTNER VALUES (NULL, '$last_id', '$partner_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Benutzer ID zurückgeben */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BENUTZER_PARTNER SET BP_PARTNER_ID='$partner_id' WHERE BP_BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BERICHTE_USER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BERICHTE_USER` (

\end_layout
\begin_layout Plain Layout

  `B_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_NAME` varchar(50) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_PASS` varchar(50) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_EMAIL` varchar(100) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_VORNAME` varchar(100) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_NACHNAME` char(100) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`B_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
B_DAT 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
B_NAME 
\end_layout
\begin_layout Description
B_PASS 
\end_layout
\begin_layout Description
B_EMAIL 
\end_layout
\begin_layout Description
B_VORNAME 
\end_layout
\begin_layout Description
B_NACHNAME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
BK_ABRECHNUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_ABRECHNUNGEN` (

\end_layout
\begin_layout Plain Layout

  `B_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROFIL_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROFIL_BEZ` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROFIL_JAHR` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WIRT_E` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WIRT_NAME` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANZ_EINHEITEN` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `QM_GESAMT` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `QM_WOHNRAUM` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `QM_GEWERBE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANZ_KONTEN` int(5) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANZ_ABRECHNUNGEN` varchar(6) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ERSTELLT` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `ERSTELLER` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`B_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
B_DAT 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
PROFIL_ID 
\end_layout
\begin_layout Description
PROFIL_BEZ 
\end_layout
\begin_layout Description
PROFIL_JAHR 
\end_layout
\begin_layout Description
WIRT_E 
\end_layout
\begin_layout Description
WIRT_NAME 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
ANZ_EINHEITEN 
\end_layout
\begin_layout Description
QM_GESAMT 
\end_layout
\begin_layout Description
QM_WOHNRAUM 
\end_layout
\begin_layout Description
QM_GEWERBE 
\end_layout
\begin_layout Description
ANZ_KONTEN 
\end_layout
\begin_layout Description
ANZ_ABRECHNUNGEN 
\end_layout
\begin_layout Description
ERSTELLT 
\end_layout
\begin_layout Description
ERSTELLER 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
KONTENRAHMEN_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN VALUES (NULL, '$last_b_id', '$profil_id', '$profil_bez','$profil_jahr', '$wirt_e', '$wirt_name', '$datum', '$anz_einheiten', '$qm_gesamt', '$qm_wohnraum', '$qm_gewerbe', '$anz_konten', '$anz_abrechnungen', '$ersteller', '$partner_id','$kontenrahmen_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN_KONTEN VALUES (NULL, '$last_a_id', '$b_id','$bk_k_id','$konto','$konto_bez','$g_kosten','$g_kosten_wo','$g_kosten_ge', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_ABRECHNUNGEN_KONTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_ABRECHNUNGEN_KONTEN` (

\end_layout
\begin_layout Plain Layout

  `BK_A_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_A_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BK_K_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_BEZ` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KOSTEN` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KOSTEN_WO` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KOSTEN_GE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_A_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_A_DAT 
\end_layout
\begin_layout Description
BK_A_ID 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
BK_K_ID 
\end_layout
\begin_layout Description
KONTO 
\end_layout
\begin_layout Description
KONTO_BEZ 
\end_layout
\begin_layout Description
G_KOSTEN 
\end_layout
\begin_layout Description
G_KOSTEN_WO 
\end_layout
\begin_layout Description
G_KOSTEN_GE 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN_KONTEN VALUES (NULL, '$last_a_id', '$b_id','$bk_k_id','$konto','$konto_bez','$g_kosten','$g_kosten_wo','$g_kosten_ge', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_ANPASSUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_ANPASSUNG` (

\end_layout
\begin_layout Plain Layout

  `AN_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `AN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUND` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FEST_BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KEY_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROFIL_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`AN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=33 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
AN_DAT 
\end_layout
\begin_layout Description
AN_ID 
\end_layout
\begin_layout Description
GRUND 
\end_layout
\begin_layout Description
FEST_BETRAG 
\end_layout
\begin_layout Description
KEY_ID 
\end_layout
\begin_layout Description
PROFIL_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ANPASSUNG VALUES (NULL, '$last_id','$kostenart', '$betrag', '$genkey','$profil_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM BK_ANPASSUNG WHERE AN_DAT='$an_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BK_ANPASSUNG WHERE PROFIL_ID='$profil_id' && AKTUELL='1' ORDER BY AN_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BK_ANPASSUNG WHERE PROFIL_ID='$profil_id' && GRUND='$kostenart' && AKTUELL='1' ORDER BY AN_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM BK_ANPASSUNG WHERE PROFIL_ID='$profil_id' && AKTUELL='1' ORDER BY GRUND ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_BERECHNUNG_BUCHUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_BERECHNUNG_BUCHUNGEN` (

\end_layout
\begin_layout Plain Layout

  `BK_BE_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_BE_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BUCHUNG_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BK_K_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BK_PROFIL_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KEY_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTEIL` decimal(7,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HNDL_BETRAG` decimal(10,3) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_BE_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BUCHUNG_ID` (`BUCHUNG_ID`,`BK_K_ID`,`BK_PROFIL_ID`,`KOSTENTRAEGER_TYP`,`KOSTENTRAEGER_ID`,`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=15832 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_BE_DAT 
\end_layout
\begin_layout Description
BK_BE_ID 
\end_layout
\begin_layout Description
BUCHUNG_ID 
\end_layout
\begin_layout Description
BK_K_ID 
\end_layout
\begin_layout Description
BK_PROFIL_ID 
\end_layout
\begin_layout Description
KEY_ID 
\end_layout
\begin_layout Description
ANTEIL 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
HNDL_BETRAG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "INSERT INTO BK_BERECHNUNG_BUCHUNGEN VALUES(NULL, '$last_bk_be_id', '$buchung_id', '$bk_konto_id', '$profil_id','$bk_genkey_id', '$max_anteil','$bk->bk_kos_typ', '$bk->bk_kos_id','$hndl_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "DELETE FROM BK_BERECHNUNG_BUCHUNGEN WHERE BK_BE_ID='$bk_be_id' && BK_K_ID='$bk_konto_id' && BK_PROFIL_ID= '$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "DELETE FROM BK_BERECHNUNG_BUCHUNGEN WHERE  BK_K_ID='$bk_konto_id' && BK_PROFIL_ID= '$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_prozent_umlage_alt($profil_id, $bk_konto_id, $prozent) {
        \end_layout
            \begin_layout Plain Layout
        $prozent = nummer_komma2punkt ( $prozent );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET ANTEIL='$prozent'  WHERE BK_K_ID='$bk_konto_id' && BK_PROFIL_ID='$profil_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET ANTEIL='$prozent'  WHERE BK_K_ID='$bk_konto_id' && BK_PROFIL_ID='$profil_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BUCHUNG_ID FROM BK_BERECHNUNG_BUCHUNGEN WHERE AKTUELL='1' && BK_K_ID='$bk_konto_id' && BK_PROFIL_ID='$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET ANTEIL='$prozent', HNDL_BETRAG=($ursprung_summe/100)*$prozent  WHERE BUCHUNG_ID='$buchung_id' && BK_K_ID='$bk_konto_id' && BK_PROFIL_ID='$profil_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET ANTEIL='$anteil_prozent' , KEY_ID='$genkey' ,KOSTENTRAEGER_TYP='$kostentraeger_typ' , KOSTENTRAEGER_ID='$kostentraeger_id', HNDL_BETRAG='$hndl_betrag' WHERE BK_BE_ID='$bk_be_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE AKTUELL='1' && BK_BE_ID='$be_id' && BK_PROFIL_ID='$profil_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_BE_DAT, BUCHUNG_ID, ANTEIL FROM BK_BERECHNUNG_BUCHUNGEN WHERE AKTUELL='1' && BK_K_ID='$konto_id' && BK_PROFIL_ID='$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET HNDL_BETRAG='$hndl_betrag_neu' WHERE BK_BE_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_BERECHNUNG_BUCHUNGEN SET HNDL_BETRAG='0.000' WHERE BK_BE_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "INSERT INTO BK_BERECHNUNG_BUCHUNGEN VALUES(NULL, '$last_bk_be_id', '$buchung_id', '$bk_konto_id', '$profil_id','$bk_genkey_id', '$max_anteil','$bk->bk_kos_typ', '$bk->bk_kos_id','$hndl_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  SUM( ANTEIL ) AS G_ANTEIL FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE BUCHUNG_ID = '$buchung_id' && `BK_K_ID` = '$konto_id' AND BK_PROFIL_ID = '$profil_id' && `AKTUELL` = '1' GROUP BY BUCHUNG_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AVG( ANTEIL ) AS D FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$bk_k_id' && BK_PROFIL_ID='$profil_id'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [D];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m') BETWEEN '$vorjahr-12' AND '$nachjahr-03' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $von = date_german2mysql ( $_SESSION ['anzeigen_von'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m-%d') BETWEEN '$von' AND '$bis' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BK_BE_ID, BUCHUNG_ID,  ANTEIL, KEY_ID, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID,HNDL_BETRAG FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE  `BK_K_ID` ='$konto_id' AND BK_PROFIL_ID='$profil_id' && `AKTUELL` = '1'  ORDER BY BUCHUNG_ID ASC " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE  `BK_K_ID` ='$konto_id'  && BK_PROFIL_ID='$profil_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BUCHUNG_ID, ANTEIL FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE  `BK_K_ID` ='$konto_id'  && BK_PROFIL_ID='$profil_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT BK_KONTEN.BK_K_ID, KONTO, KONTO_BEZ, BK_BERECHNUNG_BUCHUNGEN . * FROM `BK_KONTEN` JOIN BK_BERECHNUNG_BUCHUNGEN ON ( BK_KONTEN.BK_K_ID = BK_BERECHNUNG_BUCHUNGEN.BK_K_ID ) WHERE BK_KONTEN.BK_PROFIL_ID = '$profil_id' AND BK_KONTEN.`AKTUELL` = '1' && BK_BERECHNUNG_BUCHUNGEN.AKTUELL = '1' ORDER BY KONTO ASC ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_BERECHNUNG_BUCHUNGEN.BK_K_ID, KONTO  FROM BK_BERECHNUNG_BUCHUNGEN JOIN BK_KONTEN ON (BK_BERECHNUNG_BUCHUNGEN.BK_K_ID=BK_KONTEN.BK_K_ID && BK_BERECHNUNG_BUCHUNGEN.BK_PROFIL_ID=BK_KONTEN.BK_PROFIL_ID) WHERE BK_BERECHNUNG_BUCHUNGEN.BK_PROFIL_ID ='$profil_id' AND BK_BERECHNUNG_BUCHUNGEN.AKTUELL ='1'  && BK_KONTEN.AKTUELL ='1' GROUP BY BK_K_ID ORDER BY KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` ='$bk_k_id' AND `BK_PROFIL_ID` ='$profil_id' AND `AKTUELL` ='1' ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_PROFIL_ID` ='$profil_id'  && `BK_K_ID` ='$bk_k_id'  AND `AKTUELL` ='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_K_ID, SUM( BETRAG ) AS G_SUMME, SUM( HNDL_BETRAG ) AS HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT KONTO, t1.BK_K_ID,SUM(BETRAG) AS G_SUMME, SUM(A_SUMME) AS A_SUMME, KEY_ID,  KOS_TYP,  KOS_ID, ANTEIL, SUM(HNDL_BETRAG) AS HNDL_BETRAG FROM (SELECT BK_K_ID, BETRAG,  (BETRAG/100)*ANTEIL AS A_SUMME,  HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_K_ID, SUM( BETRAG ) AS G_SUMME , SUM( HNDL_BETRAG ) AS HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "INSERT INTO BK_BERECHNUNG_BUCHUNGEN VALUES(NULL, '$last_bk_be_id', '$buchung_id', '$bk_konto_id', '$profil_id','$key_id', '$anteil','$kos_typ', '$kos_id','$hndl_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_EINZEL_ABRECHNUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_EINZEL_ABRECHNUNGEN` (

\end_layout
\begin_layout Plain Layout

  `BK_E_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_E_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZEITRAUM` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETERNUMMER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KOSTEN` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_HNDL` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VORSCHUSS` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SALDO` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SALDO_ART` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_E_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_E_DAT 
\end_layout
\begin_layout Description
BK_E_ID 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
EMPF 
\end_layout
\begin_layout Description
ZEITRAUM 
\end_layout
\begin_layout Description
MIETERNUMMER 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
EINHEIT_NAME 
\end_layout
\begin_layout Description
G_KOSTEN 
\end_layout
\begin_layout Description
G_HNDL 
\end_layout
\begin_layout Description
VORSCHUSS 
\end_layout
\begin_layout Description
SALDO 
\end_layout
\begin_layout Description
SALDO_ART 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABRECHNUNGEN VALUES (NULL, '$last_e_id', '$b_id','$empf', '$zeitraum', '$mieternr', '$einheit_id','$einheit_name','$g_kosten','$g_hndl', '$vorschuss', '$saldo', '$saldo_art', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_EINZEL_ABR_ZEILEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_EINZEL_ABR_ZEILEN` (

\end_layout
\begin_layout Plain Layout

  `BK_Z_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_Z_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BK_E_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_BEZ` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KOSTEN` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_HNDL` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VERTEILER` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IHRE_ME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTEIL_HNDL` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETEILIGUNG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_Z_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_Z_DAT 
\end_layout
\begin_layout Description
BK_Z_ID 
\end_layout
\begin_layout Description
BK_E_ID 
\end_layout
\begin_layout Description
KONTO_ID 
\end_layout
\begin_layout Description
KONTO_BEZ 
\end_layout
\begin_layout Description
G_KOSTEN 
\end_layout
\begin_layout Description
G_HNDL 
\end_layout
\begin_layout Description
VERTEILER 
\end_layout
\begin_layout Description
IHRE_ME 
\end_layout
\begin_layout Description
ANTEIL_HNDL 
\end_layout
\begin_layout Description
BETEILIGUNG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABR_ZEILEN VALUES (NULL, '$last_z_id','$bk_e_id', '$konto_id', '$konto_bez', '$g_kosten','$g_hndl', '$verteiler', '$ihre_me', '$anteil_hndl', '$beteiligung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_GENERAL_KEYS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_GENERAL_KEYS` (

\end_layout
\begin_layout Plain Layout

  `GKEY_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GKEY_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GKEY_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_VAR` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `E_VAR` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ME` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`GKEY_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
GKEY_DAT 
\end_layout
\begin_layout Description
GKEY_ID 
\end_layout
\begin_layout Description
GKEY_NAME 
\end_layout
\begin_layout Description
G_VAR 
\end_layout
\begin_layout Description
E_VAR 
\end_layout
\begin_layout Description
ME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM BK_GENERAL_KEYS  WHERE GKEY_ID='$key_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BK_GENERAL_KEYS WHERE  AKTUELL='1'   ORDER BY GKEY_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BK_GENERAL_KEYS WHERE  AKTUELL='1'   ORDER BY GKEY_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_KONTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_KONTEN` (

\end_layout
\begin_layout Plain Layout

  `BK_K_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_K_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_BEZ` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BK_PROFIL_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GENKEY_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HNDL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_K_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1924 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_K_DAT 
\end_layout
\begin_layout Description
BK_K_ID 
\end_layout
\begin_layout Description
KONTO 
\end_layout
\begin_layout Description
KONTO_BEZ 
\end_layout
\begin_layout Description
BK_PROFIL_ID 
\end_layout
\begin_layout Description
GENKEY_ID 
\end_layout
\begin_layout Description
HNDL 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "INSERT INTO BK_KONTEN VALUES (NULL, '$last_id', '$bk_konto_id', '$profil_id','0','0','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $_SESSION [bk_konto] = $bk_konto_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "DELETE FROM BK_KONTEN WHERE  BK_K_ID='$bk_konto_id' && BK_PROFIL_ID= '$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM BK_KONTEN WHERE KONTO='$konto' && BK_PROFIL_ID='$profil_id' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BK_K_ID  FROM `BK_KONTEN` WHERE AKTUELL='1' && BK_PROFIL_ID='$profil_id' && KONTO='$konto' ORDER BY BK_K_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `BK_KONTEN` WHERE AKTUELL='1' && BK_PROFIL_ID='$profil_id' && BK_K_ID='$bk_k_id' ORDER BY BK_K_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->konto = $row ['KONTO'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO  FROM `BK_KONTEN` WHERE AKTUELL='1' && BK_PROFIL_ID='$profil_id' && BK_K_ID='$bk_k_id' ORDER BY BK_K_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_genkey($konto_id, $profil_id, $genkey_id, $hndl) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_KONTEN SET GENKEY_ID='$genkey_id', HNDL='$hndl'  WHERE BK_K_ID='$konto_id' && BK_PROFIL_ID= '$profil_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_KONTEN SET GENKEY_ID='$genkey_id', HNDL='$hndl'  WHERE BK_K_ID='$konto_id' && BK_PROFIL_ID= '$profil_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' && KONTO NOT IN(SELECT KONTO FROM BK_KONTEN WHERE BK_PROFIL_ID='$this->bk_profil_id')  ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_PROFILE` JOIN BK_KONTEN ON ( BK_PROFILE.BK_ID = BK_KONTEN.BK_PROFIL_ID ) WHERE BK_PROFILE.BK_ID='$profil_id' && BK_KONTEN.AKTUELL='1' && BK_PROFILE.AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_KONTEN_BERECHNUNG` WHERE BK_K_ID='$konto_id' ORDER BY VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT BK_KONTEN.BK_K_ID, KONTO, KONTO_BEZ, BK_BERECHNUNG_BUCHUNGEN . * FROM `BK_KONTEN` JOIN BK_BERECHNUNG_BUCHUNGEN ON ( BK_KONTEN.BK_K_ID = BK_BERECHNUNG_BUCHUNGEN.BK_K_ID ) WHERE BK_KONTEN.BK_PROFIL_ID = '$profil_id' AND BK_KONTEN.`AKTUELL` = '1' && BK_BERECHNUNG_BUCHUNGEN.AKTUELL = '1' ORDER BY KONTO ASC ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_K_ID, KONTO  FROM `BK_KONTEN` WHERE `BK_PROFIL_ID` ='$profil_id' AND `AKTUELL` ='1' ORDER BY KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_BERECHNUNG_BUCHUNGEN.BK_K_ID, KONTO  FROM BK_BERECHNUNG_BUCHUNGEN JOIN BK_KONTEN ON (BK_BERECHNUNG_BUCHUNGEN.BK_K_ID=BK_KONTEN.BK_K_ID && BK_BERECHNUNG_BUCHUNGEN.BK_PROFIL_ID=BK_KONTEN.BK_PROFIL_ID) WHERE BK_BERECHNUNG_BUCHUNGEN.BK_PROFIL_ID ='$profil_id' AND BK_BERECHNUNG_BUCHUNGEN.AKTUELL ='1'  && BK_KONTEN.AKTUELL ='1' GROUP BY BK_K_ID ORDER BY KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_KONTEN VALUES (NULL, '$last_id','$kostenkonto', '$konto_bez', '$profil_id','1','0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_KONTEN VALUES (NULL, '$last_id','$kostenkonto', '$konto_bez', '$profil_id','$genkey_id','$hndl', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BK_PROFILE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BK_PROFILE` (

\end_layout
\begin_layout Plain Layout

  `BK_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BK_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TYP` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TYP_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `JAHR` decimal(4,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BERECHNUNGS_DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VERRECHNUNGS_DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`BK_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=443 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BK_DAT 
\end_layout
\begin_layout Description
BK_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
TYP 
\end_layout
\begin_layout Description
TYP_ID 
\end_layout
\begin_layout Description
JAHR 
\end_layout
\begin_layout Description
BERECHNUNGS_DATUM 
\end_layout
\begin_layout Description
VERRECHNUNGS_DATUM 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $this->last_bk_id = $last_bk_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BK_ID AS PROFIL_ID, BEZEICHNUNG FROM BK_PROFILE WHERE  AKTUELL='1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_PROFILE VALUES (NULL, '$last_bk_id', '$bez', 'Wirtschaftseinheit', '$w_id','$jahr','$ber_datum','$ver_datum', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $this->last_bk_id = $last_bk_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_PROFILE VALUES(NULL, '$profil_id', '$bez', '$typ', '$typ_id', '$jahr', '$b_datum_sql', '$v_datum_sql', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BK_PROFILE SET AKTUELL='0' WHERE BK_ID = '$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_PROFILE` WHERE JAHR='$jahr' && TYP='$typ' && TYP_ID='$typ_id'  && AKTUELL='1' ORDER BY BK_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_PROFILE` WHERE BK_ID='$profil_id' && AKTUELL='1' ORDER BY BK_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_PROFILE` WHERE AKTUELL='1' ORDER BY BK_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BK_PROFILE` JOIN BK_KONTEN ON ( BK_PROFILE.BK_ID = BK_KONTEN.BK_PROFIL_ID ) WHERE BK_PROFILE.BK_ID='$profil_id' && BK_KONTEN.AKTUELL='1' && BK_PROFILE.AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_a_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_e_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_z_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
BLZ
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `BLZ` (

\end_layout
\begin_layout Plain Layout

  `BLZ` int(8) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MERKMAL` int(1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(200) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLZ` int(5) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ORT` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KURZ_BEZ` varchar(50) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PAN` int(5) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PZ` varchar(2) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DSN` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AEK` char(1) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BLZ_L` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BLZ_NEU` int(8) NOT NULL

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
BLZ 
\end_layout
\begin_layout Description
MERKMAL 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
PLZ 
\end_layout
\begin_layout Description
ORT 
\end_layout
\begin_layout Description
KURZ_BEZ 
\end_layout
\begin_layout Description
PAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
PZ 
\end_layout
\begin_layout Description
DSN 
\end_layout
\begin_layout Description
AEK 
\end_layout
\begin_layout Description
BLZ_L 
\end_layout
\begin_layout Description
BLZ_NEU 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        case "gk_update" :
        \end_layout
            \begin_layout Plain Layout
        print_req ();
        \end_layout
            \begin_layout Plain Layout
        if (! empty ( $_REQUEST ['gk_id'] ) && ! empty ( $_REQUEST ['g_bez'] ) && ! empty ( $_REQUEST ['beguenstigter'] ) && ! empty ( $_REQUEST ['kontonummer'] ) && ! empty ( $_REQUEST ['blz'] ) && ! empty ( $_REQUEST ['institut'] ) && ! empty ( $_REQUEST ['iban'] ) && ! empty ( $_REQUEST ['bic'] )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $gk->geldkonto_update ( $gk_id, $g_bez, $beguenstigter, $kontonummer, $blz, $institut, $iban_mysql, $bic );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten ( '?daten=geldkonten' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$konto_id','$clean_arr[partnername] - Konto','$clean_arr[partnername]', '$clean_arr[KONTONUMMER]','$clean_arr[BLZ]', '$clean_arr[kreditinstitut]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, IBAN, BIC FROM GELD_KONTEN WHERE  GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.BEGUENSTIGTER ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN WHERE  GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" selected>$geld_institut - Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\">$geld_institut - Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" selected>Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" >Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" selected>Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" >Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEGUENSTIGTER, KONTONUMMER, BLZ, INSTITUT, BEZEICHNUNG, BIC, IBAN  FROM GELD_KONTEN WHERE KONTO_ID='$konto_id' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT  FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.INSTITUT, GELD_KONTEN.IBAN, GELD_KONTEN.BIC FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='BLZ-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_blz_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID,GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID  ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BLZ` WHERE `BLZ` ='$blz' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `BLZ` WHERE `BLZ` ='$blz' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$m_r', '$g_id', '$g_gk_id', '$beg', '$name', '$ans', '$kto', '$blz', '$iban', '$bic', '$bank', '$m_udatum', '$m_adatum', '9999-12-31', 'WIEDERKEHREND', 'MIETZAHLUNG', '$eart', 'MIETVERTRAG', '$mv_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$mref', '$glaeubiger_id', '$gk_id', '$empf', '$name', '$anschrift', '$kto', '$blz', '$iban', '$bic', '$bankname', '$udatum', '$adatum', '$edatum', '$m_art', '$n_art', '$e_art', '$kos_typ', '$kos_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$mref', '$glaeubiger_id', '$gk_id', '$empf', '$name', '$anschrift', '$kto', '$blz', '$iban', '$bic', '$bankname', '$udatum', '$adatum', '$edatum', '$m_art', '$n_art', '$e_art', '$kos_typ', '$kos_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        // echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_KONTOS` WHERE `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' AND `AKTUELL` = '1' ORDER BY BEGUENSTIGTER";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT,  GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE  GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez%' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.BEGUENSTIGTER ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez' ORDER BY GELD_KONTEN.KONTO_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function geldkonto_update($gk_id, $g_bez, $beguenstigter, $kontonummer, $blz, $institut, $iban, $bic) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN SET AKTUELL='0' WHERE KONTO_ID='$gk_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$gk_id', '$g_bez','$beguenstigter', '$kontonummer', '$blz','$iban', '$bic', '$institut', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$last_b_id', '$g_bez','$beguenstigter', '$kontonummer', '$blz','$iban', '$bic', '$institut', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" selected>$bez - Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$konto_id\" >$bez - Knr:$kontonummer - Blz: $blz</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE AKTUELL = '1' && KONTONUMMER='$kontonummer' && BLZ='$blz' && INSTITUT='$institut'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID  FROM GELD_KONTEN WHERE KONTONUMMER='$kto' && BLZ='$blz' &&  AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,2" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTO_ID FROM GELD_KONTEN WHERE KONTONUMMER='$kto' && BLZ='$blz' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1<br>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG *  Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin * BLZ: 100  800  00 * Konto-Nr.: 05 804 000 00 * Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
DETAIL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `DETAIL` (

\end_layout
\begin_layout Plain Layout

  `DETAIL_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DETAIL_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_INHALT` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_BEMERKUNG` varchar(400) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_ZUORDNUNG_TABELLE` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_ZUORDNUNG_ID` varchar(6) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DETAIL_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=40306 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DETAIL_DAT 
\end_layout
\begin_layout Description
DETAIL_ID 
\end_layout
\begin_layout Description
DETAIL_NAME 
\end_layout
\begin_layout Description
DETAIL_INHALT 
\end_layout
\begin_layout Description
DETAIL_BEMERKUNG 
\end_layout
\begin_layout Description
DETAIL_AKTUELL 
\end_layout
\begin_layout Description
DETAIL_ZUORDNUNG_TABELLE 
\end_layout
\begin_layout Description
DETAIL_ZUORDNUNG_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kaution', '$betrag', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Einzugsermächtigung', 'JA', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kontoinhaber-AutoEinzug', '$kontoinhaber', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kontonummer-AutoEinzug', '$kontonummer', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Bankname-AutoEinzug', '$bankname', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Autoeinzugsart', '$einzugsart', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT UNTERKATEGORIE_NAME FROM `DETAIL_UNTERKATEGORIEN` WHERE `KATEGORIE_ID` = '$kat_id' AND `AKTUELL` = '1' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        detail_update ( $dat, $wert, $det_name, $kos_typ, $kos_id );
        \end_layout
            \begin_layout Plain Layout
        break;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function detail_update($detail_dat, $wert_neu, $det_name, $kos_typ, $kos_id) {
        \end_layout
            \begin_layout Plain Layout
        $d = new detail ();
        \end_layout
            \begin_layout Plain Layout
        if ($detail_dat != 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_DAT='$detail_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $d->detail_speichern_2 ( $tabelle, $tabelle_id, $det_name, $wert_neu, $det_bemerkung );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL_KATEGORIEN VALUES (NULL, '$detail_kat_name', '$bereich_kategorie', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Detail bzw. Detailgruppe $detail_kat_name wurde dem Bereich $bereich_kategorie hinzugefügt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL_UNTERKATEGORIEN VALUES (NULL, '$bereich_kategorie', '$detail_kat_uname', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Unterdetail <u>$detail_kat_uname</u> bzw. Auswahloption wurde dem Bereich $haupt_kat_name hinzugefügt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_NAME='$kat' && DETAIL_KAT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kat_id' && UNTERKATEGORIE_NAME='$kat_name' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_ID='$id' && DETAIL_KAT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' && DETAIL_KAT_KATEGORIE='$_REQUEST[table]' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='$tab' && DETAIL_ZUORDNUNG_ID='$id' && DETAIL_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile1\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td>$mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        $einheit_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile2\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td> $mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $counter = 0;
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_DAT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='$tabelle' && DETAIL_ZUORDNUNG_ID='$zuordnungs_id' ORDER BY DETAIL_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select><br>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function detail_drop_down_kategorie() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr><td>Detailzugehörigkeit:</td><td> <select name=\"bereich_kategorie\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"OBJEKT\">OBJEKT</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"HAUS\">HAUS</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</td></tr></select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function detail_drop_down_kategorie_db() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr><td>Detailzugehörigkeit:</td><td> <select name=\"bereich_kategorie\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_ID, $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$DETAIL_KAT_ID\">$DETAIL_KAT_NAME</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_KATEGORIE='$kategorie' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"detail_kat_id\" size=1>";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_ID, $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$DETAIL_KAT_ID\" >$DETAIL_KAT_NAME</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_NAME='$kategorie_name' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_ID='$kategorie_id' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kategorie_id' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kat_id' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"detail_ukat_name\" size=1>\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $UNTERKATEGORIE_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$UNTERKATEGORIE_NAME\">$UNTERKATEGORIE_NAME</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL (`DETAIL_DAT`, `DETAIL_ID`, `DETAIL_NAME`, `DETAIL_INHALT`, `DETAIL_BEMERKUNG`, `DETAIL_AKTUELL`, `DETAIL_ZUORDNUNG_TABELLE`, `DETAIL_ZUORDNUNG_ID`) VALUES (NULL, '', '$kat_name', '$kat_uname', '$bemerkung', '1', '$table', '$id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_detail_dat ( $table, $id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_INHALT FROM `DETAIL` WHERE DETAIL_NAME = 'Geld Konto Nummer' && DETAIL_ZUORDNUNG_TABELLE = 'OBJEKT' && DETAIL_ZUORDNUNG_ID = '$objekt_id' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_kontonummer = $row ['DETAIL_INHALT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_NAME, DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && (DETAIL_NAME LIKE '%tel%'or DETAIL_NAME LIKE '%fax%' or DETAIL_NAME LIKE '%mobil%' or DETAIL_NAME LIKE '%handy%' OR DETAIL_NAME LIKE '%mail%') && DETAIL_ZUORDNUNG_ID = '$id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_NAME, DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='$tabelle' && DETAIL_ZUORDNUNG_ID='$id' && DETAIL_AKTUELL='1' ORDER BY DETAIL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( DETAIL_INHALT ) AS SUMME FROM DETAIL WHERE DETAIL_AKTUELL = '1' && DETAIL_ZUORDNUNG_TABELLE = 'EINHEIT' && DETAIL_ZUORDNUNG_ID = '$einheit_id' && (DETAIL_NAME = 'Miete kalt' OR DETAIL_NAME = 'Nebenkosten Vorauszahlung' OR DETAIL_NAME = 'Heizkosten Vorauszahlung')  " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_DAT, DETAIL_ID, DETAIL_NAME, DETAIL_INHALT, DETAIL_BEMERKUNG FROM DETAIL WHERE DETAIL_AKTUELL='1' && DETAIL_ZUORDNUNG_TABELLE = '$detail_tabelle' && DETAIL_ZUORDNUNG_ID = '$detail_id' ORDER BY DETAIL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM `DETAIL_KATEGORIEN` WHERE `DETAIL_KAT_KATEGORIE` = '$tabelle'
        \end_layout
            \begin_layout Plain Layout
        AND `DETAIL_KAT_AKTUELL` = '1' ORDER BY DETAIL_KAT_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT UNTERKATEGORIE_NAME FROM `DETAIL_UNTERKATEGORIEN` WHERE `KATEGORIE_ID` = '$kat_id' AND `AKTUELL` = '1' ORDER BY UNTERKATEGORIE_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KATEGORIE_ID, UNTERKATEGORIE_NAME FROM `DETAIL_KATEGORIEN` JOIN DETAIL_UNTERKATEGORIEN ON (`DETAIL_KAT_ID`=KATEGORIE_ID) WHERE `DETAIL_KAT_NAME`='$kat_bez'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function form_detail_hinzu($tab, $id, $vorauswahl = null) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->select_hauptkats_arr ( "Detail auswählen zu $kurzinfo", 'detail_kat', 'detail_kat', $js, $vorauswahl, $det_kat_arr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $this->select_unterkats ( 'Detailoption auswählen', 'detail_ukat', 'detail_ukat', '' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->select_unterkats ( 'Detailoption auswählen', 'detail_ukat', 'detail_ukat', '' );
        \end_layout
            \begin_layout Plain Layout
        $hinw = ' Text als Warnung eingeben: <p class="warnung"> INHALT </p>';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' && DETAIL_KAT_ID = '$kat_id' limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$this->last_detail_id', '$det_name','$det_inhalt', '$det_bemerkung', '1','$tabelle','$id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        if ($resultat) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$this->last_detail_id', '$det_name','$det_inhalt', '$det_bemerkung', '1','$tabelle','$id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_AKTUELL='1' && DETAIL_NAME='$det_name' && DETAIL_ZUORDNUNG_TABELLE='$tab' && DETAIL_ZUORDNUNG_ID='$tab_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_NAME='$det_name' && DETAIL_ZUORDNUNG_TABELLE='$tab' && DETAIL_ZUORDNUNG_ID='$tab_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_ID FROM DETAIL ORDER BY DETAIL_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_DAT='$detail_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        if ($resultat) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM DETAIL WHERE DETAIL_DAT='$detail_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_ZUORDNUNG_TABELLE, DETAIL_ZUORDNUNG_ID FROM DETAIL WHERE DETAIL_DAT='$detail_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='PARTNER_LIEFERANT' && DETAIL_NAME='Mandanten-Nr' && DETAIL_ZUORDNUNG_ID='$partner_id' && DETAIL_AKTUELL='1' ORDER BY DETAIL_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = 'PERSON' && DETAIL_NAME = 'Anrede' && DETAIL_ZUORDNUNG_ID = '$person_id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = 'PERSON' && DETAIL_NAME = 'Geschlecht' && DETAIL_ZUORDNUNG_ID = '$person_id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && DETAIL_NAME = '$detail_name' && DETAIL_ZUORDNUNG_ID = '$id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        // if($detail_name=='WEG-KaltmieteINS'){
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && DETAIL_ZUORDNUNG_ID = '$id' && DETAIL_NAME = '$detail_name'  && DETAIL_AKTUELL = '1' ORDER BY DETAIL_INHALT DESC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT * FROM DETAIL WHERE DETAIL_NAME = '$detail_name'  && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT * FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && DETAIL_ZUORDNUNG_ID = '$id' && DETAIL_NAME = '$detail_name'  && DETAIL_AKTUELL = '1' ORDER BY DETAIL_INHALT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        // echo "<h1>$db_abfrage</h1>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_NAME, DETAIL_INHALT,  DETAIL_BEMERKUNG FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && DETAIL_ZUORDNUNG_ID = '$tab_id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  `DETAIL_NAME` FROM  `DETAIL` WHERE  `DETAIL_AKTUELL` =  '1' GROUP BY DETAIL_NAME";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function finde_detail($suchtext, $det_name = null) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `DETAIL` WHERE  `DETAIL_INHALT` LIKE  '%$suchtext%' AND  `DETAIL_AKTUELL` =  '1' ORDER BY DETAIL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `DETAIL` WHERE  `DETAIL_NAME`='$det_name' && `DETAIL_INHALT` LIKE  '%$suchtext%' AND  `DETAIL_AKTUELL` =  '1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `DETAIL` WHERE  `DETAIL_NAME`='$det_name' && `DETAIL_INHALT` LIKE  '%$suchtext%' AND  `DETAIL_AKTUELL` =  '1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Einzugsermächtigung', '$ja_nein', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Autoeinzugsart', '$art', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Kontoinhaber-AutoEinzug', '$konto_inh', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Kontonummer-AutoEinzug', '$konto_nr', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Bankname-AutoEinzug', '$bankname', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Teilnahme am Lastschriftverfahren wurde vermerkt";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_ZUORDNUNG_ID AS MIETVERTRAG_ID FROM `DETAIL` LEFT JOIN(MIETVERTRAG) ON (DETAIL_ZUORDNUNG_ID=MIETVERTRAG_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='JA' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_AKTUELL = '1' && MIETVERTRAG_AKTUELL = '1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>=CURDATE())" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_ZUORDNUNG_ID AS MIETVERTRAG_ID FROM `DETAIL` LEFT JOIN(MIETVERTRAG) ON (DETAIL_ZUORDNUNG_ID=MIETVERTRAG_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='NEIN' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_AKTUELL = '1' && MIETVERTRAG_AKTUELL = '1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>=CURDATE())" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_INHALT='JA' where DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Teilnahme zum Lastschriftverfahren aufgenommen." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_INHALT='NEIN' where DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Teilnahme zum Lastschriftverfahren ausgesetzt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_DAT='$dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function mietvertrag_beenden_db($mv_dat, $mietvertrag_bis) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE `DETAIL` SET DETAIL_INHALT='NEIN' WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='JA' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL = '1' " );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ls_daten_holen($mv_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Kontoinhaber-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_konto_inhaber_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Kontonummer-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_konto_nummer_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='BLZ-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_blz_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Bankname-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_bankname_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Autoeinzugsart' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_autoeinzugsart_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_einzugsermaechtigung_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM DETAIL WHERE DETAIL_NAME LIKE '%AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        echo "Mietvertrag wurde gelöscht!";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        echo "Mietvertrag wurde gelöscht!";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_NAME, DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = '$tab' && (DETAIL_NAME LIKE '%tel%'or DETAIL_NAME LIKE '%fax%' or DETAIL_NAME LIKE '%mobil%' or DETAIL_NAME LIKE '%handy%' OR DETAIL_NAME LIKE '%mail%' OR DETAIL_NAME LIKE '%anschrift%') && DETAIL_ZUORDNUNG_ID = '$id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"genkeys\">Kostenart wählen</label><select id=\"kostenart\" name=\"kostenart\" size=\"1\">";
        \end_layout
            \begin_layout Plain Layout
        $this->get_anpassung_details ( $profil_id, 'Nebenkosten Vorauszahlung' );
        \end_layout
            \begin_layout Plain Layout
        if (! isset ( $this->bk_an_dat )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_ZUORDNUNG_ID FROM `DETAIL` WHERE `DETAIL_NAME` LIKE 'Einzugsermächtigung' AND `DETAIL_INHALT` LIKE 'JA' AND `DETAIL_AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, `DETAIL_NAME` , `DETAIL_INHALT` , `DETAIL_BEMERKUNG` , `DETAIL_ZUORDNUNG_ID`
        \end_layout
            \begin_layout Plain Layout
        FROM `DETAIL` , PERSON
        \end_layout
            \begin_layout Plain Layout
        WHERE `DETAIL_NAME` LIKE '%Hinweis%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, `DETAIL_NAME` , `DETAIL_INHALT` , `DETAIL_BEMERKUNG` , `DETAIL_ZUORDNUNG_ID`
        \end_layout
            \begin_layout Plain Layout
        FROM `DETAIL` , PERSON
        \end_layout
            \begin_layout Plain Layout
        WHERE `DETAIL_NAME` LIKE '%anschrift%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO DETAIL VALUES(NULL, '$last_detail_id', '$kosten_kat', '$einheit_betrag', '$einheit_kurzname $anfang bis $ende', '1', 'EINHEIT','$einheit_id')";
        \end_layout
            \begin_layout Plain Layout
        echo " '$last_detail_id', '$kosten_kat', '$einheit_betrag', '$einheit_kurzname $anfang bis $ende', '1', 'EINHEIT','$einheit_id'<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mietvertrag_id' && DETAIL_AKTUELL = '1' && DETAIL_NAME LIKE '%Kaution%' ORDER BY DETAIL_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->kautions_betrag = $row ['DETAIL_INHALT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_ZUORDNUNG_ID AS EINHEIT_ID, DETAIL_INHALT, DETAIL_BEMERKUNG, STR_TO_DATE(DETAIL_INHALT,'%d.%m.%Y') , DATE_FORMAT(NOW(), '%Y-%m-%d')  FROM `DETAIL` WHERE `DETAIL_NAME` = 'Besichtigungstermin' AND `DETAIL_AKTUELL` = '1' AND  (STR_TO_DATE(DETAIL_INHALT,'%d.%m.%Y') $vor_nach= CURDATE()) AND `DETAIL_ZUORDNUNG_TABELLE` = 'EINHEIT' && DETAIL_ZUORDNUNG_ID IN (SELECT EINHEIT_ID FROM `EINHEIT` WHERE `EINHEIT_AKTUELL` = '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
DETAIL_KATEGORIEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `DETAIL_KATEGORIEN` (

\end_layout
\begin_layout Plain Layout

  `DETAIL_KAT_ID` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DETAIL_KAT_NAME` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_KAT_KATEGORIE` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DETAIL_KAT_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DETAIL_KAT_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=179 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DETAIL_KAT_ID 
\end_layout
\begin_layout Description
DETAIL_KAT_NAME 
\end_layout
\begin_layout Description
DETAIL_KAT_KATEGORIE 
\end_layout
\begin_layout Description
DETAIL_KAT_AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL_KATEGORIEN VALUES (NULL, '$detail_kat_name', '$bereich_kategorie', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Detail bzw. Detailgruppe $detail_kat_name wurde dem Bereich $bereich_kategorie hinzugefügt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_NAME='$kat' && DETAIL_KAT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_ID='$id' && DETAIL_KAT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' && DETAIL_KAT_KATEGORIE='$_REQUEST[table]' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME, DETAIL_KAT_KATEGORIE FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_KATEGORIE ASC ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_KATEGORIE='$kategorie' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_ID FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_NAME='$kategorie_name' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_ID='$kategorie_id' && DETAIL_KAT_AKTUELL='1' ORDER BY DETAIL_KAT_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_KAT_ID, DETAIL_KAT_NAME FROM `DETAIL_KATEGORIEN` WHERE `DETAIL_KAT_KATEGORIE` = '$tabelle'
        \end_layout
            \begin_layout Plain Layout
        AND `DETAIL_KAT_AKTUELL` = '1' ORDER BY DETAIL_KAT_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KATEGORIE_ID, UNTERKATEGORIE_NAME FROM `DETAIL_KATEGORIEN` JOIN DETAIL_UNTERKATEGORIEN ON (`DETAIL_KAT_ID`=KATEGORIE_ID) WHERE `DETAIL_KAT_NAME`='$kat_bez'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_KAT_NAME FROM DETAIL_KATEGORIEN WHERE DETAIL_KAT_AKTUELL='1' && DETAIL_KAT_ID = '$kat_id' limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_KAT_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
DETAIL_UNTERKATEGORIEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `DETAIL_UNTERKATEGORIEN` (

\end_layout
\begin_layout Plain Layout

  `UKAT_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KATEGORIE_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `UNTERKATEGORIE_NAME` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`UKAT_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=72 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
UKAT_DAT 
\end_layout
\begin_layout Description
KATEGORIE_ID 
\end_layout
\begin_layout Description
UNTERKATEGORIE_NAME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT UNTERKATEGORIE_NAME FROM `DETAIL_UNTERKATEGORIEN` WHERE `KATEGORIE_ID` = '$kat_id' AND `AKTUELL` = '1' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL_UNTERKATEGORIEN VALUES (NULL, '$bereich_kategorie', '$detail_kat_uname', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Unterdetail <u>$detail_kat_uname</u> bzw. Auswahloption wurde dem Bereich $haupt_kat_name hinzugefügt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kat_id' && UNTERKATEGORIE_NAME='$kat_name' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    admin_panel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UKAT_DAT, KATEGORIE_ID, UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE AKTUELL='1' ORDER BY KATEGORIE_ID ASC ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kategorie_id' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT UNTERKATEGORIE_NAME FROM DETAIL_UNTERKATEGORIEN WHERE KATEGORIE_ID='$kat_id' ORDER BY UNTERKATEGORIE_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT UNTERKATEGORIE_NAME FROM `DETAIL_UNTERKATEGORIEN` WHERE `KATEGORIE_ID` = '$kat_id' AND `AKTUELL` = '1' ORDER BY UNTERKATEGORIE_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KATEGORIE_ID, UNTERKATEGORIE_NAME FROM `DETAIL_KATEGORIEN` JOIN DETAIL_UNTERKATEGORIEN ON (`DETAIL_KAT_ID`=KATEGORIE_ID) WHERE `DETAIL_KAT_NAME`='$kat_bez'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
EINHEIT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `EINHEIT` (

\end_layout
\begin_layout Plain Layout

  `EINHEIT_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_QM` decimal(6,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_LAGE` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_KURZNAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TYP` enum('Wohnraum','Gewerbe','Stellplatz','Garage','Keller','Freiflaeche','Wohneigentum','Werbeflaeche') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  UNIQUE KEY `EINHEIT_DAT` (`EINHEIT_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `EINHEIT_ID` (`EINHEIT_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `HAUS_ID` (`HAUS_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `EINHEIT_KURZNAME` (`EINHEIT_KURZNAME`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2814 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
EINHEIT_DAT 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
EINHEIT_QM 
\end_layout
\begin_layout Description
EINHEIT_LAGE 
\end_layout
\begin_layout Description
HAUS_ID 
\end_layout
\begin_layout Description
EINHEIT_AKTUELL 
\end_layout
\begin_layout Description
EINHEIT_KURZNAME 
\end_layout
\begin_layout Description
TYP 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  && MIETVERTRAG_ID!='0'order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        update_flaeche ( "einheit" );
        \end_layout
            \begin_layout Plain Layout
        function update_flaeche($tabelle) {
        \end_layout
            \begin_layout Plain Layout
        $tabelle_in_gross = strtoupper ( $tabelle ); // Tabelle in GROßBUCHSTABEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE EINHEIT SET EINHEIT_QM='$flaeche' WHERE EINHEIT_AKTUELL='1' && EINHEIT_DAT='$e_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_DAT FROM EINHEIT WHERE EINHEIT_KURZNAME='$einheit_name' && EINHEIT_AKTUELL='1' order by EINHEIT_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LTRIM(RTRIM(W_NAME)) FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME, EINHEIT_ID FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME, $EINHEIT_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS.OBJEKT_ID AS OBJEKT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM  `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM `WEG_MITEIGENTUEMER` , EINHEIT WHERE EINHEIT_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_NAME FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM `WEG_MITEIGENTUEMER` , EINHEIT WHERE EINHEIT_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, EINHEIT, MWST_SATZ, SKONTO FROM POSITIONEN_KATALOG WHERE AKTUELL='1' && ART_LIEFERANT='$lieferant_id' && ARTIKEL_NR='$artikel_nr' ORDER BY KATALOG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        ob_clean ();
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "select * from POSITIONEN_KATALOG where ART_LIEFERANT='$lieferant_id' && ARTIKEL_NR='$artikel_nr' && AKTUELL='1' && LISTENPREIS='$preis' && RABATT_SATZ='$rabatt' && BEZEICHNUNG='$bez' && EINHEIT='$einheit' && MWST_SATZ='$pos_mwst' && SKONTO='$pos_skonto'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        update_g_preis ();
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function spalte_einheitspreis_pool($spalte, $preis, $pool_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (! isset ( $_REQUEST [einheit_update] )) {
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( haus_in_db, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        $objekt_kurzname = objekt_kurzname ( $_POST ["objekt_id"] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        erstelle_submit_button ( "einheit_update", "Speichern" ); // name, wert
        \end_layout
            \begin_layout Plain Layout
        ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (isset ( $_REQUEST [einheit_update] )) {
        \end_layout
            \begin_layout Plain Layout
        $haus_dat = $_POST [haus_dat];
        \end_layout
            \begin_layout Plain Layout
        deaktiviere_haus_dat ( $haus_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $einheit_update = $_REQUEST ["einheit_update"];
        \end_layout
            \begin_layout Plain Layout
        if (isset ( $_REQUEST ["daten_rein"] )) {
        \end_layout
            \begin_layout Plain Layout
        switch ($_REQUEST ["daten_rein"]) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        erstelle_hiddenfeld ( "daten_rein", "einheit_update" );
        \end_layout
            \begin_layout Plain Layout
        erstelle_submit_button ( "einheit_update", "Speichern" ); // name, wert
        \end_layout
            \begin_layout Plain Layout
        ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        erstelle_submit_button ( "einheit_update", "Speichern" ); // name, wert
        \end_layout
            \begin_layout Plain Layout
        ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        // neue_einheit_in_db($_POST[haus_id], $_POST[einheit_kurzname], $_POST[einheit_lage], $_POST[einheit_qm], $_POST[einheit_ausstattung]);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        case "einheit_update" :
        \end_layout
            \begin_layout Plain Layout
        iframe_start ();
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Objekt: $objekt_kurzname" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM EINHEIT WHERE EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    miete_definieren.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] ['HAUS_ID'] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchungsmaske.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] [HAUS_ID] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchungsmaske.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$hh_id' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $w->wohngeld_def_delete ( $_REQUEST ['dat'] );
        \end_layout
            \begin_layout Plain Layout
        $einheit_id = $_REQUEST ['einheit_id'];
        \end_layout
            \begin_layout Plain Layout
        weiterleiten ( "?daten=weg&option=wohngeld_definieren&einheit_id=$einheit_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<hr>SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m-%d' ) <= '$datum' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m-%d' ) >= '$datum'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$name\">$label</label><select name=\"$name\" id=\"$name\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $leerstand ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $einheit_id = $leerstand [$a] ['EINHEIT_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_DAT, MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_DAT, MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_ID, $MIETVERTRAG_VON, $EINHEIT_ID ) = mysql_fetch_row ( $resultat1 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage2 = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$MIETVERTRAG_VON', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        } // while end
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_ID, $MIETVERTRAG_VON, $EINHEIT_ID ) = mysql_fetch_row ( $resultat1 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage2 = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$mietvertrag_id_alt', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        } // while end
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' ORDER BY EINHEIT.EINHEIT_KURZNAME,MIETVERTRAG.MIETVERTRAG_VON  ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS!='0000-00-00' && MIETVERTRAG.MIETVERTRAG_BIS<'$datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG.MIETVERTRAG_BIS>'$datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $e->einheit_update ( $_REQUEST ['dat'], $_REQUEST ['einheit_id'], $_REQUEST ['kurzname'], $_REQUEST ['lage'], $_REQUEST ['qm'], $_REQUEST ['haus_id'], $_REQUEST ['typ'] );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Einheit aktualisiert" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY LENGTH(EINHEIT_KURZNAME), EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1')  ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1')  ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_DAT, EINHEIT_LAGE, HAUS_ID, EINHEIT_KURZNAME, EINHEIT_AUSSTATTUNG FROM EINHEIT where HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS SUMME FROM EINHEIT where HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT  DISTINCT MIETVERTRAG.EINHEIT_ID, MIETVERTRAG.MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_PERSON_ID";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " FROM `MIETVERTRAG`, PERSON_MIETVERTRAG WHERE ((MIETVERTRAG_BIS = '0000-00-00')OR (MIETVERTRAG_BIS >'2008-06-10'))";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " && ( MIETVERTRAG.MIETVERTRAG_ID = PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID) ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID = '$id' order by EINHEIT_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>='$datum_heute') ORDER BY MIETVERTRAG_VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT where EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM EINHEIT where EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && (MIETVERTRAG_BIS ='0000-00-00' OR MIETVERTRAG_BIS>=$heute) ORDER BY MIETVERTRAG_VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile1\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td>$mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        $einheit_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile2\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td> $mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $counter = 0;
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT where HAUS_ID='" . $haus_ids [$i] [HAUS_ID] . "' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_DAT FROM EINHEIT WHERE EINHEIT_ID='$einheit_id' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$akt_mietvertrag_id', '$von', '$bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_mietvertrag_dat_of_mietvertrag_id ( $akt_mietvertrag_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && ((MIETVERTRAG_BIS = '0000-00-00') OR (MIETVERTRAG_BIS > '$datum_heute')) order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM EINHEIT ORDER BY EINHEIT_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_KURZNAME LIKE '$einheit_kurzname' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT (EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_AKTUELL, EINHEIT_KURZNAME) VALUES (NULL,'$einheit_id','$einheit_qm', '$einheit_lage', '$haus_id', '1', '$einheit_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_einheit_dat_of_einheit_id ( $einheit_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"einheiten\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID, $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$EINHEIT_ID\">$EINHEIT_KURZNAME</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_DAT, $EINHEIT_ID, $EINHEIT_QM, $EINHEIT_LAGE, $HAUS_ID, $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE EINHEIT SET EINHEIT_AKTUELL='0' WHERE EINHEIT_DAT='$einheit_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_DAT FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT (EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_AKTUELL, EINHEIT_KURZNAME) VALUES (NULL,'$einheit_id','$einheit_qm', '$einheit_lage', '$haus_id', '1', '$einheit_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $akt_einheit_dat = letzte_einheit_dat ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' &&  MIETVERTRAG_VON = '$von'  && MIETVERTRAG_BIS = '$bis'  LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_VON = '$von' && MIETVERTRAG_BIS = '$bis' LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$von', '$bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `WEG_EIG_ID` FROM `WEG_EIGENTUEMER_PERSON` WHERE `PERSON_ID` = '$person_id' AND `AKTUELL` = '1' && `WEG_EIG_ID` IN (SELECT ID FROM  `WEG_MITEIGENTUEMER` WHERE  `EINHEIT_ID` ='$einheit_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG.MIETVERTRAG_BIS>='$this->datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $db_abfrage ) ) {
        \end_layout
            \begin_layout Plain Layout
        $this->vermietete_einheiten [] [mv_id] = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' &&  MIETVERTRAG.MIETVERTRAG_BIS<'$this->datum_heute' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $db_abfrage ) ) {
        \end_layout
            \begin_layout Plain Layout
        $this->unvermietete_einheiten [] [mv_id] = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, EINHEIT.TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE OBJEKT.OBJEKT_ID='$objekt_id' && `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1'  && EINHEIT.TYP = 'Gewerbe' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_STADT, TYP FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` WHERE `HAUS_ID` = '$haus_id' AND `EINHEIT_AKTUELL` ='1' && TYP='Gewerbe'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` WHERE `HAUS_ID` = '$haus_id' AND `EINHEIT_AKTUELL` ='1' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function liste_aller_einheiten_im_haus($haus_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID='$einheit_id' ORDER BY EINHEIT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // print_r($row);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' ORDER BY MIETVERTRAG_VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' ORDER BY MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID='$einheit_id' ORDER BY EINHEIT_DAT LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TYP FROM EINHEIT GROUP BY TYP ORDER BY TYP ASC" );
        \end_layout
            \begin_layout Plain Layout
        $typ_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' ORDER BY MIETVERTRAG_VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON $asc LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID='$einheit_id' ORDER BY EINHEIT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // print_r($row);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_KURZNAME='$einheit_name' ORDER BY EINHEIT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT EINHEIT_ID FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_KURZNAME='$einheit_name' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY LENGTH(EINHEIT_KURZNAME), EINHEIT_KURZNAME" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_KURZNAME LIKE '$anfang%' ORDER BY EINHEIT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array = array ();
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=1 id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $einheiten_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $einheit_kurzname = $einheiten_arr [$a] [EINHEIT_KURZNAME];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function dropdown_einheit_typen($label, $name, $id, $vorwahl) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        fehlermeldung_ausgeben ( "Keine Einheiten erfasst!" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM `MIETVERTRAG` WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL='1' && ((MIETVERTRAG_BIS<'$datum_heute') && (MIETVERTRAG_BIS!='0000-00-00')) ORDER BY MIETVERTRAG_BIS DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_id = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_ID='$alle_einheiten_array[$a][EINHEIT_ID]' && (MIETVERTRAG_BIS>='$datum_heute' OR MIETVERTRAG_BIS = '0000-00-00') ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'EINHEIT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function einheit_update($einheit_dat, $einheit_id, $kurzname, $lage, $qm, $haus_id, $typ) {
        \end_layout
            \begin_layout Plain Layout
        $this->einheit_deaktivieren ( $einheit_dat );
        \end_layout
            \begin_layout Plain Layout
        $last_id = $einheit_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'EINHEIT', $last_dat, $einheit_dat );
        \end_layout
            \begin_layout Plain Layout
        return $last_dat;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE EINHEIT SET EINHEIT_AKTUELL='0' WHERE EINHEIT_DAT='$einheit_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_mietvertraege_gesamt = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_ID='$einheit_id' && ((MIETVERTRAG_BIS>='$datum_heute') OR (MIETVERTRAG_BIS = '0000-00-00')) ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->get_einheit_info ( $row ['EINHEIT_ID'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$letzte_artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '$pos_skonto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( DETAIL_INHALT ) AS SUMME FROM DETAIL WHERE DETAIL_AKTUELL = '1' && DETAIL_ZUORDNUNG_TABELLE = 'EINHEIT' && DETAIL_ZUORDNUNG_ID = '$einheit_id' && (DETAIL_NAME = 'Miete kalt' OR DETAIL_NAME = 'Nebenkosten Vorauszahlung' OR DETAIL_NAME = 'Heizkosten Vorauszahlung')  " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM `EINHEIT` WHERE $m_lage  EINHEIT_AKTUELL='1' && EINHEIT_ID NOT
        \end_layout
            \begin_layout Plain Layout
        IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, MIETVERTRAG_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS = '0000-00-00' )" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM FENSTER_EINGEBAUT WHERE R_BELEG_ID='$beleg_id' && POS='$pos' && EINHEIT_ID='$einheit_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO FENSTER_EINGEBAUT VALUES (NULL, '$beleg_id', '$pos', '$einheit_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(EINHEIT_ID) AS ANZ, EINHEIT_ID  FROM `FENSTER_EINGEBAUT` WHERE `R_BELEG_ID` = '$beleg_nr' AND `POS` ='$pos' GROUP BY EINHEIT_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_ID, W_NAME FROM `WIRT_EINHEITEN` WHERE `AKTUELL`='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EIN_TAB` WHERE `W_ID` ='$w_id' AND `EINHEIT_ID` ='$einheit_id' AND `AKTUELL` = '1' LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT.*, HAUS.* FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ORDER BY LENGTH(EINHEIT.EINHEIT_KURZNAME) ASC, EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && EINHEIT.TYP='$typ' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_ID  FROM `WIRT_EINHEITEN` WHERE  WIRT_EINHEITEN.AKTUELL='1' &&  WIRT_EINHEITEN.W_NAME='$w_name' ORDER BY W_DAT DESC LIMIT 0,1 ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && EINHEIT.TYP='Gewerbe' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN`  WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EINHEITEN VALUES (NULL, '$last_w_id', '$w_name',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<SELECT SIZE=\"10\" NAME=\"IMPORT_AUS\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anzahl; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $e_id = $einheiten_arr [$a] [EINHEIT_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</SELECT>";
        \end_layout
            \begin_layout Plain Layout
        echo "<p>Einheiten: $this->anzahl_e</p>";
        \end_layout
            \begin_layout Plain Layout
        echo "<p>QM: $this->g_qm m²</p>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<SELECT SIZE=\"10\" NAME=\"IMPORT_AUS\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anzahl; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $ein_id = $e_array [$a] [EINHEIT_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT JOIN HAUS ON(HAUS.HAUS_ID=EINHEIT.HAUS_ID) JOIN OBJEKT ON(HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id' && EINHEIT_ID='$e_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID = '$id' order by EINHEIT_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID = '$id' order by MIETVERTRAG_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID, $MIETVERTRAG_VON, $MIETVERTRAG_BIS ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $leerstand ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $einheit_id = $leerstand [$a] ['EINHEIT_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$akt_mietvertrag_id', '$von', '$bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_mietvertrag_dat_of_mietvertrag_id ( $akt_mietvertrag_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON, MIETVERTRAG_BIS, MIETVERTRAG_DAT, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, OBJEKT.OBJEKT_ID, OBJEKT_KURZNAME, HAUS.HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ,HAUS_STADT FROM MIETVERTRAG RIGHT JOIN(EINHEIT,HAUS,OBJEKT) ON (MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID && EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_AKTUELL='1' &&  HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id'  ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$mietvertrag_id_alt', '$mietvertrag_von', '$mietvertrag_bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] ['HAUS_ID'] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETVERTRAG` WHERE (MIETVERTRAG_VON<='$datum_bis' && (MIETVERTRAG_BIS='0000-00-00' OR (MIETVERTRAG_BIS >= '$datum_von'))) && `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG.EINHEIT_ID IN (SELECT EINHEIT_ID FROM EINHEIT, HAUS, OBJEKT WHERE EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID='$objekt_id' && EINHEIT.EINHEIT_AKTUELL='1') ORDER BY EINHEIT_ID, MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function dropdown_v_einheiten($beschreibung, $name, $id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT V_EINHEIT, BEZEICHNUNG  FROM VERPACKUNGS_E WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_PROFILE VALUES (NULL, '$last_bk_id', '$bez', 'Wirtschaftseinheit', '$w_id','$jahr','$ber_datum','$ver_datum', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_schluessel = $row [QM];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM `MIETVERTRAG` WHERE EINHEIT_ID = '$einheit_id' && `MIETVERTRAG_AKTUELL` = '1' ORDER BY `MIETVERTRAG`.`MIETVERTRAG_VON` ASC " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$jahr-01-01', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$jahr-01-01', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$von', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN VALUES (NULL, '$last_b_id', '$profil_id', '$profil_bez','$profil_jahr', '$wirt_e', '$wirt_name', '$datum', '$anz_einheiten', '$qm_gesamt', '$qm_wohnraum', '$qm_gewerbe', '$anz_konten', '$anz_abrechnungen', '$ersteller', '$partner_id','$kontenrahmen_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABRECHNUNGEN VALUES (NULL, '$last_e_id', '$b_id','$empf', '$zeitraum', '$mieternr', '$einheit_id','$einheit_name','$g_kosten','$g_hndl', '$vorschuss', '$saldo', '$saldo_art', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_NAME FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME, EINHEIT_ID FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME, $EINHEIT_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$EINHEIT_ID\" selected>$EINHEIT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$EINHEIT_ID\">$EINHEIT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz_gk = count ( $gk_arr_objekt );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$ID\" selected>$einheit_kn***$weg->eigentuemer_name_str</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$ID\" >$einheit_kn***$weg->eigentuemer_name_str</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$ID\" selected>$einheit_kn***$weg->eigentuemer_name_str</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$ID\" >$einheit_kn***$weg->eigentuemer_name_str</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$einheit_kn | $mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$einheit_kn | $mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$eigentuemer_id\" selected>$e->einheit_kurzname | $weg->eigentuemer_namen2</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$eigentuemer_id\">$e->einheit_kurzname | $weg->eigentuemer_namen2</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2008-03-01' && EINHEIT.EINHEIT_KURZNAME LIKE '%E-%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2007-01-01' && EINHEIT.EINHEIT_KURZNAME NOT LIKE '%E-%'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG, MIETENTWICKLUNG.MWST_ANTEIL FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' GROUP BY MIETENTWICKLUNG_DAT ORDER BY KOSTENKATEGORIE ASC, ANFANG ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY KOSTENKATEGORIE ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO DETAIL VALUES(NULL, '$last_detail_id', '$kosten_kat', '$einheit_betrag', '$einheit_kurzname $anfang bis $ende', '1', 'EINHEIT','$einheit_id')";
        \end_layout
            \begin_layout Plain Layout
        echo " '$last_detail_id', '$kosten_kat', '$einheit_betrag', '$einheit_kurzname $anfang bis $ende', '1', 'EINHEIT','$einheit_id'<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, ANFANG, ENDE, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME
        \end_layout
            \begin_layout Plain Layout
        FROM `MIETENTWICKLUNG` , MIETVERTRAG, EINHEIT
        \end_layout
            \begin_layout Plain Layout
        WHERE `KOSTENKATEGORIE` LIKE '$kosten_kat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM `MIETVERTRAG`
        \end_layout
            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR (`KOSTENTRAEGER_TYP` = 'Mietvertrag' AND `KOSTENTRAEGER_ID` = '$mv_id') OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id')  OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id') $mv_string)    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "<br><br><br>SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS > '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id')) $betrag_sql $text_sql $konto_sql   AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // $this->get_einheit_info($row[EINHEIT_ID]);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_KURZNAME FROM EINHEIT where EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_BIS>='$this->datum_heute' OR MIETVERTRAG_BIS='0000-00-00' && MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $mv_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME,  EINHEIT_QM,  EINHEIT.HAUS_ID,  CONCAT(HAUS_STRASSE, HAUS_NUMMER) AS HAUS_STRASSE,  EINHEIT_QM, TRIM(EINHEIT_LAGE) AS EINHEIT_LAGE, EINHEIT.TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m-%d' ) <= '$datum' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m-%d' ) >= '$datum'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_ZUORDNUNG_ID AS EINHEIT_ID, DETAIL_INHALT, DETAIL_BEMERKUNG, STR_TO_DATE(DETAIL_INHALT,'%d.%m.%Y') , DATE_FORMAT(NOW(), '%Y-%m-%d')  FROM `DETAIL` WHERE `DETAIL_NAME` = 'Besichtigungstermin' AND `DETAIL_AKTUELL` = '1' AND  (STR_TO_DATE(DETAIL_INHALT,'%d.%m.%Y') $vor_nach= CURDATE()) AND `DETAIL_ZUORDNUNG_TABELLE` = 'EINHEIT' && DETAIL_ZUORDNUNG_ID IN (SELECT EINHEIT_ID FROM `EINHEIT` WHERE `EINHEIT_AKTUELL` = '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function expose_aktualisieren($einheit_id, $zimmer, $balkon, $expose_bk, $expose_km, $expose_hk, $heizungsart, $expose_frei, $besichtigungsdatum, $uhrzeit) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, EINHEIT FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && AKTUELL='1' GROUP BY ARTIKEL_NR ORDER BY KATALOG_DAT DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anzahl_artikel = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_eigentuemer_arr($einheit_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON $sortvon" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' && (DATE_FORMAT(VON, '%Y') <='$jahr' AND BIS='0000-00-00' OR DATE_FORMAT(VON, '%Y') <='$jahr' AND DATE_FORMAT(BIS, '%Y') >='$jahr') ORDER BY VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' && (DATE_FORMAT(VON, '%Y') <='$jahr' AND BIS='0000-00-00' OR DATE_FORMAT(VON, '%Y') <='$jahr' AND DATE_FORMAT(BIS, '%Y') >='$jahr') ORDER BY VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, VON, BIS FROM WEG_MITEIGENTUEMER WHERE ID='$e_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIGENTUEMER_PERSON.WEG_EIG_ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM WEG_EIGENTUEMER_PERSON, WEG_MITEIGENTUEMER,EINHEIT WHERE PERSON_ID='$person_id' && WEG_MITEIGENTUEMER.AKTUELL='1' && WEG_EIGENTUEMER_PERSON.AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && WEG_EIGENTUEMER_PERSON.WEG_EIG_ID=WEG_MITEIGENTUEMER.ID && WEG_MITEIGENTUEMER.EINHEIT_ID=EINHEIT.EINHEIT_ID GROUP BY WEG_EIG_ID" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM EINHEIT WHERE TYP LIKE '%eigentum%' && EINHEIT_AKTUELL='1' GROUP BY HAUS_ID" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=\"1\" id=\"$id\" $js>\n";
        \end_layout
            \begin_layout Plain Layout
        $anz = count ( $einheiten_arr );
        \end_layout
            \begin_layout Plain Layout
        echo "$anz Einheiten";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( 'Keine Einheiten im Objekt' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=\"1\" id=\"$id\" $js>\n";
        \end_layout
            \begin_layout Plain Layout
        $anz = count ( $arr );
        \end_layout
            \begin_layout Plain Layout
        echo "$anz Einheiten";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=\"1\" id=\"$id\" $js>\n";
        \end_layout
            \begin_layout Plain Layout
        $anz = count ( $arr );
        \end_layout
            \begin_layout Plain Layout
        echo "$anz Einheiten";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$eigentuemer_von', '$eigentuemer_bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$eigentuemer_von', '$eigentuemer_bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$von', '$bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WG_DEF VALUES (NULL, '$id', '$von', '$bis', '$betrag', '$kostenkat', '$e_konto', '$gruppe', '$g_konto','Einheit', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $f->send_button ( "delete", "Alle Löschen" );
        \end_layout
            \begin_layout Plain Layout
        // $f->check_box_js_alle('nn', 'nn', 'NN', 'Alle markieren', '', '', 'mv_ids');
        \end_layout
            \begin_layout Plain Layout
        $anz_einheit = count ( $eigent_arr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "UPDATE AK4 für OBJEKT $objekt_id<br>";
        \end_layout
            \begin_layout Plain Layout
        $o = new objekt ();
        \end_layout
            \begin_layout Plain Layout
        $einheiten_arr = $o->einheiten_objekt_arr ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG  LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'  && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID) LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'   ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
FEIERTAGE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `FEIERTAGE` (

\end_layout
\begin_layout Plain Layout

  `F_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FEIERTAG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`F_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
F_DAT 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
FEIERTAG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
FENSTER_EINGEBAUT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `FENSTER_EINGEBAUT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `R_BELEG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POS` int(5) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
R_BELEG_ID 
\end_layout
\begin_layout Description
POS 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM FENSTER_EINGEBAUT WHERE R_BELEG_ID='$beleg_id' && POS='$pos'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM FENSTER_EINGEBAUT WHERE R_BELEG_ID='$beleg_id' && POS='$pos' && EINHEIT_ID='$einheit_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO FENSTER_EINGEBAUT VALUES (NULL, '$beleg_id', '$pos', '$einheit_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(*) AS EINGEBAUT  FROM `FENSTER_EINGEBAUT` WHERE `R_BELEG_ID` = '$beleg_nr' AND `POS` ='$pos' " );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['EINGEBAUT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(EINHEIT_ID) AS ANZ, EINHEIT_ID  FROM `FENSTER_EINGEBAUT` WHERE `R_BELEG_ID` = '$beleg_nr' AND `POS` ='$pos' GROUP BY EINHEIT_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
FENSTER_LIEFERUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `FENSTER_LIEFERUNG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `R_BELEG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POS` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=18 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
R_BELEG_ID 
\end_layout
\begin_layout Description
POS 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `FENSTER_LIEFERUNG` WHERE `R_BELEG_ID` ='$beleg_id' AND `POS` ='$pos' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO FENSTER_LIEFERUNG VALUES (NULL, '$beleg_id', '$pos')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM FENSTER_LIEFERUNG WHERE R_BELEG_ID='$beleg_id' && POS='$pos'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT R_BELEG_ID, POS, ARTIKEL_NR, PREIS, MENGE, ART_LIEFERANT FROM `FENSTER_LIEFERUNG`, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE R_BELEG_ID=BELEG_NR && POS=POSITION" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
FOOTER_ZEILE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `FOOTER_ZEILE` (

\end_layout
\begin_layout Plain Layout

  `FOOTER_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `FOOTER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FOOTER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FOOTER_TYP_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZAHLUNGSHINWEIS` mediumtext COLLATE latin1_german2_ci,

\end_layout
\begin_layout Plain Layout

  `ZEILE1` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZEILE2` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HEADER` varchar(200) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`FOOTER_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=12 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
FOOTER_DAT 
\end_layout
\begin_layout Description
FOOTER_ID 
\end_layout
\begin_layout Description
FOOTER_TYP 
\end_layout
\begin_layout Description
FOOTER_TYP_ID 
\end_layout
\begin_layout Description
ZAHLUNGSHINWEIS 
\end_layout
\begin_layout Description
ZEILE1 
\end_layout
\begin_layout Description
ZEILE2 
\end_layout
\begin_layout Description
HEADER 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZEILE1, ZEILE2 FROM FOOTER_ZEILE WHERE AKTUELL = '1' && FOOTER_TYP = '$this->rechnungs_aussteller_typ' && FOOTER_TYP_ID = '$this->rechnungs_aussteller_id' ORDER BY FOOTER_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $nums = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($nums) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZAHLUNGSHINWEIS FROM FOOTER_ZEILE WHERE AKTUELL = '1' && FOOTER_TYP = '$this->rechnungs_aussteller_typ' && FOOTER_TYP_ID = '$this->rechnungs_aussteller_id' ORDER BY FOOTER_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $nums = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($nums) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM FOOTER_ZEILE WHERE FOOTER_TYP='$typ' && FOOTER_TYP_ID='$id' && AKTUELL='1' ORDER BY  FOOTER_ID ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->footer_typ = $row ['FOOTER_TYP'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
GELD_KONTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GELD_KONTEN` (

\end_layout
\begin_layout Plain Layout

  `KONTO_DAT` int(4) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTO_ID` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGUENSTIGTER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTONUMMER` varchar(15) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BLZ` varchar(15) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `INSTITUT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTO_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `KONTO_ID` (`KONTO_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `KONTONUMMER` (`KONTONUMMER`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1942 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTO_DAT 
\end_layout
\begin_layout Description
KONTO_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
BEGUENSTIGTER 
\end_layout
\begin_layout Description
KONTONUMMER 
\end_layout
\begin_layout Description
BLZ 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
INSTITUT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTO_ID, BEZEICHNUNG  FROM `GELD_KONTEN`  WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $KONTO_ID, $BEZEICHNUNG ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTO_ID, BEZEICHNUNG  FROM `GELD_KONTEN`  WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $KONTO_ID, $BEZEICHNUNG ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$konto_id','$clean_arr[partnername] - Konto','$clean_arr[partnername]', '$clean_arr[KONTONUMMER]','$clean_arr[BLZ]', '$clean_arr[kreditinstitut]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Geldkonto dem Partner zuweisen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN_ZUWEISUNG VALUES (NULL, '$letzte_zuweisung_id','$konto_id', 'Partner','$partner_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID FROM GELD_KONTEN ORDER BY KONTO_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTO_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZUWEISUNG_ID FROM GELD_KONTEN_ZUWEISUNG ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZUWEISUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, IBAN, BIC FROM GELD_KONTEN WHERE  GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.BEGUENSTIGTER ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN WHERE  GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEGUENSTIGTER, KONTONUMMER, BLZ, INSTITUT, BEZEICHNUNG, BIC, IBAN  FROM GELD_KONTEN WHERE KONTO_ID='$konto_id' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT  FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.INSTITUT, GELD_KONTEN.IBAN, GELD_KONTEN.BIC FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID,GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID  ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN WHERE  KONTO_ID='$id' && GELD_KONTEN.AKTUELL = '1' ORDER BY KONTO_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTO_ID, BEZEICHNUNG  FROM `GELD_KONTEN`  WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $KONTO_ID, $BEZEICHNUNG ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$gk_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_KONTOS` WHERE `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' AND `AKTUELL` = '1' ORDER BY BEGUENSTIGTER";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT,  GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE  GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez%' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.BEGUENSTIGTER ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez' ORDER BY GELD_KONTEN.KONTO_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTEN` WHERE `KONTO_ID` = '$gk_id' AND `AKTUELL` = '1' ORDER BY KONTO_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function geldkonto_update($gk_id, $g_bez, $beguenstigter, $kontonummer, $blz, $institut, $iban, $bic) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN SET AKTUELL='0' WHERE KONTO_ID='$gk_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN SET AKTUELL='0' WHERE KONTO_ID='$gk_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$gk_id', '$g_bez','$beguenstigter', '$kontonummer', '$blz','$iban', '$bic', '$institut', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$last_b_id', '$g_bez','$beguenstigter', '$kontonummer', '$blz','$iban', '$bic', '$institut', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE GELD_KONTEN.AKTUELL = '1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE GELD_KONTEN.AKTUELL = '1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE GELD_KONTEN.AKTUELL = '1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KOSTENTRAEGER_ID FROM GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE AKTUELL = '1' && KONTONUMMER='$kontonummer' && BLZ='$blz' && INSTITUT='$institut'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN_ZUWEISUNG VALUES (NULL, '$last_b_id', '$geldkonto_id', '$kos_typ','$kos_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN_ZUWEISUNG SET AKTUELL='0' WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '$last_dat');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID  FROM GELD_KONTEN WHERE BEZEICHNUNG='$bezeichnung' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTO_ID FROM GELD_KONTEN WHERE BEZEICHNUNG='$bezeichnung' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1<br>";
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID  FROM GELD_KONTEN WHERE KONTONUMMER='$kto' && BLZ='$blz' &&  AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,2" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTO_ID FROM GELD_KONTEN WHERE KONTONUMMER='$kto' && BLZ='$blz' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1<br>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID  FROM GELD_KONTEN WHERE IBAN='$iban'  &&  AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,2" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTO_ID FROM GELD_KONTEN WHERE IBAN='$iban' && AKTUELL='1' ORDER BY KONTO_DAT DESC LIMIT 0,1<br>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, IBAN, GELD_KONTEN_ZUWEISUNG.KOSTENTRAEGER_TYP, GELD_KONTEN_ZUWEISUNG.KOSTENTRAEGER_ID   FROM `GELD_KONTEN`, GELD_KONTEN_ZUWEISUNG WHERE GELD_KONTEN.IBAN = '$iban' AND GELD_KONTEN.KONTO_ID=GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->iban_kos_typ = $row ['KOSTENTRAEGER_TYP'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_iban_bic_alle() {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE GELD_KONTEN.AKTUELL = '1' ORDER BY KONTO_DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN WHERE GELD_KONTEN.AKTUELL = '1' ORDER BY KONTO_DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN SET IBAN='$sep->IBAN', BIC='$sep->BIC' WHERE KONTO_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID FROM GELD_KONTEN ORDER BY KONTO_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTO_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZUWEISUNG_ID FROM GELD_KONTEN_ZUWEISUNG ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZUWEISUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID FROM GELD_KONTEN_ZUWEISUNG WHERE KOSTENTRAEGER_TYP='Partner' && KOSTENTRAEGER_ID='$partner_id' ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTO_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
GELD_KONTEN_ZUWEISUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GELD_KONTEN_ZUWEISUNG` (

\end_layout
\begin_layout Plain Layout

  `ZUWEISUNG_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ZUWEISUNG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_ID` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ZUWEISUNG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `KONTO_ID` (`KONTO_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_TYP` (`KOSTENTRAEGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_ID` (`KOSTENTRAEGER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2733 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ZUWEISUNG_DAT 
\end_layout
\begin_layout Description
ZUWEISUNG_ID 
\end_layout
\begin_layout Description
KONTO_ID 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN_ZUWEISUNG VALUES (NULL, '$letzte_zuweisung_id','$konto_id', 'Partner','$partner_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZUWEISUNG_ID FROM GELD_KONTEN_ZUWEISUNG ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZUWEISUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT  FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.INSTITUT, GELD_KONTEN.IBAN, GELD_KONTEN.BIC FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentraeger_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' ORDER BY GELD_KONTEN.KONTO_ID ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID,GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID  ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$gk_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.BEZEICHNUNG, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_KONTOS` WHERE `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' AND `AKTUELL` = '1' ORDER BY BEGUENSTIGTER";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT,  GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE  GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez%' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.BEGUENSTIGTER ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN.BEZEICHNUNG LIKE '%$filter_bez' ORDER BY GELD_KONTEN.KONTO_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KOSTENTRAEGER_ID FROM GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN_ZUWEISUNG VALUES (NULL, '$last_b_id', '$geldkonto_id', '$kos_typ','$kos_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN_ZUWEISUNG SET AKTUELL='0' WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '$last_dat');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, IBAN, GELD_KONTEN_ZUWEISUNG.KOSTENTRAEGER_TYP, GELD_KONTEN_ZUWEISUNG.KOSTENTRAEGER_ID   FROM `GELD_KONTEN`, GELD_KONTEN_ZUWEISUNG WHERE GELD_KONTEN.IBAN = '$iban' AND GELD_KONTEN.KONTO_ID=GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN.AKTUELL = '1' && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->iban_kos_typ = $row ['KOSTENTRAEGER_TYP'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZUWEISUNG_ID FROM GELD_KONTEN_ZUWEISUNG ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZUWEISUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_ID FROM GELD_KONTEN_ZUWEISUNG WHERE KOSTENTRAEGER_TYP='Partner' && KOSTENTRAEGER_ID='$partner_id' ORDER BY ZUWEISUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTO_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
GELD_KONTO_BUCHUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GELD_KONTO_BUCHUNGEN` (

\end_layout
\begin_layout Plain Layout

  `GELD_KONTO_BUCHUNGEN_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GELD_KONTO_BUCHUNGEN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_BUCHUNGSNUMMER` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_AUSZUGSNUMMER` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ERFASS_NR` varchar(20) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_ANTEIL` decimal(10,2) NOT NULL DEFAULT '0.00',

\end_layout
\begin_layout Plain Layout

  `VERWENDUNGSZWECK` mediumtext COLLATE latin1_german2_ci,

\end_layout
\begin_layout Plain Layout

  `GELDKONTO_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTO` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`GELD_KONTO_BUCHUNGEN_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `KONTENRAHMEN_KONTO` (`KONTENRAHMEN_KONTO`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_TYP` (`KOSTENTRAEGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_ID` (`KOSTENTRAEGER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`),

\end_layout
\begin_layout Plain Layout

  KEY `GELDKONTO_ID` (`GELDKONTO_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `idx_GELD_KONTO_BUCHUNGEN_ID` (`GELD_KONTO_BUCHUNGEN_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `GELDKONTO_BUCHUNGEN_ID` (`GELD_KONTO_BUCHUNGEN_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=698580 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
GELD_KONTO_BUCHUNGEN_DAT 
\end_layout
\begin_layout Description
GELD_KONTO_BUCHUNGEN_ID 
\end_layout
\begin_layout Description
G_BUCHUNGSNUMMER 
\end_layout
\begin_layout Description
KONTO_AUSZUGSNUMMER 
\end_layout
\begin_layout Description
ERFASS_NR 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
MWST_ANTEIL 
\end_layout
\begin_layout Description
VERWENDUNGSZWECK 
\end_layout
\begin_layout Description
GELDKONTO_ID 
\end_layout
\begin_layout Description
KONTENRAHMEN_KONTO 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function insert_geldbuchung($geldkonto_id, $buchungskonto, $auszugsnr, $rechnungsnr, $v_zweck, $datum, $kostentraeger_typ, $kostentraeger_id, $betrag) {
        \end_layout
            \begin_layout Plain Layout
        $last_id = last_id ( 'GELD_KONTO_BUCHUNGEN' );
        \end_layout
            \begin_layout Plain Layout
        $last_id = $last_id + 1;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES(NULL, '$last_id', '$auszugsnr', '$rechnungsnr', '$betrag', '$v_zweck', '$geldkonto_id', '$buchungskonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')" );
        \end_layout
            \begin_layout Plain Layout
        // echo "'$last_id', '$auszugsnr', '$betrag', '$v_zweck', '$geldkonto_id', '$buchungskonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id' <b>1</b><br>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anzahl_kriterien; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        if ($a == 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GELD_KONTO_BUCHUNGEN.BETRAG) AS GESAMTKOSTEN_MONATLICH FROM GELD_KONTO_BUCHUNGEN WHERE DATUM BETWEEN '$anfangsdatum' AND '$end_datum' && GELD_KONTO_BUCHUNGEN.GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' && KONTENRAHMEN_KONTO!='80001'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['GESAMTKOSTEN_MONATLICH'] . "</br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS MIETEINNAHMEN_MONATLICH FROM GELD_KONTO_BUCHUNGEN WHERE DATUM BETWEEN '$anfangsdatum' AND '$end_datum' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='80001' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS KONTOSTAND_GELDBUCHUNGEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS KONTOSTAND_GELDBUCHUNGEN_KONTIERT
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1' && KONTENRAHMEN_KONTO = '$kontenrahmen_konto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * AS KONTOSTAND_GELDBUCHUNGEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1' && DATUM BETWEEN '$datum_von' AND '$datum_bis'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS SUMME_MIETEINNAHMEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && KONTENRAHMEN_KONTO='80001' &&  AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS SUMME_MIETEINNAHMEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && KONTENRAHMEN_KONTO='80001' && AKTUELL = '1' && DATUM BETWEEN '$datum_von' AND '$datum_bis'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS KONTOSTAND
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS KONTOSTAND
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_personal.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$gk_id' && `AKTUELL` = '1' && VERWENDUNGSZWECK LIKE '%$benutzername%' && KONTENRAHMEN_KONTO='$konto' ORDER BY G_BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  `KOSTENTRAEGER_TYP` ,  `KOSTENTRAEGER_ID` , SUM( BETRAG ) AS SUMME
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `GELDKONTO_ID` =614
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && GELD_KONTO_BUCHUNGEN_ID='$buchungs_id' ORDER BY GELD_KONTO_BUCHUNGEN_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME  FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$geldkonto_id' AND `KONTENRAHMEN_KONTO` = '$kostenkonto' AND DATUM BETWEEN '$von' AND '$bis' AND `AKTUELL` ='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m') BETWEEN '$vorjahr-12' AND '$nachjahr-03' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $von = date_german2mysql ( $_SESSION ['anzeigen_von'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m-%d') BETWEEN '$von' AND '$bis' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELD_KONTO_BUCHUNGEN_ID` ='$buchung_id' AND `AKTUELL` = '1' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_K_ID, SUM( BETRAG ) AS G_SUMME, SUM( HNDL_BETRAG ) AS HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT KONTO, t1.BK_K_ID,SUM(BETRAG) AS G_SUMME, SUM(A_SUMME) AS A_SUMME, KEY_ID,  KOS_TYP,  KOS_ID, ANTEIL, SUM(HNDL_BETRAG) AS HNDL_BETRAG FROM (SELECT BK_K_ID, BETRAG,  (BETRAG/100)*ANTEIL AS A_SUMME,  HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BK_K_ID, SUM( BETRAG ) AS G_SUMME , SUM( HNDL_BETRAG ) AS HNDL_BETRAG, KEY_ID, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_TYP AS KOS_TYP, BK_BERECHNUNG_BUCHUNGEN.KOSTENTRAEGER_ID AS KOS_ID, ANTEIL
        \end_layout
            \begin_layout Plain Layout
        FROM `BK_BERECHNUNG_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        JOIN GELD_KONTO_BUCHUNGEN ON ( BK_BERECHNUNG_BUCHUNGEN.BUCHUNG_ID = GELD_KONTO_BUCHUNGEN.GELD_KONTO_BUCHUNGEN_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELD_KONTO_BUCHUNGEN_DAT='$buchungs_dat' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->akt_buch_dat = $row ['GELD_KONTO_BUCHUNGEN_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTO_BUCHUNGEN SET AKTUELL='0' WHERE GELD_KONTO_BUCHUNGEN_DAT='$buchungs_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN_DAT', $buchungs_dat, $buchungs_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTO_BUCHUNGEN SET AKTUELL='1' WHERE GELD_KONTO_BUCHUNGEN_DAT='$alt_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN_DAT', $alt_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$geldbuchung_id', '$g_buchungsnummer', '$kontoauszugsnr', '$erfass_nr','$betrag1', '$mwst1', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Buchungsnr $geldbuchung_id wurde geändert!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$buchung_id', '$g_buchungsnummer', '$kto_auszugsnr', '$rechnungsnr', '$betrag', '$mwst', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<h1>Neue Buchungsnummer erteilt: $g_buchungsnummer</h1>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "<h3>Betrag von $betrag € wurde gebucht.</h3>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$buchung_id', '$g_buchungsnummer', '$kto_auszugsnr', '$rechnungsnr', '$betrag','$mwst', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "<h3>Betrag von $betrag € wurde gebucht.</h3>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && GELDKONTO_ID='$_SESSION[geldkonto_id]' && KONTENRAHMEN_KONTO='$kostenkonto' && DATUM BETWEEN '$von' AND '$bis' ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTO_BUCHUNGEN_ID FROM GELD_KONTO_BUCHUNGEN ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['GELD_KONTO_BUCHUNGEN_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO_AUSZUGSNUMMER FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y' ) = '$jahr'  && `AKTUELL` = '1' ORDER BY KONTO_AUSZUGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTO_AUSZUGSNUMMER'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT G_BUCHUNGSNUMMER FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y' ) = '$jahr'  && `AKTUELL` = '1' ORDER BY G_BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['G_BUCHUNGSNUMMER'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT( DATUM, '%Y' ) = $temp_jahr   && GELDKONTO_ID='$geldkonto_id' && KONTO_AUSZUGSNUMMER='$kto_auszug' && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $link_reset_auszug = "<a href=\"?daten=buchen&option=reset_kontoauszug\">Ohne Kontoauszug</a>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo'  && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL,GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL,GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y') = '$ja' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' $str_kos GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' $str_kos GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `GELD_KONTO_BUCHUNGEN` WHERE  `DATUM` <  '$jahr-01-01' AND  `AKTUELL` =  '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT date_format(DATUM,'%d.%m.%Y') AS DATUM, G_BUCHUNGSNUMMER, ERFASS_NR, KONTO_AUSZUGSNUMMER, BETRAG, MWST_ANTEIL, RTRIM(LTRIM(VERWENDUNGSZWECK)) AS VERWENDUNGSZWECK, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        // die("JAHR: $jahr");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT date_format(DATUM,'%d.%m.%Y') AS DATUM, G_BUCHUNGSNUMMER, ERFASS_NR, KONTO_AUSZUGSNUMMER, BETRAG, MWST_ANTEIL,RTRIM(LTRIM(VERWENDUNGSZWECK)) AS VERWENDUNGSZWECK, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $this->summe_konto_buchungen = 0.00;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATUM<='$datum' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO != '$mieteinnahmen_kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) <= CURDATE()) && AKTUELL='1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO != '$mieteinnahmen_kostenkonto' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-$monat-$ltag' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$mieteinnahmen_kostenkonto' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-$monat-$ltag' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `KONTO_AUSZUGSNUMMER` =  '$auszug'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE  KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' ORDER BY GELDKONTO_ID, BETRAG, DATUM, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM,'%Y-%m')='$jahr-$monat' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        if ($bet == '-') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM,'%Y-%m')='$jahr-$monat' && AKTUELL='1' && BETRAG<0" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM,'%Y-%m')='$jahr-$monat' && AKTUELL='1' && BETRAG>0" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `KONTO_AUSZUGSNUMMER` ='$kontoauszug'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$buchung_id', '$g_buchungsnummer', '$kto_auszugsnr', '$m_ref', '$betrag', '$mwst', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' && GELDKONTO_ID='$kautions_konto_id' && AKTUELL='1' ORDER BY DATUM" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN  WHERE   AKTUELL='1' && GELDKONTO_ID='$gk_id' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN  WHERE  DATUM<='$datum_bis' && AKTUELL='1' && GELDKONTO_ID='$gk_id' && KONTENRAHMEN_KONTO!='2002' && KONTENRAHMEN_KONTO!='2003' && KONTENRAHMEN_KONTO!='2004' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM `MIETVERTRAG`
        \end_layout
            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1'  ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM $sort";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage."<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR (`KOSTENTRAEGER_TYP` = 'Mietvertrag' AND `KOSTENTRAEGER_ID` = '$mv_id') OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id')  OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id') $mv_string)    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id')) $betrag_sql $text_sql $konto_sql   AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY DATUM DESC LIMIT 0,$buchungsanzahl" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE KONTO_AUSZUGSNUMMER = '$kontoauszugsnr' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' && DATUM= '$buchungsdatum' && BETRAG= '$betrag' && VERWENDUNGSZWECK= '$v_zweck' && AKTUELL= '1' && GELDKONTO_ID= '$geld_konto_id' && KONTENRAHMEN_KONTO='$kontenrahmen_konto'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function insert_geldbuchung($geldkonto_id, $buchungskonto, $auszugsnr, $rechnungsnr, $v_zweck, $datum, $kostentraeger_typ, $kostentraeger_id, $betrag, $mwst_anteil = '0.00') {
        \end_layout
            \begin_layout Plain Layout
        $last_id = last_id ( 'GELD_KONTO_BUCHUNGEN' );
        \end_layout
            \begin_layout Plain Layout
        $last_id = $last_id + 1;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES(NULL, '$last_id', '$g_buchungsnummer', '$auszugsnr', '$rechnungsnr', '$betrag', '$mwst_anteil', '$v_zweck', '$geldkonto_id', '$buchungskonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')" );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && GELDKONTO_ID='$geldkonto_id' && AKTUELL = '1' ORDER BY DATUM ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && AKTUELL = '1' ORDER BY DATUM ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' &&  KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='80001' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $my_arr = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '" . $this->jahr_heute . "-" . $this->monat_heute . "'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS KONTOSTAND FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geld_konto_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS KONTOSTAND FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_ZAHLBETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_ZAHLBETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='$kostenkonto' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m')<='$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' && BEMERKUNG NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK AS BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE  GELDKONTO_ID='$gk->geldkonto_id' $ko_string && KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( 'Kein Geldkonto für das Objekt hinterlegt' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK AS BEMERKUNG FROM GELD_KONTO_BUCHUNGEN && KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$buchungskonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$buchungskonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(DATUM, '%d.%m.%Y') AS DATUM_D FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$kostenkonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$kostenkonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && `KONTENRAHMEN_KONTO` = '$kostenkonto' GROUP BY KOSTENTRAEGER_ID ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO FROM GELD_KONTO_BUCHUNGEN WHERE  AKTUELL='1' && GELDKONTO_ID='$geld_konto_id' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO, SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr'  && AKTUELL='1' && GELDKONTO_ID='$gk_id' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  DATE_FORMAT(`DATUM`, '%d.%m.%Y') AS DATUMD, DATUM ,  `KONTENRAHMEN_KONTO` ,  `BETRAG` ,  `VERWENDUNGSZWECK`
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `GELDKONTO_ID` ='$gk_id' &&  `KOSTENTRAEGER_TYP` =  'Eigentuemer' &&  `KOSTENTRAEGER_ID` =  '$et_id' && DATE_FORMAT(  `DATUM` ,  '%Y' ) =  '$jahr' && AKTUELL='1' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  DATE_FORMAT(`DATUM`, '%d.%m.%Y') AS DATUMD, DATUM ,  `KONTENRAHMEN_KONTO` ,  `BETRAG` ,  `VERWENDUNGSZWECK`
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `GELDKONTO_ID` ='$gk_id' &&  `KOSTENTRAEGER_TYP` =  'Eigentuemer' &&  `KOSTENTRAEGER_ID` =  '$et_id' && DATE_FORMAT(  `DATUM` ,  '%Y' ) =  '$jahr' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTO, DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, KONTENRAHMEN_KONTO, `KOSTENTRAEGER_TYP`, `KOSTENTRAEGER_ID` FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // $pdf = new Cezpdf('a4', 'portrait');
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, KONTENRAHMEN_KONTO, `KOSTENTRAEGER_TYP`, `KOSTENTRAEGER_ID` FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTO_BUCHUNGEN WHERE AKTUELL = '1' && ERFASS_NR='$erfass_nr' && GELDKONTO_ID='$geldkonto_id' && VERWENDUNGSZWECK='$buchungstext'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  GELD_KONTO_BUCHUNGEN WHERE AKTUELL = '1' && GELDKONTO_ID='$geldkonto_id' && VERWENDUNGSZWECK='$buchungstext'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
GEO_ENTFERNUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GEO_ENTFERNUNG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(8) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GEO_DAT_START` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEO_DAT_ZIEL` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KM` varchar(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FAHRZEIT` varchar(50) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `QUELLE` varchar(20) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `GEO_DAT_START` (`GEO_DAT_START`),

\end_layout
\begin_layout Plain Layout

  KEY `GEO_DAT_ZIEL` (`GEO_DAT_ZIEL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=14927 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
GEO_DAT_START 
\end_layout
\begin_layout Description
GEO_DAT_ZIEL 
\end_layout
\begin_layout Description
KM 
\end_layout
\begin_layout Description
FAHRZEIT 
\end_layout
\begin_layout Description
QUELLE 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
GEO_LON_LAT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GEO_LON_LAT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `STR` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NR` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLZ` decimal(7,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ORT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LON` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LAT` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `QUELLE` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `STR` (`STR`),

\end_layout
\begin_layout Plain Layout

  KEY `NR` (`NR`),

\end_layout
\begin_layout Plain Layout

  KEY `PLZ` (`PLZ`),

\end_layout
\begin_layout Plain Layout

  KEY `ORT` (`ORT`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`),

\end_layout
\begin_layout Plain Layout

  KEY `QUELLE` (`QUELLE`),

\end_layout
\begin_layout Plain Layout

  KEY `LAT` (`LAT`),

\end_layout
\begin_layout Plain Layout

  KEY `LON` (`LON`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=850 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
STR 
\end_layout
\begin_layout Description
NR 
\end_layout
\begin_layout Description
PLZ 
\end_layout
\begin_layout Description
ORT 
\end_layout
\begin_layout Description
LON 
\end_layout
\begin_layout Description
LAT 
\end_layout
\begin_layout Description
QUELLE 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
GEO_TERMINE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GEO_TERMINE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` time NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` time NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEXT` mediumtext CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GERAETE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HINWEIS` varchar(200) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINGEGEBEN_AM` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `EINGEGEBEN_VON` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGESAGT_AM` timestamp NULL DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGESAGT_VON` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`),

\end_layout
\begin_layout Plain Layout

  KEY `GERAETE_ID` (`GERAETE_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `VON` (`VON`),

\end_layout
\begin_layout Plain Layout

  KEY `BIS` (`BIS`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3353 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
GERAETE_ID 
\end_layout
\begin_layout Description
HINWEIS 
\end_layout
\begin_layout Description
EINGEGEBEN_AM 
\end_layout
\begin_layout Description
EINGEGEBEN_VON 
\end_layout
\begin_layout Description
ABGESAGT_AM 
\end_layout
\begin_layout Description
ABGESAGT_VON 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `GEO_TERMINE` WHERE  `GERAETE_ID` ='$g_id' && AKTUELL='1' ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT (SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID=W_GERAETE.KOSTENTRAEGER_ID && AKTUELL='1' ORDER BY PARTNER_DAT DESC LIMIT 0,1) AS PART, `GERAETE_ID`, LAGE_RAUM AS EINBAUORT, HERSTELLER, BEZEICHNUNG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, `INTERVAL_M`, DATE_FORMAT(NOW(),'%Y-%m-%d') as HEUTE, DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -INTERVAL_M MONTH),'%Y-%m-%d') AS L_WART_FAELLIG, (SELECT DATUM FROM GEO_TERMINE WHERE GERAETE_ID=W_GERAETE.GERAETE_ID && AKTUELL='1' ORDER BY DATUM DESC LIMIT 0,1) AS L_WART FROM `W_GERAETE` WHERE `AKTUELL`='1' && GRUPPE_ID='$gruppen_id' && `KOSTENTRAEGER_TYP`='Partner' && (`KOSTENTRAEGER_ID`='3' or `KOSTENTRAEGER_ID`='947' or `KOSTENTRAEGER_ID`='986' or `KOSTENTRAEGER_ID`='661' or `KOSTENTRAEGER_ID`='1148' or `KOSTENTRAEGER_ID`='974') &&
        \end_layout
            \begin_layout Plain Layout
        GERAETE_ID NOT IN
        \end_layout
            \begin_layout Plain Layout
        (SELECT GERAETE_ID FROM GEO_TERMINE WHERE AKTUELL='1' && (DATUM>=DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -(INTERVAL_M-$monate_plus_int) MONTH),'%Y-%m-%d') AND DATUM <= DATE_FORMAT(NOW(),'%Y-%m-%d')) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        (SELECT GERAETE_ID FROM GEO_TERMINE WHERE AKTUELL='1' && (DATUM>=DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -(INTERVAL_M-$monate_plus_int) MONTH),'%Y-%m-%d') AND DATUM <= DATE_FORMAT(NOW(),'%Y-%m-%d')) )
        \end_layout
            \begin_layout Plain Layout
        AND
        \end_layout
            \begin_layout Plain Layout
        GERAETE_ID NOT IN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        (SELECT GERAETE_ID FROM GEO_TERMINE WHERE AKTUELL='1' && DATUM>DATE_FORMAT(NOW(),'%Y-%m-%d') GROUP BY GERAETE_ID) ORDER BY EINBAUORT ASC, L_WART ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
GEWERKE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `GEWERKE` (

\end_layout
\begin_layout Plain Layout

  `G_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `G_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`G_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `G_ID` (`G_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `BEZEICHNUNG` (`BEZEICHNUNG`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
G_DAT 
\end_layout
\begin_layout Description
G_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60) AS STD, SUM(STUNDENSATZ *DAUER_MIN  /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60 ) AS STD, SUM( BENUTZER.STUNDENSATZ * DAUER_MIN /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT G_ID, BEZEICHNUNG FROM GEWERKE WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GEWERKE WHERE AKTUELL = '1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
HAUS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `HAUS` (

\end_layout
\begin_layout Plain Layout

  `HAUS_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `HAUS_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_STRASSE` varchar(200) CHARACTER SET utf8 NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_NUMMER` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_STADT` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_PLZ` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_QM` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HAUS_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  UNIQUE KEY `HAUS_DAT` (`HAUS_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `HAUS_ID` (`HAUS_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `OBJEKT_ID` (`OBJEKT_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `HAUS_STRASSE` (`HAUS_STRASSE`),

\end_layout
\begin_layout Plain Layout

  KEY `HAUS_NUMMER` (`HAUS_NUMMER`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=199 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
HAUS_DAT 
\end_layout
\begin_layout Description
HAUS_ID 
\end_layout
\begin_layout Description
HAUS_STRASSE 
\end_layout
\begin_layout Description
HAUS_NUMMER 
\end_layout
\begin_layout Description
HAUS_STADT 
\end_layout
\begin_layout Description
HAUS_PLZ 
\end_layout
\begin_layout Description
HAUS_QM 
\end_layout
\begin_layout Description
HAUS_AKTUELL 
\end_layout
\begin_layout Description
OBJEKT_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, OBJEKT_ID FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS.OBJEKT_ID AS OBJEKT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM  `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE HAUS_AKTUELL='1' && HAUS_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (! isset ( $_REQUEST [einheit_update] )) {
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( haus_in_db, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        $objekt_kurzname = objekt_kurzname ( $_POST ["objekt_id"] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (isset ( $_REQUEST [einheit_update] )) {
        \end_layout
            \begin_layout Plain Layout
        $haus_dat = $_POST [haus_dat];
        \end_layout
            \begin_layout Plain Layout
        deaktiviere_haus_dat ( $haus_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        erstelle_submit_button ( "einheit_update", "Speichern" ); // name, wert
        \end_layout
            \begin_layout Plain Layout
        ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        // neue_einheit_in_db($_POST[haus_id], $_POST[einheit_kurzname], $_POST[einheit_lage], $_POST[einheit_qm], $_POST[einheit_ausstattung]);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM EINHEIT WHERE EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    miete_definieren.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] ['HAUS_ID'] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchungsmaske.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] [HAUS_ID] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchungsmaske.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$hh_id' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 42, 743, 6, "BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<hr>SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(HAUS_QM) AS SUMME FROM HAUS WHERE OBJEKT_ID='$objekt_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(HAUS_QM) AS SUMME FROM HAUS WHERE OBJEKT_ID='$objekt_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $e->einheit_update ( $_REQUEST ['dat'], $_REQUEST ['einheit_id'], $_REQUEST ['kurzname'], $_REQUEST ['lage'], $_REQUEST ['qm'], $_REQUEST ['haus_id'], $_REQUEST ['typ'] );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Einheit aktualisiert" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY LENGTH(EINHEIT_KURZNAME), EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1')  ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM, HAUS_ID, TYP FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1')  ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_DAT, EINHEIT_LAGE, HAUS_ID, EINHEIT_KURZNAME, EINHEIT_AUSSTATTUNG FROM EINHEIT where HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 86, 743, 6, "BERLUS HAUSVERWALTUNG  * Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim * Telefon: 89784477 * Fax: 89784479 * Email: info@berlus.de" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 86, 743, 6, "BERLUS HAUSVERWALTUNG * Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim * Telefon: 89784477 * Fax: 89784479 * Email: info@berlus.de" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 86, 743, 6, "BERLUS HAUSVERWALTUNG * Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim * Telefon: 89784477 * Fax: 89784479 * Email: info@berlus.de" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 86, 743, 6, "BERLUS HAUSVERWALTUNG * Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim * Telefon: 89784477 * Fax: 89784479 * Email: info@berlus.de" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG �  Fontanestr. 1 � 14193 Berlin � Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin � BLZ: 100  800  00 � Konto-Nr.: 05 804 000 00 � Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_QM FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $title = "Alle Häuser";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_QM FROM HAUS where OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, 0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $objekt_kurzname = objekt_namen_by_id ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        $title = "Häuser vom Objekt:  $objekt_kurzname";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS SUMME FROM EINHEIT where HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonten_blatt.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->ezText ( "BERLUS HAUSVERWALTUNG * Fontanestr. 1 * 14193 Berlin", 7 );
        \end_layout
            \begin_layout Plain Layout
        $pdf->ezSetDy ( - 20 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM EINHEIT where EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS where HAUS_ID='$haus_id' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_STRASSE, $HAUS_NUMMER ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile1\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td>$mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        $einheit_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile2\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td> $mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $counter = 0;
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS where OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $haus_ids = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT where HAUS_ID='" . $haus_ids [$i] [HAUS_ID] . "' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT FROM HAUS WHERE HAUS_ID='$haus_id' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"haus_objekt\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT, $OBJEKT_ID, $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\">$OBJEKT_KURZNAME</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr><td>Detailzugehörigkeit:</td><td> <select name=\"bereich_kategorie\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"OBJEKT\">OBJEKT</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"HAUS\">HAUS</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"haeuser\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_DAT, $HAUS_ID, $HAUS_STRASSE, $HAUS_NUMMER ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        // echo "$HAUS_DAT, $HAUS_ID, $HAUS_STRASSE, $HAUS_NUMMER<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        erstelle_submit_button ( "haus_auswahl", "Senden" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT (EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_AKTUELL, EINHEIT_KURZNAME) VALUES (NULL,'$einheit_id','$einheit_qm', '$einheit_lage', '$haus_id', '1', '$einheit_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_einheit_dat_of_einheit_id ( $einheit_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' ORDER BY EINHEIT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_ID='$einheit_id' && EINHEIT_AKTUELL='1' ORDER BY EINHEIT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_DAT, $EINHEIT_ID, $EINHEIT_QM, $EINHEIT_LAGE, $HAUS_ID, $EINHEIT_KURZNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT (EINHEIT_DAT, EINHEIT_ID, EINHEIT_QM, EINHEIT_LAGE, HAUS_ID, EINHEIT_AKTUELL, EINHEIT_KURZNAME) VALUES (NULL,'$einheit_id','$einheit_qm', '$einheit_lage', '$haus_id', '1', '$einheit_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $akt_einheit_dat = letzte_einheit_dat ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS ORDER BY HAUS_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS (HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, HAUS_AKTUELL, OBJEKT_ID) VALUES (NULL,'$haus_id','$strasse', '$nummer', '$stadt', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS (HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, HAUS_AKTUELL, OBJEKT_ID) VALUES (NULL, '$haus_id', '$strasse', '$nummer', '$stadt', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT FROM HAUS WHERE HAUS_STRASSE='$strasse' && HAUS_NUMMER='$nummer' && HAUS_STADT='$stadt' && HAUS_PLZ='$plz' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT FROM HAUS WHERE HAUS_STRASSE='$strasse' && HAUS_NUMMER='$nummer' && HAUS_STADT='$stadt' && HAUS_PLZ='$plz' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"haeuser\" size=\"1\">";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_DAT, $HAUS_ID, $HAUS_STRASSE, $HAUS_NUMMER ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        // echo "$HAUS_DAT, $HAUS_ID, $HAUS_STRASSE, $HAUS_NUMMER<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        erstelle_submit_button ( "haus_auswahl", "Senden" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE HAUS SET HAUS_AKTUELL='0' WHERE HAUS_DAT='$haus_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, EINHEIT.TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE OBJEKT.OBJEKT_ID='$objekt_id' && `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_STRASSE FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' GROUP BY HAUS_STRASSE" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_haeuser = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" size=1 id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $haus_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $hh = new haus ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER DESC LIMIT $this->start,$this->zeilen_pro_seite;" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC;" );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_haeuser = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->seiten_anzahl = ceil ( $this->anzahl_haeuser / $this->zeilen_pro_seite );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1'  && EINHEIT.TYP = 'Gewerbe' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_STADT, TYP FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY HAUS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // print_r($row);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS VALUES(NULL, '$last_id', '$strasse', '$haus_nr','$ort', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'HAUS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE HAUS SET HAUS_AKTUELL='0' WHERE HAUS_ID='$haus_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS VALUES(NULL, '$haus_id', '$strasse', '$haus_nr','$ort', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'HAUS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` WHERE `HAUS_ID` = '$haus_id' AND `EINHEIT_AKTUELL` ='1' && TYP='Gewerbe'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` WHERE `HAUS_ID` = '$haus_id' AND `EINHEIT_AKTUELL` ='1' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" size=1 id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $haus_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $hh = new haus ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=1 id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $haus_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $hh = new haus ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function liste_aller_einheiten_im_haus($haus_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='$haus_id' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && HAUS_STRASSE='$haus_strasse' && HAUS_NUMMER='$haus_nr' ORDER BY HAUS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID, EINHEIT_KURZNAME FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID='$einheit_id' ORDER BY EINHEIT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // print_r($row);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function einheit_update($einheit_dat, $einheit_id, $kurzname, $lage, $qm, $haus_id, $typ) {
        \end_layout
            \begin_layout Plain Layout
        $this->einheit_deaktivieren ( $einheit_dat );
        \end_layout
            \begin_layout Plain Layout
        $last_id = $einheit_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE PARTNER_NAME = '$clean_arr[partnername]' && STRASSE='$clean_arr[strasse]' && NUMMER='$clean_arr[hausnummer]' && PLZ='$clean_arr[plz]' && AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"kosten_traeger_typ\" size=1>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Objekt\">Objekt</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Haus\">Haus</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        // $pdf->addText(42,743,6,"BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin");
        \end_layout
            \begin_layout Plain Layout
        // $pdf->line(42,750,550,750);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 42, 743, 6, "BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 42, 743, 6, "BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT.*, HAUS.* FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ORDER BY LENGTH(EINHEIT.EINHEIT_KURZNAME) ASC, EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && EINHEIT.TYP='$typ' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && EINHEIT.TYP='Gewerbe' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<SELECT SIZE=\"10\" NAME=\"IMPORT_AUS\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anzahl; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $haus_n = $h_array [$a] [HAUS_STRASSE] . $h_array [$a] [HAUS_NUMMER];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT JOIN HAUS ON(HAUS.HAUS_ID=EINHEIT.HAUS_ID) JOIN OBJEKT ON(HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE HAUS_AKTUELL='1' && HAUS_ID = '$id' order by HAUS_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $HAUS_STRASSE, $HAUS_NUMMER ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON, MIETVERTRAG_BIS, MIETVERTRAG_DAT, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, OBJEKT.OBJEKT_ID, OBJEKT_KURZNAME, HAUS.HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ,HAUS_STADT FROM MIETVERTRAG RIGHT JOIN(EINHEIT,HAUS,OBJEKT) ON (MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID && EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_AKTUELL='1' &&  HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id'  ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && HAUS_ID='" . $liste_haeuser [$i] ['HAUS_ID'] . "' ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETVERTRAG` WHERE (MIETVERTRAG_VON<='$datum_bis' && (MIETVERTRAG_BIS='0000-00-00' OR (MIETVERTRAG_BIS >= '$datum_von'))) && `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG.EINHEIT_ID IN (SELECT EINHEIT_ID FROM EINHEIT, HAUS, OBJEKT WHERE EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID='$objekt_id' && EINHEIT.EINHEIT_AKTUELL='1') ORDER BY EINHEIT_ID, MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && HAUS_STRASSE='$haus_str' && HAUS_NUMMER='$haus_nr' && HAUS_PLZ='$haus_plz'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_schluessel = $row [QM];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 42, 743, 6, "BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, OBJEKT_ID FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$h->haus_strasse $h->haus_nummer - $h->objekt_name</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$h->haus_strasse $h->haus_nummer - $h->objekt_name</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz_gk = count ( $gk_arr_objekt );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 42, 743, 6, "BERLUS HAUSVERWALTUNG - Fontanestr. 1 - 14193 Berlin" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME,  EINHEIT_QM,  EINHEIT.HAUS_ID,  CONCAT(HAUS_STRASSE, HAUS_NUMMER) AS HAUS_STRASSE,  EINHEIT_QM, TRIM(EINHEIT_LAGE) AS EINHEIT_LAGE, EINHEIT.TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM EINHEIT WHERE TYP LIKE '%eigentum%' && EINHEIT_AKTUELL='1' GROUP BY HAUS_ID" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<p>Das Schreiben geht an $this->haus_strasse $this->haus_nummer</p>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 86, 743, 6, "BERLUS HAUSVERWALTUNG * Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim * Telefon: 89784477 * Fax: 89784479 * Email: info@berlus.de" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->line ( 42, 750, 550, 750 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $berlus_schrift );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 170, 42, 6, "BERLUS HAUSVERWALTUNG *  Fontanestr. 1 * 14193 Berlin * Inhaber Wolfgang Wehrheim" );
        \end_layout
            \begin_layout Plain Layout
        $pdf->addText ( 150, 35, 6, "Bankverbindung: Dresdner Bank Berlin * BLZ: 100  800  00 * Konto-Nr.: 05 804 000 00 * Steuernummer: 24/582/61188" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_wohnlage($objekt_id) {
        \end_layout
            \begin_layout Plain Layout
        $o = new objekt ();
        \end_layout
            \begin_layout Plain Layout
        $haus_arr = $o->haeuser_objekt_in_arr ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE PARTNER_NAME = '$clean_arr[partnername]' && STRASSE='$clean_arr[strasse]' && NUMMER='$clean_arr[hausnummer]' && PLZ='$clean_arr[plz]' && AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES(NULL, '$partner_id', '$partnername', '$strasse', '$hausnummer', '$plz', '$ort', '$land', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG  LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'  && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID) LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'   ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KASSEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KASSEN` (

\end_layout
\begin_layout Plain Layout

  `KASSEN_DAT` int(4) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KASSEN_ID` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KASSEN_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KASSEN_VERWALTER` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KASSEN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KASSEN_DAT 
\end_layout
\begin_layout Description
KASSEN_ID 
\end_layout
\begin_layout Description
KASSEN_NAME 
\end_layout
\begin_layout Description
KASSEN_VERWALTER 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_ID, KASSEN_NAME, KASSEN_VERWALTER FROM `KASSEN` WHERE AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" id=\"$id\">";
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        if (isset ( $_SESSION [kasse] ) && $_SESSION [kasse] == $row [KASSEN_ID]) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$row[KASSEN_ID]\" selected>$row[KASSEN_NAME] - $row[KASSEN_VERWALTER]</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$row[KASSEN_ID]\">$row[KASSEN_NAME] - $row[KASSEN_VERWALTER]</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_NAME, KASSEN_VERWALTER, PARTNER_ID FROM `KASSEN` RIGHT JOIN (KASSEN_PARTNER) ON (KASSEN.KASSEN_ID = KASSEN_PARTNER.KASSEN_ID) WHERE KASSEN.AKTUELL = '1' && KASSEN_PARTNER.AKTUELL = '1' && KASSEN.KASSEN_ID='1' ORDER BY KASSEN_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS EIN_AUSGABEN FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_in_rechnung_gestellt FROM RECHNUNGEN WHERE AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_aus_rechnung_erhalten FROM RECHNUNGEN WHERE AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='1' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_direkt_gezahlt FROM RECHNUNGEN WHERE EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='1' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kassen_ausgaben_offen FROM RECHNUNGEN WHERE EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='0' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_ID FROM `KASSEN` WHERE AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZAHLT_AM, BELEG_NR,  EMPFAENGER_TYP, EMPFAENGER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='1' ORDER BY BEZAHLT_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FAELLIG_AM, BELEG_NR,  EMPFAENGER_TYP, EMPFAENGER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='0' ORDER BY FAELLIG_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZAHLT_AM, BELEG_NR,  AUSSTELLER_TYP, AUSSTELLER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='1' ORDER BY BEZAHLT_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FAELLIG_AM, BELEG_NR,  AUSSTELLER_TYP, AUSSTELLER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='0' ORDER BY FAELLIG_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND EMPFAENGER_TYP='Kasse' AND EMPFAENGER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND EMPFAENGER_TYP='Kasse' AND EMPFAENGER_ID='$kassen_id' ORDER BY BELEG_NR DESC " . $navi->limit . "" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND AUSSTELLER_TYP='Kasse' AND AUSSTELLER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND AUSSTELLER_TYP='Kasse' AND AUSSTELLER_ID='$kassen_id' ORDER BY BELEG_NR DESC " . $navi->limit . "" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_BUCH_DAT='$buchungs_dat' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->akt_kassenbuch_dat = $row [KASSEN_BUCH_DAT];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function speichern_in_kassenbuch($kassen_id, $betrag, $datum, $zahlungstyp, $beleg_text, $kostentraeger_typ, $kostentraeger_bez) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag1', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag1', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KASSEN_BUCH SET AKTUELL='0' WHERE KASSEN_BUCH_DAT='$buchungs_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KASSEN_BUCH', $buchungs_dat, $buchungs_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_BUCH_ID FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && AKTUELL='1' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [KASSEN_BUCH_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') < '$jahr-$monat' && DATE_FORMAT(DATUM, '%Y') = '$jahr'  ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATUM <='$vorjahr-12-31'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATUM <='$vorjahr-12-31'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') < '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATE_FORMAT(DATUM, '%y-%m') < '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_ID, KASSEN_NAME, KASSEN_VERWALTER FROM `KASSEN` WHERE AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<p class=\"objekt_auswahl\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KASSEN_BUCH
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KASSEN_BUCH` (

\end_layout
\begin_layout Plain Layout

  `KASSEN_BUCH_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KASSEN_BUCH_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KASSEN_ID` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZAHLUNGSTYP` enum('Einnahmen','Ausgaben') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BELEG_TEXT` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(30) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(6) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KASSEN_BUCH_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=303 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KASSEN_BUCH_DAT 
\end_layout
\begin_layout Description
KASSEN_BUCH_ID 
\end_layout
\begin_layout Description
KASSEN_ID 
\end_layout
\begin_layout Description
ZAHLUNGSTYP 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
BELEG_TEXT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS EIN_AUSGABEN FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_BUCH_DAT='$buchungs_dat' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->akt_kassenbuch_dat = $row [KASSEN_BUCH_DAT];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag1', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag1', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KASSEN_BUCH SET AKTUELL='0' WHERE KASSEN_BUCH_DAT='$buchungs_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KASSEN_BUCH', $buchungs_dat, $buchungs_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KASSEN_BUCH VALUES (NULL, '$letzte_kb_id','$kassen_id', '$zahlungstyp','$betrag', '$datum', '$beleg_text', '1', '$kostentraeger_typ', '$kostentraeger_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Betrag von $betrag € wurde ins Kassenbuch eingetragen!<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_BUCH_ID FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && AKTUELL='1' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [KASSEN_BUCH_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') < '$jahr-$monat' && DATE_FORMAT(DATUM, '%Y') = '$jahr'  ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KASSEN_BUCH WHERE KASSEN_ID = '$kassen_id' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY DATUM, KASSEN_BUCH_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' ORDER BY KASSEN_BUCH_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATUM <='$vorjahr-12-31'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATUM <='$vorjahr-12-31'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Ausgaben' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m') < '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM KASSEN_BUCH WHERE KASSEN_ID='$kassen_id' && ZAHLUNGSTYP='Einnahmen' && AKTUELL='1' && DATE_FORMAT(DATUM, '%y-%m') < '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BETRAG];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KASSEN_PARTNER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KASSEN_PARTNER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KASSEN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
KASSEN_ID 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_NAME, KASSEN_VERWALTER, PARTNER_ID FROM `KASSEN` RIGHT JOIN (KASSEN_PARTNER) ON (KASSEN.KASSEN_ID = KASSEN_PARTNER.KASSEN_ID) WHERE KASSEN.AKTUELL = '1' && KASSEN_PARTNER.AKTUELL = '1' && KASSEN.KASSEN_ID='1' ORDER BY KASSEN_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KAUTION_DATEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KAUTION_DATEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `MV_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FELD` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WERT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=191 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
MV_ID 
\end_layout
\begin_layout Description
FELD 
\end_layout
\begin_layout Description
WERT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KAUTION_DATEN SET AKTUELL='0' WHERE MV_ID='$mv_id' && FELD='$feld'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KAUTION_DATEN VALUES (NULL, '$mv_id', '$feld', '$wert', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_DATEN', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `KAUTION_DATEN` WHERE  `MV_ID` = '$mv_id' AND  `FELD` ='$feld' AND  `AKTUELL` =  '1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KAUTION_FELD
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KAUTION_FELD` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `FELD` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=17 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
FELD 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `KAUTION_FELD` WHERE AKTUELL='1' ORDER BY DAT ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KAUTION_FELD VALUES (NULL, '$feld',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_FELD', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KAUTION_FELD SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_FELD', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTENRAHMEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTENRAHMEN` (

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTENRAHMEN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=27 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTENRAHMEN_DAT 
\end_layout
\begin_layout Description
KONTENRAHMEN_ID 
\end_layout
\begin_layout Description
NAME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTENRAHMEN_KONTOARTEN.KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && AKTUELL='1' && WEITER_VERWENDEN='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' && WEITER_VERWENDEN='1' && AKTUELL='1' ORDER BY BELEG_NR DESC, POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto', '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, MENGE, EINZEL_PREIS, GESAMT_SUMME, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_ID, MENGE, EINZEL_PREIS, GESAMT_SUMME, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        unset ( $this->k_kontenrahmen_konto );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$neue_menge', '$einzel_preis', '$gesamt_preis', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$diff_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '1', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto' , '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTENRAHMEN_KONTEN WHERE KONTO='$konto' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->konten_dat = $row ['KONTENRAHMEN_KONTEN_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTENRAHMEN_KONTEN WHERE KONTO='$konto' && KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->konten_dat = $row ['KONTENRAHMEN_KONTEN_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZEICHNUNG FROM KONTENRAHMEN_GRUPPEN WHERE KONTENRAHMEN_GRUPPEN_ID='$gruppen_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_GRUPPEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BEZEICHNUNG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTOART FROM KONTENRAHMEN_KONTOARTEN WHERE KONTENRAHMEN_KONTOART_ID='$kontoart_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTOART_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTOART'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTOART_ID FROM KONTENRAHMEN_KONTOARTEN WHERE KONTOART='$kontoartbez' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTOART_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTENRAHMEN_KONTOART_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_GRUPPEN_ID FROM KONTENRAHMEN_GRUPPEN WHERE BEZEICHNUNG='$gruppenbez' && AKTUELL='1' ORDER BY KONTENRAHMEN_GRUPPEN_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTENRAHMEN_GRUPPEN_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_KONTEN` WHERE `KONTO_ART` ='$kontoart_id' AND `KONTENRAHMEN_ID` ='$k_id' AND `AKTUELL` = '1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_KONTEN` WHERE `KONTO_ART` ='$kontoart_id' && GRUPPE='$gruppen_id' AND `KONTENRAHMEN_ID` ='$k_id' AND `AKTUELL` = '1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_ID FROM `KONTENRAHMEN_ZUWEISUNG` WHERE TYP='$typ' && TYP_ID='$typ_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_ID FROM `KONTENRAHMEN_ZUWEISUNG` WHERE TYP='ALLE' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=\"1\" id=\"kontenrahmen_konto\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $konten_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $konto = $konten_arr [$a] ['KONTO'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$name\" id=\"label_$name\">$label</label><select name=\"$name\" size=\"1\" id=\"$id\"  $js>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $kontenrahmen_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function kontenrahmen_in_arr() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_ID, NAME FROM KONTENRAHMEN WHERE  AKTUELL='1' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GELD_KONTO_BUCHUNGEN.BETRAG) AS GESAMTKOSTEN_MONATLICH FROM GELD_KONTO_BUCHUNGEN WHERE DATUM BETWEEN '$anfangsdatum' AND '$end_datum' && GELD_KONTO_BUCHUNGEN.GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' && KONTENRAHMEN_KONTO!='80001'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['GESAMTKOSTEN_MONATLICH'] . "</br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS MIETEINNAHMEN_MONATLICH FROM GELD_KONTO_BUCHUNGEN WHERE DATUM BETWEEN '$anfangsdatum' AND '$end_datum' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='80001' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS KONTOSTAND_GELDBUCHUNGEN_KONTIERT
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && AKTUELL = '1' && KONTENRAHMEN_KONTO = '$kontenrahmen_konto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS SUMME_MIETEINNAHMEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && KONTENRAHMEN_KONTO='80001' &&  AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT sum( BETRAG ) AS SUMME_MIETEINNAHMEN
        \end_layout
            \begin_layout Plain Layout
        FROM `GELD_KONTO_BUCHUNGEN` WHERE GELDKONTO_ID = '$geld_konto_id' && KONTENRAHMEN_KONTO='80001' && AKTUELL = '1' && DATUM BETWEEN '$datum_von' AND '$datum_bis'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_personal.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$gk_id' && `AKTUELL` = '1' && VERWENDUNGSZWECK LIKE '%$benutzername%' && KONTENRAHMEN_KONTO='$konto' ORDER BY G_BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTIERUNG_POSITIONEN` JOIN RECHNUNGEN ON (KONTIERUNG_POSITIONEN.BELEG_NR=RECHNUNGEN.BELEG_NR) WHERE `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND KONTIERUNG_POSITIONEN.AKTUELL = '1' AND RECHNUNGEN.AKTUELL = '1' AND RECHNUNGEN.EMPFAENGER_TYP='PARTNER' && RECHNUNGEN.EMPFAENGER_ID='$partner_id' && KONTENRAHMEN_KONTO='$kostenkonto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS G_BEZEICHNUNG, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTO_ART FROM `KONTENRAHMEN_GRUPPEN` INNER JOIN (KONTENRAHMEN_KONTEN) ON ( KONTENRAHMEN_GRUPPEN_ID = GRUPPE )
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_GRUPPEN.BEZEICHNUNG = '$gruppenbez' ORDER BY `KONTENRAHMEN_KONTEN`.`KONTO` ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function konten_in_arr_rahmen($kontenrahmen_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' && KONTO NOT IN(SELECT KONTO FROM BK_KONTEN WHERE BK_PROFIL_ID='$this->bk_profil_id')  ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME  FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$geldkonto_id' AND `KONTENRAHMEN_KONTO` = '$kostenkonto' AND DATUM BETWEEN '$von' AND '$bis' AND `AKTUELL` ='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m') BETWEEN '$vorjahr-12' AND '$nachjahr-03' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $von = date_german2mysql ( $_SESSION ['anzeigen_von'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` ='$geldkonto_id' AND `KONTENRAHMEN_KONTO` ='$kostenkonto' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y-%m-%d') BETWEEN '$von' AND '$bis' AND GELD_KONTO_BUCHUNGEN_ID NOT IN (SELECT BUCHUNG_ID FROM `BK_BERECHNUNG_BUCHUNGEN` WHERE `BK_K_ID` = '$konto_id' GROUP BY BUCHUNG_ID HAVING SUM( ANTEIL ) >= '100' ) " );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN VALUES (NULL, '$last_b_id', '$profil_id', '$profil_bez','$profil_jahr', '$wirt_e', '$wirt_name', '$datum', '$anz_einheiten', '$qm_gesamt', '$qm_wohnraum', '$qm_gewerbe', '$anz_konten', '$anz_abrechnungen', '$ersteller', '$partner_id','$kontenrahmen_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && GELDKONTO_ID='$_SESSION[geldkonto_id]' && KONTENRAHMEN_KONTO='$kostenkonto' && DATUM BETWEEN '$von' AND '$bis' ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo'  && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL,GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $sort = $_REQUEST ['sort'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, MWST_ANTEIL,GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO,KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$mo' && AKTUELL='1' ORDER BY $sort ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y') = '$ja' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, GELD_KONTO_BUCHUNGEN_DAT, GELD_KONTO_BUCHUNGEN_ID, G_BUCHUNGSNUMMER, BETRAG, MWST_ANTEIL,VERWENDUNGSZWECK, KONTO_AUSZUGSNUMMER, ERFASS_NR, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && DATE_FORMAT(DATUM, '%Y-%m') = '$ja-$monat' && AKTUELL='1' ORDER BY G_BUCHUNGSNUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' $str_kos GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTENRAHMEN_KONTO AS KONTO FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && AKTUELL='1' $str_kos GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT date_format(DATUM,'%d.%m.%Y') AS DATUM, G_BUCHUNGSNUMMER, ERFASS_NR, KONTO_AUSZUGSNUMMER, BETRAG, MWST_ANTEIL, RTRIM(LTRIM(VERWENDUNGSZWECK)) AS VERWENDUNGSZWECK, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        // die("JAHR: $jahr");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT date_format(DATUM,'%d.%m.%Y') AS DATUM, G_BUCHUNGSNUMMER, ERFASS_NR, KONTO_AUSZUGSNUMMER, BETRAG, MWST_ANTEIL,RTRIM(LTRIM(VERWENDUNGSZWECK)) AS VERWENDUNGSZWECK, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $this->summe_konto_buchungen = 0.00;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO != '$mieteinnahmen_kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && ( DATE_FORMAT( DATUM, '%Y-%m' ) <= CURDATE()) && AKTUELL='1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO != '$mieteinnahmen_kostenkonto' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-$monat-$ltag' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$mieteinnahmen_kostenkonto' && DATUM BETWEEN '$jahr-01-01' AND '$jahr-$monat-$ltag' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE  KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' ORDER BY GELDKONTO_ID, BETRAG, DATUM, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO = '$kostenkonto' && DATUM BETWEEN '$anfangsdatum' AND '$enddatum' && AKTUELL='1' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, VERWENDUNGSZWECK FROM GELD_KONTO_BUCHUNGEN  WHERE  DATUM<='$datum_bis' && AKTUELL='1' && GELDKONTO_ID='$gk_id' && KONTENRAHMEN_KONTO!='2002' && KONTENRAHMEN_KONTO!='2003' && KONTENRAHMEN_KONTO!='2004' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1'  ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATUM BETWEEN '$von' and '$bis' AND `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM $sort";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' ORDER BY KONTENRAHMEN_KONTO, DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y' ) = '$jahr'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(BETRAG) AS SUMME FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND  `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND `AKTUELL` = '1' && KONTENRAHMEN_KONTO='$konto' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage."<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE KONTO_AUSZUGSNUMMER = '$kontoauszugsnr' && KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' && DATUM= '$buchungsdatum' && BETRAG= '$betrag' && VERWENDUNGSZWECK= '$v_zweck' && AKTUELL= '1' && GELDKONTO_ID= '$geld_konto_id' && KONTENRAHMEN_KONTO='$kontenrahmen_konto'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' &&  KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='80001' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $my_arr = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_ZAHLBETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='$kostenkonto' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m')<='$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM KONTENRAHMEN WHERE  AKTUELL='1' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_ZUWEISUNG` WHERE `KONTENRAHMEN_ID` ='$kontenrahmen_id' AND `AKTUELL`='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTEN_DAT, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, GRUPPE AS GRUPPEN_ID, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTO_ART AS KONTOART_ID, KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN, KONTENRAHMEN_GRUPPEN, KONTENRAHMEN_KONTOARTEN
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_ID = '$kontenrahmen_id' && KONTENRAHMEN_GRUPPEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.AKTUELL = '1' && KONTENRAHMEN_KONTOARTEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.GRUPPE = KONTENRAHMEN_GRUPPEN.KONTENRAHMEN_GRUPPEN_ID && KONTO_ART = KONTENRAHMEN_KONTOART_ID
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN WHERE AKTUELL = '1' && NAME='$k_bez' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN VALUES (NULL, '$k_id', '$k_bez', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1'  ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $my_array ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $id = $my_array [$a] [KONTENRAHMEN_GRUPPEN_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1'  ORDER BY KONTOART ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $my_array ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $kid = $my_array [$a] [KONTENRAHMEN_KONTOART_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM KONTENRAHMEN WHERE  AKTUELL='1' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $my_array ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $id = $my_array [$a] [KONTENRAHMEN_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTEN WHERE AKTUELL = '1' && KONTO='$konto' && KONTENRAHMEN_ID='$kontenrahmen_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN WHERE AKTUELL = '1' && KONTENRAHMEN_ID='$kontenrahmen_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        unset ( $this->dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTEN WHERE AKTUELL = '1' && KONTENRAHMEN_KONTEN_DAT='$dat' ORDER BY KONTENRAHMEN_KONTEN_DAT 	LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTENRAHMEN_KONTEN SET AKTUELL='0' WHERE KONTENRAHMEN_KONTEN_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1'  ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1' && BEZEICHNUNG='$g_bez'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_GRUPPEN VALUES (NULL, '$g_id', '$g_bez',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_GRUPPEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1'  ORDER BY KONTOART ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1' && KONTOART='$kontoart'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTOARTEN VALUES (NULL, '$k_id', '$kontoart',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTOARTEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTENRAHMEN_ID='$kontenrahmen_id' && TYP='$kos_typ' && TYP_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_ZUWEISUNG VALUES (NULL, '$id', '$kos_typ','$kos_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_ZUWEISUNG', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTENRAHMEN_ZUWEISUNG SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$buchungskonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$buchungskonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(DATUM, '%d.%m.%Y') AS DATUM_D FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$kostenkonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && KONTENRAHMEN_KONTO='$kostenkonto' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y-%m') = '$jahr-$monat' && KOSTENTRAEGER_TYP LIKE '$kos_typ' && KOSTENTRAEGER_ID='$kos_id' && AKTUELL='1' && GELDKONTO_ID='$geldkonto_id' && `KONTENRAHMEN_KONTO` = '$kostenkonto' GROUP BY KOSTENTRAEGER_ID ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO FROM GELD_KONTO_BUCHUNGEN WHERE  AKTUELL='1' && GELDKONTO_ID='$geld_konto_id' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        echo "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTO, SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE DATE_FORMAT(DATUM, '%Y') = '$jahr'  && AKTUELL='1' && GELDKONTO_ID='$gk_id' GROUP BY KONTENRAHMEN_KONTO ORDER BY KONTENRAHMEN_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  DATE_FORMAT(`DATUM`, '%d.%m.%Y') AS DATUMD, DATUM ,  `KONTENRAHMEN_KONTO` ,  `BETRAG` ,  `VERWENDUNGSZWECK`
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `GELDKONTO_ID` ='$gk_id' &&  `KOSTENTRAEGER_TYP` =  'Eigentuemer' &&  `KOSTENTRAEGER_ID` =  '$et_id' && DATE_FORMAT(  `DATUM` ,  '%Y' ) =  '$jahr' && AKTUELL='1' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  DATE_FORMAT(`DATUM`, '%d.%m.%Y') AS DATUMD, DATUM ,  `KONTENRAHMEN_KONTO` ,  `BETRAG` ,  `VERWENDUNGSZWECK`
        \end_layout
            \begin_layout Plain Layout
        FROM  `GELD_KONTO_BUCHUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `GELDKONTO_ID` ='$gk_id' &&  `KOSTENTRAEGER_TYP` =  'Eigentuemer' &&  `KOSTENTRAEGER_ID` =  '$et_id' && DATE_FORMAT(  `DATUM` ,  '%Y' ) =  '$jahr' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTO, DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, KONTENRAHMEN_KONTO, `KOSTENTRAEGER_TYP`, `KOSTENTRAEGER_ID` FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // $pdf = new Cezpdf('a4', 'portrait');
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, KONTENRAHMEN_KONTO, `KOSTENTRAEGER_TYP`, `KOSTENTRAEGER_ID` FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && ( DATE_FORMAT( DATUM, '%Y' ) = '$jahr') && AKTUELL='1' GROUP BY KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTENRAHMEN_GRUPPEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTENRAHMEN_GRUPPEN` (

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_GRUPPEN_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_GRUPPEN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTENRAHMEN_GRUPPEN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=29 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTENRAHMEN_GRUPPEN_DAT 
\end_layout
\begin_layout Description
KONTENRAHMEN_GRUPPEN_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTENRAHMEN_KONTOARTEN.KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZEICHNUNG FROM KONTENRAHMEN_GRUPPEN WHERE KONTENRAHMEN_GRUPPEN_ID='$gruppen_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_GRUPPEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BEZEICHNUNG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_GRUPPEN_ID FROM KONTENRAHMEN_GRUPPEN WHERE BEZEICHNUNG='$gruppenbez' && AKTUELL='1' ORDER BY KONTENRAHMEN_GRUPPEN_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTENRAHMEN_GRUPPEN_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS G_BEZEICHNUNG, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTO_ART FROM `KONTENRAHMEN_GRUPPEN` INNER JOIN (KONTENRAHMEN_KONTEN) ON ( KONTENRAHMEN_GRUPPEN_ID = GRUPPE )
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_GRUPPEN.BEZEICHNUNG = '$gruppenbez' ORDER BY `KONTENRAHMEN_KONTEN`.`KONTO` ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTEN_DAT, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, GRUPPE AS GRUPPEN_ID, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTO_ART AS KONTOART_ID, KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN, KONTENRAHMEN_GRUPPEN, KONTENRAHMEN_KONTOARTEN
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_ID = '$kontenrahmen_id' && KONTENRAHMEN_GRUPPEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.AKTUELL = '1' && KONTENRAHMEN_KONTOARTEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.GRUPPE = KONTENRAHMEN_GRUPPEN.KONTENRAHMEN_GRUPPEN_ID && KONTO_ART = KONTENRAHMEN_KONTOART_ID
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1'  ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $my_array ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $id = $my_array [$a] [KONTENRAHMEN_GRUPPEN_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1'  ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_GRUPPEN WHERE AKTUELL = '1' && BEZEICHNUNG='$g_bez'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_GRUPPEN VALUES (NULL, '$g_id', '$g_bez',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_GRUPPEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTENRAHMEN_KONTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTENRAHMEN_KONTEN` (

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTEN_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTEN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUPPE` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO_ART` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTENRAHMEN_KONTEN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1107 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTENRAHMEN_KONTEN_DAT 
\end_layout
\begin_layout Description
KONTENRAHMEN_KONTEN_ID 
\end_layout
\begin_layout Description
KONTO 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
GRUPPE 
\end_layout
\begin_layout Description
KONTO_ART 
\end_layout
\begin_layout Description
KONTENRAHMEN_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTENRAHMEN_KONTOARTEN.KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTENRAHMEN_KONTEN WHERE KONTO='$konto' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->konten_dat = $row ['KONTENRAHMEN_KONTEN_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTENRAHMEN_KONTEN WHERE KONTO='$konto' && KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTEN_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->konten_dat = $row ['KONTENRAHMEN_KONTEN_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_KONTEN` WHERE `KONTO_ART` ='$kontoart_id' AND `KONTENRAHMEN_ID` ='$k_id' AND `AKTUELL` = '1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_KONTEN` WHERE `KONTO_ART` ='$kontoart_id' && GRUPPE='$gruppen_id' AND `KONTENRAHMEN_ID` ='$k_id' AND `AKTUELL` = '1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS G_BEZEICHNUNG, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTO_ART FROM `KONTENRAHMEN_GRUPPEN` INNER JOIN (KONTENRAHMEN_KONTEN) ON ( KONTENRAHMEN_GRUPPEN_ID = GRUPPE )
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_GRUPPEN.BEZEICHNUNG = '$gruppenbez' ORDER BY `KONTENRAHMEN_KONTEN`.`KONTO` ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, BEZEICHNUNG FROM KONTENRAHMEN_KONTEN WHERE KONTENRAHMEN_ID='$kontenrahmen_id' && AKTUELL='1' && KONTO NOT IN(SELECT KONTO FROM BK_KONTEN WHERE BK_PROFIL_ID='$this->bk_profil_id')  ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTEN_DAT, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, GRUPPE AS GRUPPEN_ID, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTO_ART AS KONTOART_ID, KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN, KONTENRAHMEN_GRUPPEN, KONTENRAHMEN_KONTOARTEN
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_ID = '$kontenrahmen_id' && KONTENRAHMEN_GRUPPEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.AKTUELL = '1' && KONTENRAHMEN_KONTOARTEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.GRUPPE = KONTENRAHMEN_GRUPPEN.KONTENRAHMEN_GRUPPEN_ID && KONTO_ART = KONTENRAHMEN_KONTOART_ID
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTEN WHERE AKTUELL = '1' && KONTO='$konto' && KONTENRAHMEN_ID='$kontenrahmen_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTEN WHERE AKTUELL = '1' && KONTENRAHMEN_KONTEN_DAT='$dat' ORDER BY KONTENRAHMEN_KONTEN_DAT 	LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTENRAHMEN_KONTEN SET AKTUELL='0' WHERE KONTENRAHMEN_KONTEN_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTENRAHMEN_KONTOARTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTENRAHMEN_KONTOARTEN` (

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTOART_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTOART_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTOART` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTENRAHMEN_KONTOART_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTENRAHMEN_KONTOART_DAT 
\end_layout
\begin_layout Description
KONTENRAHMEN_KONTOART_ID 
\end_layout
\begin_layout Description
KONTOART 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KONTENRAHMEN_KONTEN.BEZEICHNUNG, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTENRAHMEN_KONTOARTEN.KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTOART FROM KONTENRAHMEN_KONTOARTEN WHERE KONTENRAHMEN_KONTOART_ID='$kontoart_id' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTOART_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTOART'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTOART_ID FROM KONTENRAHMEN_KONTOARTEN WHERE KONTOART='$kontoartbez' && AKTUELL='1' ORDER BY KONTENRAHMEN_KONTOART_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTENRAHMEN_KONTOART_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_KONTEN_DAT, KONTO, KONTENRAHMEN_KONTEN.BEZEICHNUNG, GRUPPE AS GRUPPEN_ID, KONTENRAHMEN_GRUPPEN.BEZEICHNUNG AS GRUPPE, KONTO_ART AS KONTOART_ID, KONTOART
        \end_layout
            \begin_layout Plain Layout
        FROM KONTENRAHMEN_KONTEN, KONTENRAHMEN_GRUPPEN, KONTENRAHMEN_KONTOARTEN
        \end_layout
            \begin_layout Plain Layout
        WHERE KONTENRAHMEN_ID = '$kontenrahmen_id' && KONTENRAHMEN_GRUPPEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.AKTUELL = '1' && KONTENRAHMEN_KONTOARTEN.AKTUELL = '1' && KONTENRAHMEN_KONTEN.GRUPPE = KONTENRAHMEN_GRUPPEN.KONTENRAHMEN_GRUPPEN_ID && KONTO_ART = KONTENRAHMEN_KONTOART_ID
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1'  ORDER BY KONTOART ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1'  ORDER BY KONTOART ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM KONTENRAHMEN_KONTOARTEN WHERE AKTUELL = '1' && KONTOART='$kontoart'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTOARTEN VALUES (NULL, '$k_id', '$kontoart',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTOARTEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTENRAHMEN_ZUWEISUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTENRAHMEN_ZUWEISUNG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TYP_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=171 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
TYP 
\end_layout
\begin_layout Description
TYP_ID 
\end_layout
\begin_layout Description
KONTENRAHMEN_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_ID FROM `KONTENRAHMEN_ZUWEISUNG` WHERE TYP='$typ' && TYP_ID='$typ_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTENRAHMEN_ID FROM `KONTENRAHMEN_ZUWEISUNG` WHERE TYP='ALLE' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTENRAHMEN_ZUWEISUNG` WHERE `KONTENRAHMEN_ID` ='$kontenrahmen_id' AND `AKTUELL`='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  KONTENRAHMEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTENRAHMEN_ID='$kontenrahmen_id' && TYP='$kos_typ' && TYP_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_ZUWEISUNG VALUES (NULL, '$id', '$kos_typ','$kos_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_ZUWEISUNG', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTENRAHMEN_ZUWEISUNG SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KONTIERUNG_POSITIONEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KONTIERUNG_POSITIONEN` (

\end_layout
\begin_layout Plain Layout

  `KONTIERUNG_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KONTIERUNG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POSITION` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MENGE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINZEL_PREIS` decimal(10,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GESAMT_SUMME` decimal(10,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_SATZ` int(2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SKONTO` decimal(3,2) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `RABATT_SATZ` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTO` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTIERUNGS_DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VERWENDUNGS_JAHR` decimal(4,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WEITER_VERWENDEN` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KONTIERUNG_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=162659 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KONTIERUNG_DAT 
\end_layout
\begin_layout Description
KONTIERUNG_ID 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
POSITION 
\end_layout
\begin_layout Description
MENGE 
\end_layout
\begin_layout Description
EINZEL_PREIS 
\end_layout
\begin_layout Description
GESAMT_SUMME 
\end_layout
\begin_layout Description
MWST_SATZ 
\end_layout
\begin_layout Description
SKONTO 
\end_layout
\begin_layout Description
RABATT_SATZ 
\end_layout
\begin_layout Description
KONTENRAHMEN_KONTO 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
KONTIERUNGS_DATUM 
\end_layout
\begin_layout Description
VERWENDUNGS_JAHR 
\end_layout
\begin_layout Description
WEITER_VERWENDEN 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$letzte_belegnr', '1','1', '$netto_betrag', '$netto_betrag', '19', '0', '0', '$kostenkonto', '$empf_typ', '$empf_id', '$datum', '$jahr', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$letzte_belegnr', '$pos','$menge', '$netto_betrag', '$g_netto', '19', '0', '0', '$kostenkonto', 'Objekt', '$_SESSION[objekt_id]', '$datum', '$jahr', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE `KONTIERUNG_DAT` ='$dat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT SUM( MENGE ) AS KONTIERTE_MENGE FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$belegnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE  `KONTIERUNG_POSITIONEN` SET AKTUELL='0' WHERE `BELEG_NR` ='$belegnr'" ) or die ( 'Kontierungsaufhebung nicht möglich' );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTIERUNG_POSITIONEN` WHERE KONTIERUNG_ID= '$kontierung_id' && AKTUELL='1' ORDER BY KONTIERUNG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && AKTUELL='1' && WEITER_VERWENDEN='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE KOSTENTRAEGER_TYP = '$kostentraeger_typ' && KOSTENTRAEGER_ID='$kostentraeger_id' && WEITER_VERWENDEN='1' && AKTUELL='1' ORDER BY BELEG_NR DESC, POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto', '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_ID FROM KONTIERUNG_POSITIONEN WHERE  AKTUELL='1' ORDER BY KONTIERUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KONTIERUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POSITION FROM KONTIERUNG_POSITIONEN WHERE  BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY KONTIERUNG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [POSITION];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( MENGE ) AS KONTIERTE_MENGE FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $kontierte_menge = $row ['KONTIERTE_MENGE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID, MENGE, EINZEL_PREIS, GESAMT_SUMME, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_ID, MENGE, EINZEL_PREIS, GESAMT_SUMME, KONTENRAHMEN_KONTO, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        unset ( $this->k_kontenrahmen_konto );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_gsumme_kontierung() {
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $abfrage = "UPDATE KONTIERUNG_POSITIONEN AS t1
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY KONTIERUNG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->kontierungs_menge = $row ['MENGE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && AKTUELL='1' ORDER BY KONTIERUNG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->kontierungs_menge = $row ['MENGE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0', MENGE='$neue_menge' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET AKTUELL='0' WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET AKTUELL='0' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MENGE FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [MENGE];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(MENGE) AS GESAMT_KONTIERT FROM KONTIERUNG_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [GESAMT_KONTIERT];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MENGE FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['MENGE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MENGE FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [MENGE];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $beleg_nr = $row [BELEG_NR];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$neue_menge', '$einzel_preis', '$gesamt_preis', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNG_DAT='$dat' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $beleg_nr = $row [BELEG_NR];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET MENGE='$neue_menge', WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$diff_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '1', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto' , '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && KOSTENTRAEGER_TYP = '$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, POSITION, MENGE FROM  `KONTIERUNG_POSITIONEN`	WHERE  `KOSTENTRAEGER_TYP` LIKE  '$kos_typ'	AND  `KOSTENTRAEGER_ID` ='$kos_id' AND  `AKTUELL` =  '1'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        $beleg_nr = $row ['BELEG_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTIERUNG_DAT, KONTIERUNG_ID FROM KONTIERUNG_POSITIONEN WHERE KONTIERUNGS_DATUM='0000-00-00'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE KONTIERUNG_POSITIONEN SET KONTIERUNGS_DATUM='$datum' WHERE KONTIERUNG_DAT='$dat' && KONTIERUNGS_DATUM='0000-00-00'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( MENGE ) AS KONTIERTE_MENGE FROM `KONTIERUNG_POSITIONEN` WHERE BELEG_NR = '$beleg_nr' && POSITION = '$position' && KONTIERUNGS_DATUM<='$datum' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $kontierte_menge = $row ['KONTIERTE_MENGE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM((`GESAMT_SUMME`/100)*(100-RABATT_SATZ)) AS GESAMT  FROM `KONTIERUNG_POSITIONEN` WHERE `KOSTENTRAEGER_TYP` = '$empf_typ' AND `KOSTENTRAEGER_ID` = '$empf_id' AND `WEITER_VERWENDEN` = '1' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTIERUNG_POSITIONEN` JOIN RECHNUNGEN ON (KONTIERUNG_POSITIONEN.BELEG_NR=RECHNUNGEN.BELEG_NR) WHERE `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND KONTIERUNG_POSITIONEN.AKTUELL = '1' AND RECHNUNGEN.AKTUELL = '1' AND RECHNUNGEN.EMPFAENGER_TYP='PARTNER' && RECHNUNGEN.EMPFAENGER_ID='$partner_id' && KONTENRAHMEN_KONTO='$kostenkonto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET RABATT_SATZ='$u_rabatt', SKONTO='$skonto', GESAMT_SUMME='$k_neu_preis' WHERE POSITION='$_pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "Kontierungsposition $_pos wurde geändert<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='1' WHERE AKTUELL='1' && BELEG_NR='$U_BELEG_NR' && POSITION='$U_POS' && WEITER_VERWENDEN='0'" );
        \end_layout
            \begin_layout Plain Layout
        /* Löschen aus dem Unterpool */
        \end_layout
            \begin_layout Plain Layout
        mysql_query ( "DELETE FROM POS_POOL WHERE PP_DAT='$pp_dat'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT RECHNUNGEN . * , SUM(GESAMT_SUMME/100*(100-RABATT_SATZ)) AS SUMME_G
        \end_layout
            \begin_layout Plain Layout
        FROM `KONTIERUNG_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `KOSTENTRAEGER_TYP` LIKE '$kos_typ'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$letzte_belegnr', '$pos','$k_menge', '$k_preis', '$k_preis_g', '$k_mwst', '$k_skonto', '$k_rabatt', '$k_konto', '$k_kos_typ', '$k_kos_id', '$datum', '$jahr', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } // end for2
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM KONTIERUNG_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY KONTIERUNG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KUNDEN_LOGFILE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KUNDEN_LOGFILE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `USER` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HOST` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AGENT` tinytext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5060 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
USER 
\end_layout
\begin_layout Description
IP 
\end_layout
\begin_layout Description
HOST 
\end_layout
\begin_layout Description
AGENT 
\end_layout
\begin_layout Description
TIME 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
KUNDEN_LOGIN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KUNDEN_LOGIN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `USERNAME` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PASSWORD` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMAIL` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PDF_PARTNER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
USERNAME 
\end_layout
\begin_layout Description
PASSWORD 
\end_layout
\begin_layout Description
EMAIL 
\end_layout
\begin_layout Description
PERSON_ID 
\end_layout
\begin_layout Description
PDF_PARTNER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE ID='$kunden_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE ID='$kunden_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE ID='$kunden_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE PERSON_ID='$person_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `KUNDEN_LOGIN` VALUES (NULL, '$last_id', '$username', '$passwd', '$email', '$person_id', '$partner_id','1');";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KUNDEN_LOGIN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `KUNDEN_LOGIN` SET AKTUELL='0' WHERE ID='$kunden_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
KUNDEN_LOG_BER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `KUNDEN_LOG_BER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZUGRIFF_OBJ` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZUGRIFF_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=55 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
PERSON_ID 
\end_layout
\begin_layout Description
ZUGRIFF_OBJ 
\end_layout
\begin_layout Description
ZUGRIFF_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOG_BER` WHERE PERSON_ID='$person_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `KUNDEN_LOG_BER` SET AKTUELL='0' WHERE PERSON_ID='$person_id' &&  ZUGRIFF_OBJ='$ber_obj' && ZUGRIFF_ID='$ber_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOG_BER` WHERE PERSON_ID='$person_id' && ZUGRIFF_OBJ='$ber_obj' && ZUGRIFF_ID='$ber_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `KUNDEN_LOG_BER` VALUES (NULL, '$last_id', '$person_id', '$ber_obj', '$ber_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KUNDEN_LOG_BER', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `KUNDEN_LOG_BER` SET AKTUELL='0' WHERE PERSON_ID='$person_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LAGER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LAGER` (

\end_layout
\begin_layout Plain Layout

  `LAGER_DAT` int(4) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `LAGER_ID` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LAGER_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LAGER_VERWALTER` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`LAGER_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `LAGER_ID` (`LAGER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
LAGER_DAT 
\end_layout
\begin_layout Description
LAGER_ID 
\end_layout
\begin_layout Description
LAGER_NAME 
\end_layout
\begin_layout Description
LAGER_VERWALTER 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LAGER_ID, LAGER_NAME  FROM `LAGER`  WHERE AKTUELL='1' ORDER BY LAGER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $LAGER_ID, $LAGER_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LAGER_ID, LAGER_NAME  FROM `LAGER`  WHERE AKTUELL='1' ORDER BY LAGER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $LAGER_ID, $LAGER_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LAGER_NAME FROM LAGER WHERE AKTUELL='1' && LAGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $LAGER_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM LAGER WHERE AKTUELL = '1' ORDER BY LAGER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" size=\"1\" id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $lager_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $lager_id = $lager_arr [$a] [LAGER_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select><br>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function lager_bezeichnung($id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LAGER_NAME FROM LAGER WHERE AKTUELL = '1' && LAGER_ID='$id' ORDER BY LAGER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LAGER_ID FROM LAGER WHERE AKTUELL = '1' && LAGER_NAME='$bez' ORDER BY LAGER_NAME ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LAGER_NAME, PARTNER_ID FROM LAGER RIGHT JOIN(LAGER_PARTNER) ON (LAGER.LAGER_ID = LAGER_PARTNER.LAGER_ID) WHERE LAGER.AKTUELL = '1' && LAGER_PARTNER.AKTUELL = '1' && LAGER.LAGER_ID='$id' ORDER BY LAGER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $az = mysql_numrows ( $result ); // az = anzahl zeilen
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" id=\"$id\" $js_action>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Partner\">Partner</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Lager\">Lager</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LAGER_ID, LAGER_NAME  FROM `LAGER`  WHERE AKTUELL='1' ORDER BY LAGER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $LAGER_ID, $LAGER_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$LAGER_ID\" selected>$LAGER_NAME</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$LAGER_ID\">$LAGER_NAME</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LAGER_PARTNER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LAGER_PARTNER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `LAGER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `LAGER_ID` (`LAGER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `PARTNER_ID` (`PARTNER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
LAGER_ID 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LAGER_NAME, PARTNER_ID FROM LAGER RIGHT JOIN(LAGER_PARTNER) ON (LAGER.LAGER_ID = LAGER_PARTNER.LAGER_ID) WHERE LAGER.AKTUELL = '1' && LAGER_PARTNER.AKTUELL = '1' && LAGER.LAGER_ID='$id' ORDER BY LAGER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LEERSTAND_INTERESSENT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LEERSTAND_INTERESSENT` (

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `NAME` varchar(200) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANSCHRIFT` mediumtext NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEL` varchar(50) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMAIL` varchar(70) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINZUG` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZIMMER` varchar(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HINWEIS` mediumtext NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=63 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ID 
\end_layout
\begin_layout Description
NAME 
\end_layout
\begin_layout Description
ANSCHRIFT 
\end_layout
\begin_layout Description
TEL 
\end_layout
\begin_layout Description
EMAIL 
\end_layout
\begin_layout Description
EINZUG 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
ZIMMER 
\end_layout
\begin_layout Description
HINWEIS 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO LEERSTAND_INTERESSENT VALUES (NULL, '$name', '$anschrift', '$tel', '$email','$w_datum_d', '$datum', '$zimmer', '$hinweis','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *, DATE_FORMAT(EINZUG, '%d.%m.%Y') AS W_EINZUG FROM LEERSTAND_INTERESSENT WHERE EINZUG>DATE(NOW()) && AKTUELL='1' ORDER BY ZIMMER, EINZUG ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `LEERSTAND_INTERESSENT` WHERE `ID` ='$id' AND `AKTUELL` = '1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `LEERSTAND_INTERESSENT` SET AKTUELL='0' WHERE `ID` ='$id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function interessenten_updaten($id, $name, $anschrift, $tel, $email, $einzug, $zimmer, $hinweis) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `LEERSTAND_INTERESSENT` SET NAME='$name', ANSCHRIFT='$anschrift', TEL='$tel', EMAIL='$email', EINZUG='$einzug', ZIMMER='$zimmer', HINWEIS='$hinweis' WHERE `ID` ='$id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `LEERSTAND_INTERESSENT` SET NAME='$name', ANSCHRIFT='$anschrift', TEL='$tel', EMAIL='$email', EINZUG='$einzug', ZIMMER='$zimmer', HINWEIS='$hinweis' WHERE `ID` ='$id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LEISTUNGSKATALOG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LEISTUNGSKATALOG` (

\end_layout
\begin_layout Plain Layout

  `LK_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `LK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(160) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEWERK` int(11) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`LK_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `LK_ID` (`LK_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `BEZEICHNUNG` (`BEZEICHNUNG`),

\end_layout
\begin_layout Plain Layout

  KEY `GEWERK` (`GEWERK`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=47542 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
LK_DAT 
\end_layout
\begin_layout Description
LK_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
GEWERK 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_dat' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LK_ID, BEZEICHNUNG FROM `LEISTUNGSKATALOG` WHERE (`GEWERK` ='$gewerk_id' OR `GEWERK` IS NULL) AND `AKTUELL` ='1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LK_ID, BEZEICHNUNG FROM `LEISTUNGSKATALOG` WHERE (`GEWERK` ='$gewerk_id' OR `GEWERK` IS NULL) AND `AKTUELL` ='1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LK_ID FROM LEISTUNGSKATALOG WHERE AKTUELL = '1' ORDER BY LK_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT LK_ID FROM LEISTUNGSKATALOG WHERE GEWERK='$gewerk_id' && BEZEICHNUNG='$beschreibung' && AKTUELL = '1' ORDER BY LK_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZEICHNUNG FROM LEISTUNGSKATALOG WHERE LK_ID='$leistung_id' && AKTUELL = '1' ORDER BY LK_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO LEISTUNGSKATALOG VALUES (NULL, '$lk_id', '$leistungs_beschreibung', '$this->gewerk_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        if ($last_dat) {
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'LEISTUNGSKATALOG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LIEFERSCHEINE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LIEFERSCHEINE` (

\end_layout
\begin_layout Plain Layout

  `L_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `L_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LI_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LI_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `L_NR` int(30) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`L_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `L_ID` (`L_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `EMPF_TYP` (`EMPF_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `EMPF_ID` (`EMPF_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `L_NR` (`L_NR`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
L_DAT 
\end_layout
\begin_layout Description
L_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
LI_TYP 
\end_layout
\begin_layout Description
LI_ID 
\end_layout
\begin_layout Description
EMPF_TYP 
\end_layout
\begin_layout Description
EMPF_ID 
\end_layout
\begin_layout Description
L_NR 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM LIEFERSCHEINE WHERE AKTUELL='1' && DATUM='$datum' && LI_TYP='$li_typ' && LI_ID='$li_id' && EMPF_TYP='$empf_typ' && EMPF_ID='$empf_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO LIEFERSCHEINE VALUES (NULL, '$last_id','$datum', '$li_typ', '$li_id', '$empf_typ','$empf_id','$l_nr', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'LIEFERSCHEINE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LIEFERSCHEINE_OK
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LIEFERSCHEINE_OK` (

\end_layout
\begin_layout Plain Layout

  `L_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `L_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LI_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LI_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `L_NR` int(30) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`L_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
L_DAT 
\end_layout
\begin_layout Description
L_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
LI_TYP 
\end_layout
\begin_layout Description
LI_ID 
\end_layout
\begin_layout Description
EMPF_TYP 
\end_layout
\begin_layout Description
EMPF_ID 
\end_layout
\begin_layout Description
L_NR 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
LV
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV` (

\end_layout
\begin_layout Plain Layout

  `LV_ID` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `TEXT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEWERK_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROJEKT_ID` int(1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`LV_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
LV_ID 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
GEWERK_ID 
\end_layout
\begin_layout Description
PROJEKT_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    readme.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont('./src/fonts/Helvetica-Bold.afm');
        \end_layout
            \begin_layout Plain Layout
        $text = 'R&OS';
        \end_layout
            \begin_layout Plain Layout
        $ts=100*$factor;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    Cpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->selectFont('Helvetica');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    Cpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->selectFont('./fonts/Helvetica');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    Cpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->selectFont('./fonts/Helvetica');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $h = $this->fonts[$this->currentFont]['Descender'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    Cpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->selectFont(dirname(__FILE__) . '/fonts/Helvetica');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    Cpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->selectFont('./fonts/Helvetica');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( 'Helvetica.afm' );
        \end_layout
            \begin_layout Plain Layout
        $pdf->ezSetCmMargins ( 4.5, 0, 0, 0 );
        \end_layout
            \begin_layout Plain Layout
        /* Kopfzeile */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( 'Helvetica.afm' );
        \end_layout
            \begin_layout Plain Layout
        $pdf->ezSetCmMargins ( 4.5, 0, 0, 0 );
        \end_layout
            \begin_layout Plain Layout
        /* Kopfzeile */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Ausgaben/Einnahmen\">Ausgaben/Einnahmen</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Mittelverwendung\" >Mittelverwendung</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
LV_GLIEDERUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV_GLIEDERUNG` (

\end_layout
\begin_layout Plain Layout

  `G_ID` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `NR` decimal(10,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEXT` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`G_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
G_ID 
\end_layout
\begin_layout Description
NR 
\end_layout
\begin_layout Description
TEXT 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
LV_K_ARTIKEL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV_K_ARTIKEL` (

\end_layout
\begin_layout Plain Layout

  `A_ID` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `P_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZEITWERT` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`A_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
A_ID 
\end_layout
\begin_layout Description
P_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
ZEITWERT 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
LV_K_POSITIONEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV_K_POSITIONEN` (

\end_layout
\begin_layout Plain Layout

  `P_ID` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `TEXT` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEWERK_ID` int(1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`P_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
P_ID 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
GEWERK_ID 
\end_layout
\begin_layout Description
G_ID 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
LV_POSITIONEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV_POSITIONEN` (

\end_layout
\begin_layout Plain Layout

  `LVP_ID` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `LV_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `P_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `A_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ARTIKEL_NR` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ARTL_LIEFERANT` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PREIS` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZEITWERT` decimal(10,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`LVP_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
LVP_ID 
\end_layout
\begin_layout Description
LV_ID 
\end_layout
\begin_layout Description
G_ID 
\end_layout
\begin_layout Description
P_ID 
\end_layout
\begin_layout Description
A_ID 
\end_layout
\begin_layout Description
ARTIKEL_NR 
\end_layout
\begin_layout Description
ARTL_LIEFERANT 
\end_layout
\begin_layout Description
PREIS 
\end_layout
\begin_layout Description
ZEITWERT 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
LV_PROJEKTE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `LV_PROJEKTE` (

\end_layout
\begin_layout Plain Layout

  `PROJEKT_ID` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `TEXT` varchar(255) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUTHOR` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ART` enum('Altbau','Neubau','Sanierung','Teilsanierung') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PROJEKT_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PROJEKT_ID 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
AUTHOR 
\end_layout
\begin_layout Description
ART 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
MIETENTWICKLUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MIETENTWICKLUNG` (

\end_layout
\begin_layout Plain Layout

  `MIETENTWICKLUNG_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `MIETENTWICKLUNG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKATEGORIE` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANFANG` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ENDE` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_ANTEIL` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETENTWICKLUNG_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`MIETENTWICKLUNG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_TYP` (`KOSTENTRAEGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_ID` (`KOSTENTRAEGER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `BETRAG` (`BETRAG`),

\end_layout
\begin_layout Plain Layout

  KEY `ANFANG` (`ANFANG`),

\end_layout
\begin_layout Plain Layout

  KEY `ENDE` (`ENDE`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=35167 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
MIETENTWICKLUNG_DAT 
\end_layout
\begin_layout Description
MIETENTWICKLUNG_ID 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
KOSTENKATEGORIE 
\end_layout
\begin_layout Description
ANFANG 
\end_layout
\begin_layout Description
ENDE 
\end_layout
\begin_layout Description
MWST_ANTEIL 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
MIETENTWICKLUNG_AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' && KOSTENKATEGORIE='$kostenkat' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT SUM( M_SUMME ) AS J_SUMME FROM ( SELECT ((DATEDIFF( NEW_ENDE, NEW_ANFANG ) +1) / '30.417') * BETRAG AS M_SUMME, NEW_ANFANG, NEW_ENDE, KOSTENKATEGORIE, BETRAG FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01' OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00', '$jahr-12-31', ENDE ) AS NEW_ENDE FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = '$kos_typ' && `KOSTENTRAEGER_ID` = '$kos_id' && KOSTENKATEGORIE = 'Nebenkosten Vorauszahlung' && (
        \end_layout
            \begin_layout Plain Layout
        ENDE > '$jahr-01-01' OR ENDE = '0000-00-00') ORDER BY `NEW_ENDE` ASC) AS tage) AS J ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%'  ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%'  ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENKATEGORIE='KALTMIETE' OR KOSTENKATEGORIE='BK' OR KOSTENKATEGORIE='HK' OR KOSTENKATEGORIE='ME'" );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_mietdaten = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG, sum(BETRAG) as SUMME FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' &&" );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_mietdaten = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_betrag', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET ENDE='$mietvertrag_bis' WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' && (ENDE='0000-00-00' OR ENDE>='$mietvertrag_bis') && MIETENTWICKLUNG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        /* protokollieren fehlt */
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && (KOSTENKATEGORIE = 'Miete kalt' OR KOSTENKATEGORIE = 'MOD' OR KOSTENKATEGORIE = 'MHG')" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Miete kalt' OR KOSTENKATEGORIE = 'MOD' OR KOSTENKATEGORIE = 'MHG'<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' WHERE MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        echo "Mietvertrag wurde gelöscht!";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES(NULL, '$last_me_id', '$kos_typ', '$kos_id', 'Betriebskostenabrechnung $this->bk_jahr', '$this->bk_verrechnungs_datum', '$this->bk_verrechnungs_datum', '$bk_ergebnis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } // end if check_me
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES(NULL, '$last_me_id', '$kos_typ', '$kos_id', 'Nebenkosten Vorauszahlung', '$this->bk_verrechnungs_datum', '0000-00-00', '$nk_v_neu', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET ENDE='$ablauf_datum' WHERE KOSTENKATEGORIE = 'Nebenkosten Vorauszahlung' && BETRAG='$nk_v_alt' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } // end if check_me
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES(NULL, '$last_me_id', '$kos_typ', '$kos_id', 'Heizkosten Vorauszahlung', '$this->bk_verrechnungs_datum', '0000-00-00', '$hk_v_neu', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET ENDE='$ablauf_datum' WHERE KOSTENKATEGORIE = 'Heizkosten Vorauszahlung' && BETRAG='$hk_v_alt' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } // end check hk vorhanden
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Heizkostenabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Betriebskostenabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Kaltwasserabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE='$kategorie' && ANFANG='$anfang' && ENDE='$ende'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Heizkostenabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Betriebskostenabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME  FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Kaltwasserabrechnung $jahr'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE='$string' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // die("SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE='$string' ORDER BY ANFANG ASC");
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if (! $numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Nebenkosten Vorauszahlung' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2008-03-01' && EINHEIT.EINHEIT_KURZNAME LIKE '%E-%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG='2008-03-01' WHERE MIETVERTRAG_ID='$e_mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_bk_hk_datum() {
        \end_layout
            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG=ENDE WHERE KOSTENKATEGORIE LIKE '%abrechnung%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG=ENDE WHERE KOSTENKATEGORIE LIKE '%abrechnung%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function set_datum_andere() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2007-01-01' && EINHEIT.EINHEIT_KURZNAME NOT LIKE '%E-%'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG='2007-01-01' WHERE MIETVERTRAG_ID='$e_mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG, MIETENTWICKLUNG.MWST_ANTEIL FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' GROUP BY MIETENTWICKLUNG_DAT ORDER BY KOSTENKATEGORIE ASC, ANFANG ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY KOSTENKATEGORIE ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && ENDE='0000-00-00' GROUP BY KOSTENKATEGORIE ORDER BY KOSTENKATEGORIE ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENKATEGORIE='$kos_kat' ORDER BY ANFANG";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>='$heute') && ANFANG <= '$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage1;
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>'$heute') && ANFANG>='$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE!='0000-00-00' && ENDE<'$heute') ORDER BY ENDE DESC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>='$heute') && ANFANG <= '$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage1;
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>'$heute') && ANFANG>='$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE!='0000-00-00' && ENDE<'$heute') ORDER BY ENDE DESC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETENTWICKLUNG_ID, KOSTENTRAEGER_ID, KOSTENKATEGORIE, BETRAG, MWST_ANTEIL, ANFANG, ENDE FROM MIETENTWICKLUNG where MIETENTWICKLUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETENTWICKLUNG_ID, $KOSTENTRAEGER_ID, $KOSTENKATEGORIE, $BETRAG, $MWST_ANTEIL, $ANFANG, $ENDE ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' where MIETENTWICKLUNG_DAT='$me_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, $me_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' where MIETENTWICKLUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$last_id', '$kos_typ', '$kos_id', '$kat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$last_id', '$kos_typ', '$kos_id', '$kat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE MIETENTWICKLUNG_DAT='$me_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, ANFANG, ENDE, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME
        \end_layout
            \begin_layout Plain Layout
        FROM `MIETENTWICKLUNG` , MIETVERTRAG, EINHEIT
        \end_layout
            \begin_layout Plain Layout
        WHERE `KOSTENKATEGORIE` LIKE '$kosten_kat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *
        \end_layout
            \begin_layout Plain Layout
        FROM  `MIETENTWICKLUNG`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `KOSTENTRAEGER_TYP` =  '$kos_typ'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='$kostenkat' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM MIETENTWICKLUNG where MIETENTWICKLUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE='Miete kalt'  ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kostentraeger_typ' && KOSTENTRAEGER_ID = '$kostentrager_id' && KOSTENKATEGORIE='$kostenkategorie' && ANFANG='$anfang' && ENDE='$ende' && BETRAG='$betrag' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$last_id', '$kostentraeger_typ', '$kostentrager_id', '$kostenkategorie', '$anfang', '$ende', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETENTWICKLUNG_ID FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' ORDER BY MIETENTWICKLUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['MIETENTWICKLUNG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%rate%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE NOT LIKE 'RATENZAHLUNG' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* echo "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'ORDER BY ANFANG ASC"; */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENTRAEGER_TYP='MIETVERTRAG' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* echo "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'ORDER BY ANFANG ASC"; */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%abrechnung%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '1' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $datum = explode ( "-", $row [ENDE] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE, BETRAG, KOSTENKATEGORIE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE, BETRAG, KOSTENKATEGORIE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '1' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $datum = explode ( "-", $row [ENDE] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'RATENZAHLUNG' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' && KOSTENKATEGORIE NOT LIKE '%energie%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_MAHNUNG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Mahngebühr' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Mahngebühr' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' &&  KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Wasserkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_BETRIEBSKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Betriebskostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_HEIZKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Heizkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_WASSERKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Wasserkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM `MIETENTWICKLUNG` WHERE `KOSTENTRAEGER_TYP` = 'Mietvertrag'  AND `KOSTENTRAEGER_ID` ='$mietvertrag_id' AND `KOSTENKATEGORIE` =  'Betriebskosten Vorauszahlung'  AND `MIETENTWICKLUNG_AKTUELL` = '1'  ORDER BY ANFANG DESC LIMIT 0 , 1) <= '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG  FROM `MIETENTWICKLUNG` WHERE `KOSTENTRAEGER_TYP` = 'Mietvertrag'  AND `KOSTENTRAEGER_ID` ='$mietvertrag_id' AND `KOSTENKATEGORIE` =  'Heizkosten Vorauszahlung'  AND `MIETENTWICKLUNG_AKTUELL` = '1'  ORDER BY ANFANG DESC LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // if($mietvertrag_id=='1379'){
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Nebenkosten VZ - Anteilig' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Nebenkosten VZ - Anteilig' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG' OR KOSTENKATEGORIE LIKE 'Nebenkosten VZ - Anteilig') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC<br>";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG AS SALDO_VORVERWALTUNG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENKATEGORIE = 'Saldo Vortrag Vorverwaltung' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG AS DATUM FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENKATEGORIE = 'Saldo Vortrag Vorverwaltung' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE AS DATUM FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id'  && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT SUM( M_SUMME ) AS J_SUMME FROM ( SELECT ((DATEDIFF( NEW_ENDE, NEW_ANFANG ) +1) / '30.417') * BETRAG AS M_SUMME, NEW_ANFANG, NEW_ENDE, KOSTENKATEGORIE, BETRAG FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01' OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00', '$jahr-12-31', ENDE ) AS NEW_ENDE FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = '$kos_typ' && `KOSTENTRAEGER_ID` = '$kos_id' && KOSTENKATEGORIE = 'Nebenkosten Vorauszahlung' && (
        \end_layout
            \begin_layout Plain Layout
        ENDE > '$jahr-01-01' OR ENDE = '0000-00-00') ORDER BY `NEW_ENDE` ASC) AS tage) AS J ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ANFANG < '$jahr-01-01' && ( ENDE >= '$jahr-01-01'
        \end_layout
            \begin_layout Plain Layout
        OR ENDE = '0000-00-00' ) , '$jahr-01-01', ANFANG ) AS NEW_ANFANG, IF( ENDE = '0000-00-00' OR ENDE>'$jahr-12-31', '$jahr-12-31', ENDE ) AS NEW_ENDE
        \end_layout
            \begin_layout Plain Layout
        FROM MIETENTWICKLUNG
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%' && KOSTENKATEGORIE NOT LIKE 'Kaltwasserabr%' ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%' && KOSTENKATEGORIE NOT LIKE 'Kaltwasserabrechnung%' ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt%' or KOSTENKATEGORIE LIKE 'MHG%') ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->erhoehungsbetrag = $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) >= '$jahr-$monat'  && (KOSTENKATEGORIE LIKE 'MHG' or KOSTENKATEGORIE LIKE 'Miete kalt') ORDER BY ANFANG ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETENTWICKLUNG` WHERE `KOSTENKATEGORIE` LIKE 'MOD' AND KOSTENTRAEGER_TYP='MIETVERTRAG' AND KOSTENTRAEGER_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 1,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        if (! $numrows1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 1,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        $row1 = mysql_fetch_assoc ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '$kostenkat' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, KOSTENKATEGORIE, ENDE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1'  && (KOSTENKATEGORIE LIKE 'Miete kalt%' or KOSTENKATEGORIE LIKE 'MOD') && ANFANG >='$ab_datum' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $my_arr = Array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, KOSTENKATEGORIE, ENDE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE LIKE 'MOD' && ANFANG >='$ab_datum' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && BETRAG!='0' ORDER BY MIETENTWICKLUNG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
MIETER_MAHNLISTEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MIETER_MAHNLISTEN` (

\end_layout
\begin_layout Plain Layout

  `MAHN_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SALDO` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZAHLUNGSFRIST_Z` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZAHLUNGSFRIST_M` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MAHN_GEB` decimal(6,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`MAHN_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=114330 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
MAHN_DAT 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
MIETVERTRAG_ID 
\end_layout
\begin_layout Description
SALDO 
\end_layout
\begin_layout Description
ZAHLUNGSFRIST_Z 
\end_layout
\begin_layout Description
ZAHLUNGSFRIST_M 
\end_layout
\begin_layout Description
MAHN_GEB 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `MIETER_MAHNLISTEN`  WHERE DATUM='$datum' && MIETVERTRAG_ID='$mietvertrag_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_mahnliste_heute($mv_id, $saldo) {
        \end_layout
            \begin_layout Plain Layout
        $datum = date ( "Y-m-d" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETER_MAHNLISTEN VALUES (NULL,'$datum', '$mv_id', '$saldo','0000-00-00','0000-00-00','0.00', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETER_MAHNLISTEN VALUES (NULL,'$datum', '$mv_id', '$saldo','0000-00-00','0000-00-00','0.00', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SALDO FROM `MIETER_MAHNLISTEN`  WHERE DATUM='$datum' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZAHLUNGSFRIST_M, SALDO, MAHN_GEB  FROM `MIETER_MAHNLISTEN` WHERE MIETVERTRAG_ID='$mietvertrag_id' && ZAHLUNGSFRIST_M!='0000-00-00' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_zahlungsfrist_z($mv_id, $datum, $saldo) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_Z='$datum' WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' && ZAHLUNGSFRIST_Z='0000-00-00'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_Z='$datum' WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' && ZAHLUNGSFRIST_Z='0000-00-00'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_zahlungsfrist_m($mv_id, $datum, $saldo, $mahn_geb) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_M='$datum', MAHN_GEB='$mahn_geb'  WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_M='$datum', MAHN_GEB='$mahn_geb'  WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZAHLUNGSFRIST_Z, SALDO  FROM `MIETER_MAHNLISTEN` WHERE MIETVERTRAG_ID='$mietvertrag_id' && ZAHLUNGSFRIST_Z!='0000-00-00' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
MIETSPIEGEL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MIETSPIEGEL` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `JAHR` varchar(4) COLLATE latin1_german2_ci NOT NULL DEFAULT '2015',

\end_layout
\begin_layout Plain Layout

  `ORT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FELD` varchar(3) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `U_WERT` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_WERT` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `O_WERT` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=377 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
JAHR 
\end_layout
\begin_layout Description
ORT 
\end_layout
\begin_layout Description
FELD 
\end_layout
\begin_layout Description
U_WERT 
\end_layout
\begin_layout Description
M_WERT 
\end_layout
\begin_layout Description
O_WERT 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT JAHR, ORT FROM MIETSPIEGEL GROUP BY JAHR, ORT ORDER BY JAHR DESC, ORT ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETSPIEGEL WHERE JAHR='$jahr' && ORT='' ORDER BY FELD ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETSPIEGEL WHERE JAHR='$jahr' && ORT='$ort' ORDER BY FELD ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETSPIEGEL WHERE JAHR='$jahr' && ORT='$ort' ORDER BY FELD ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM MIETSPIEGEL WHERE FELD='0' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETSPIEGEL VALUES (NULL, '$jahr', '', '$feld', '$u_wert', '$m_wert', '$o_wert')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETSPIEGEL VALUES (NULL, '$jahr', '$ort', '$feld', '$u_wert', '$m_wert', '$o_wert')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM MIETSPIEGEL WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT U_WERT, M_WERT, O_WERT FROM MIETSPIEGEL WHERE JAHR='$jahr' && FELD='$feld' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT JAHR FROM MIETSPIEGEL ORDER BY JAHR DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
MIETVERTRAG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MIETVERTRAG` (

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_VON` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_BIS` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`MIETVERTRAG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `EINHEIT_ID` (`EINHEIT_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `MIETVERTRAG_ID` (`MIETVERTRAG_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `MIETVERTRAG_BIS` (`MIETVERTRAG_BIS`),

\end_layout
\begin_layout Plain Layout

  KEY `MIETVERTRAG_VON` (`MIETVERTRAG_VON`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3473 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
MIETVERTRAG_DAT 
\end_layout
\begin_layout Description
MIETVERTRAG_ID 
\end_layout
\begin_layout Description
MIETVERTRAG_VON 
\end_layout
\begin_layout Description
MIETVERTRAG_BIS 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
MIETVERTRAG_AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  && MIETVERTRAG_ID!='0'order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->id = $select_spaltenname;
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_einzugsdatum($mietvertrag_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->mietvertrag_von = $row [MIETVERTRAG_VON];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO $tabelle_in_gross  VALUES (NULL, '$letzte_tab_id', '$mv_id', '$mietekalt_beschriftung', '$mietvertrag_von', '0000-00-00', '$miete_kalt', '1')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO $tabelle_in_gross VALUES (NULL, '$letzte_tab_id', '$mv_id', '$nebenkosten_beschriftung', '$mietvertrag_von', '0000-00-00', '$nebenkosten_summe', '1')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO $tabelle_in_gross VALUES (NULL, '$letzte_tab_id', '$mv_id', '$heizkosten_beschriftung', '$mietvertrag_von', '0000-00-00', '$heizkosten_summe', '1')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' && KOSTENKATEGORIE='$kostenkat' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kaution', '$betrag', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Einzugsermächtigung', 'JA', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kontoinhaber-AutoEinzug', '$kontoinhaber', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Kontonummer-AutoEinzug', '$kontonummer', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Bankname-AutoEinzug', '$bankname', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mieten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$letzte_tab_id', 'Autoeinzugsart', '$einzugsart', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>DB = $db_abfrage<br>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m-%d' ) <= '$datum' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m-%d' ) >= '$datum'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function mietvertrag_beenden_form_alt11($mietvertrag_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_DAT, MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_DAT, MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' where MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // aktuell auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_ID, $MIETVERTRAG_VON, $EINHEIT_ID ) = mysql_fetch_row ( $resultat1 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage2 = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$MIETVERTRAG_VON', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        } // while end
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage3 = "SELECT MIETVERTRAG_DAT FROM MIETVERTRAG where MIETVERTRAG_BIS='$mietvertrag_bis' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat3 = mysql_query ( $db_abfrage3 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat3 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' where MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        // echo "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' where MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // aktuell auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_DAT='$mietvertrag_dat' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_ID, $MIETVERTRAG_VON, $EINHEIT_ID ) = mysql_fetch_row ( $resultat1 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage2 = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$mietvertrag_id_alt', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$MIETVERTRAG_ID', '$mietvertrag_von', '$mietvertrag_bis', '$EINHEIT_ID', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat2 = mysql_query ( $db_abfrage2 ) or die ( mysql_error () ); // Neuer Datensatz mit aktuellem Datum
        \end_layout
            \begin_layout Plain Layout
        } // while end
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage3 = "SELECT MIETVERTRAG_DAT FROM MIETVERTRAG where MIETVERTRAG_VON='$mietvertrag_von' && MIETVERTRAG_BIS='$mietvertrag_bis' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_DAT FROM MIETVERTRAG where MIETVERTRAG_VON='$mietvertrag_von' && MIETVERTRAG_BIS='$mietvertrag_bis' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat3 = mysql_query ( $db_abfrage3 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>SELECT MIETVERTRAG_DAT FROM MIETVERTRAG where MIETVERTRAG_VON='$mietvertrag_von' && MIETVERTRAG_BIS='$mietvertrag_bis' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_DAT DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat3 = mysql_query ( $db_abfrage3 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat3 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' ORDER BY EINHEIT.EINHEIT_KURZNAME,MIETVERTRAG.MIETVERTRAG_VON  ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS!='0000-00-00' && MIETVERTRAG.MIETVERTRAG_BIS<'$datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, MIETVERTRAG.MIETVERTRAG_VON, MIETVERTRAG.MIETVERTRAG_BIS, MIETVERTRAG.EINHEIT_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG.MIETVERTRAG_BIS>'$datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ( SELECT sum(BETRAG) FROM MIETE_ZAHLBETRAG WHERE MIETVERTRAG_ID='$mietvertrag_id' ) AS ZB,  ( SELECT sum(BETRAG) FROM MIETBUCHUNGEN WHERE  MIETVERTRAG_ID='$mietvertrag_id' ) AS INTERN" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return $my_array;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%'  ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%'  ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT  DISTINCT MIETVERTRAG.EINHEIT_ID, MIETVERTRAG.MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_PERSON_ID";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " FROM `MIETVERTRAG`, PERSON_MIETVERTRAG WHERE ((MIETVERTRAG_BIS = '0000-00-00')OR (MIETVERTRAG_BIS >'2008-06-10'))";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " && ( MIETVERTRAG.MIETVERTRAG_ID = PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID) ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>='$datum_heute') ORDER BY MIETVERTRAG_VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM MIETVERTRAG where MIETVERTRAG_ID='$mietvertrag_id' && MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG where EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && (MIETVERTRAG_BIS ='0000-00-00' OR MIETVERTRAG_BIS>=$heute) ORDER BY MIETVERTRAG_VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $delete_link = "<a class=\"table_links\" href=\"?daten=person&anzeigen=person_loeschen&person_dat=$PERSON_DAT\">Löschen</a>";
        \end_layout
            \begin_layout Plain Layout
        $aendern_link = "<a class=\"table_links\" href=\"?daten=person&anzeigen=person_aendern&person_id=$PERSON_ID\">Ändern</a>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile1\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td>$mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        $einheit_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile2\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td> $mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $counter = 0;
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG where MIETVERTRAG_AKTUELL='1' && ((MIETVERTRAG_BIS='0000-00-00') OR (MIETVERTRAG_BIS<'$datum_heute'))";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietervertrag_ids = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrags_ids_array[$a]' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_DAT FROM MIETVERTRAG WHERE MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$PERSON_MIETVERTRAG_MIETVERTRAG_ID' && PERSON_MIETVERTRAG_PERSON_ID='$person_id' ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$akt_mietvertrag_id', '$von', '$bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_mietvertrag_dat_of_mietvertrag_id ( $akt_mietvertrag_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' && ((MIETVERTRAG_BIS = '0000-00-00') OR (MIETVERTRAG_BIS > '$datum_heute')) order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' &&  MIETVERTRAG_VON = '$von'  && MIETVERTRAG_BIS = '$bis'  LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_VON = '$von' && MIETVERTRAG_BIS = '$bis' LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && (MIETVERTRAG.MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG.MIETVERTRAG_BIS>='$this->datum_heute') ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $db_abfrage ) ) {
        \end_layout
            \begin_layout Plain Layout
        $this->vermietete_einheiten [] [mv_id] = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG.MIETVERTRAG_ID, EINHEIT.EINHEIT_KURZNAME FROM MIETVERTRAG JOIN(EINHEIT) ON (EINHEIT.EINHEIT_ID = MIETVERTRAG.EINHEIT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' &&  MIETVERTRAG.MIETVERTRAG_BIS<'$this->datum_heute' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC,MIETVERTRAG.MIETVERTRAG_BIS  DESC";
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $db_abfrage ) ) {
        \end_layout
            \begin_layout Plain Layout
        $this->unvermietete_einheiten [] [mv_id] = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' ORDER BY MIETVERTRAG_VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' ORDER BY MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' ORDER BY MIETVERTRAG_VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON $asc LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && (DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS='0000-00-00') ORDER BY MIETVERTRAG_VON ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS >= '$this->datum_heute' OR MIETVERTRAG_BIS = '0000-00-00' ) LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM `MIETVERTRAG` WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL='1' && ((MIETVERTRAG_BIS<'$datum_heute') && (MIETVERTRAG_BIS!='0000-00-00')) ORDER BY MIETVERTRAG_BIS DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_id = $row ['MIETVERTRAG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_ID='$alle_einheiten_array[$a][EINHEIT_ID]' && (MIETVERTRAG_BIS>='$datum_heute' OR MIETVERTRAG_BIS = '0000-00-00') ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID='$einheit_id' && MIETVERTRAG_AKTUELL='1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_mietvertraege_gesamt = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_ID='$einheit_id' && ((MIETVERTRAG_BIS>='$datum_heute') OR (MIETVERTRAG_BIS = '0000-00-00')) ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->get_einheit_info ( $row ['EINHEIT_ID'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['MIETVERTRAG_VON'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENKATEGORIE='KALTMIETE' OR KOSTENKATEGORIE='BK' OR KOSTENKATEGORIE='HK' OR KOSTENKATEGORIE='ME'" );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_mietdaten = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG, sum(BETRAG) as SUMME FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' &&" );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_mietdaten = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, KOSTENKATEGORIE FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $alle_zahlungen = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $alle_zahlungen = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, KOSTENKATEGORIE FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $alle_zahlungen = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETVERTRAG_AKTUELL = '1' && ( (MIETVERTRAG_BIS >= '$datum_heute')
        \end_layout
            \begin_layout Plain Layout
        OR (MIETVERTRAG_BIS = '0000-00-00') ) " );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, MIETVERTRAG_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr-$monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr-$monat' OR MIETVERTRAG_BIS = '0000-00-00' )" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID = '$id' order by MIETVERTRAG_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $EINHEIT_ID, $MIETVERTRAG_VON, $MIETVERTRAG_BIS ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $form->send_button_js ( 'btn_mv_updaten', 'Mietvertrag ändern', $sendbutton_js );
        \end_layout
            \begin_layout Plain Layout
        $form->ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_betrag', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Einzugsermächtigung', '$ja_nein', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Autoeinzugsart', '$art', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Kontoinhaber-AutoEinzug', '$konto_inh', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Kontonummer-AutoEinzug', '$konto_nr', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'BLZ-AutoEinzug', '$blz', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO DETAIL VALUES (NULL, '$last_id', 'Bankname-AutoEinzug', '$bankname', '', '1', 'MIETVERTRAG', '$mv_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$akt_mietvertrag_id', '$von', '$bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_mietvertrag_dat_of_mietvertrag_id ( $akt_mietvertrag_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON, MIETVERTRAG_BIS, MIETVERTRAG_DAT, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, OBJEKT.OBJEKT_ID, OBJEKT_KURZNAME, HAUS.HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ,HAUS_STADT FROM MIETVERTRAG RIGHT JOIN(EINHEIT,HAUS,OBJEKT) ON (MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID && EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_AKTUELL='1' &&  HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id'  ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' where MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // aktuell auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETVERTRAG', $mietvertrag_dat, $mietvertrag_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$mietvertrag_id_alt', '$mietvertrag_von', '$mietvertrag_bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETVERTRAG', $last_dat, $mietvertrag_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_ZUORDNUNG_ID AS MIETVERTRAG_ID FROM `DETAIL` LEFT JOIN(MIETVERTRAG) ON (DETAIL_ZUORDNUNG_ID=MIETVERTRAG_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='JA' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_AKTUELL = '1' && MIETVERTRAG_AKTUELL = '1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>=CURDATE())" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_ZUORDNUNG_ID AS MIETVERTRAG_ID FROM `DETAIL` LEFT JOIN(MIETVERTRAG) ON (DETAIL_ZUORDNUNG_ID=MIETVERTRAG_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='NEIN' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_AKTUELL = '1' && MIETVERTRAG_AKTUELL = '1' && (MIETVERTRAG_BIS='0000-00-00' OR MIETVERTRAG_BIS>=CURDATE())" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_INHALT='JA' where DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Teilnahme zum Lastschriftverfahren aufgenommen." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE DETAIL SET DETAIL_INHALT='NEIN' where DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Teilnahme zum Lastschriftverfahren ausgesetzt." );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_DAT='$dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function mietvertrag_beenden_db($mv_dat, $mietvertrag_bis) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_BIS='$mietvertrag_bis' WHERE MIETVERTRAG_DAT='$mv_dat'" );
        \end_layout
            \begin_layout Plain Layout
        /* protokollieren fehlt */
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET ENDE='$mietvertrag_bis' WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' && (ENDE='0000-00-00' OR ENDE>='$mietvertrag_bis') && MIETENTWICKLUNG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        /* protokollieren fehlt */
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE `DETAIL` SET DETAIL_INHALT='NEIN' WHERE DETAIL_NAME = 'Einzugsermächtigung' && DETAIL_INHALT='JA' && DETAIL_ZUORDNUNG_TABELLE = 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL = '1' " );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ls_daten_holen($mv_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Kontoinhaber-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_konto_inhaber_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Kontonummer-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_konto_nummer_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='BLZ-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_blz_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Bankname-AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_bankname_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Autoeinzugsart' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_autoeinzugsart_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_DAT, DETAIL_INHALT FROM DETAIL WHERE DETAIL_NAME='Einzugsermächtigung' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->ls_einzugsermaechtigung_dat = $row ['DETAIL_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM DETAIL WHERE DETAIL_NAME LIKE '%AutoEinzug' && DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID='$mv_id' && DETAIL_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_BIS DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y' ) = '$jahr' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, MIETVERTRAG_VON, MIETVERTRAG_BIS, EINHEIT_ID FROM `MIETVERTRAG` WHERE DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) = '$jahr-$monat' && MIETVERTRAG_AKTUELL='1' ORDER BY MIETVERTRAG_VON DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETVERTRAG` WHERE (MIETVERTRAG_VON<='$datum_bis' && (MIETVERTRAG_BIS='0000-00-00' OR (MIETVERTRAG_BIS >= '$datum_von'))) && `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG.EINHEIT_ID IN (SELECT EINHEIT_ID FROM EINHEIT, HAUS, OBJEKT WHERE EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID='$objekt_id' && EINHEIT.EINHEIT_AKTUELL='1') ORDER BY EINHEIT_ID, MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && (KOSTENKATEGORIE = 'Miete kalt' OR KOSTENKATEGORIE = 'MOD' OR KOSTENKATEGORIE = 'MHG')" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Miete kalt' OR KOSTENKATEGORIE = 'MOD' OR KOSTENKATEGORIE = 'MHG'<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' WHERE MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        echo "Mietvertrag wurde gelöscht!";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        echo "Mietvertrag wurde gelöscht!";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM `MIETVERTRAG` WHERE EINHEIT_ID = '$einheit_id' && `MIETVERTRAG_AKTUELL` = '1' ORDER BY `MIETVERTRAG`.`MIETVERTRAG_VON` ASC " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$jahr-01-01', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$jahr-01-01', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT 'MIETVERTRAG' AS KOS_TYP, MIETVERTRAG_ID AS KOS_ID ,`MIETVERTRAG_VON`,`MIETVERTRAG_BIS`,`EINHEIT_ID`,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_VON, '%Y') < '$jahr', '$von', MIETVERTRAG_VON) AS BERECHNUNG_VON,
        \end_layout
            \begin_layout Plain Layout
        IF(DATE_FORMAT(MIETVERTRAG_BIS, '%Y') = '$jahr', MIETVERTRAG_BIS, '$jahr-12-31') AS BERECHNUNG_BIS,
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET ENDE='$ablauf_datum' WHERE KOSTENKATEGORIE = 'Nebenkosten Vorauszahlung' && BETRAG='$nk_v_alt' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } // end if check_me
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETENTWICKLUNG SET ENDE='$ablauf_datum' WHERE KOSTENKATEGORIE = 'Heizkosten Vorauszahlung' && BETRAG='$hk_v_alt' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } // end check hk vorhanden
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$m_r', '$g_id', '$g_gk_id', '$beg', '$name', '$ans', '$kto', '$blz', '$iban', '$bic', '$bank', '$m_udatum', '$m_adatum', '9999-12-31', 'WIEDERKEHREND', 'MIETZAHLUNG', '$eart', 'MIETVERTRAG', '$mv_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl; // Wieviel MV hat die Person (nur aktuelle)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if (! $numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Nebenkosten Vorauszahlung' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->mietvertrag_von = $row ['MIETVERTRAG_VON'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2008-03-01' && EINHEIT.EINHEIT_KURZNAME LIKE '%E-%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG='2008-03-01' WHERE MIETVERTRAG_ID='$e_mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_bk_hk_datum() {
        \end_layout
            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG=ENDE WHERE KOSTENKATEGORIE LIKE '%abrechnung%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG=ENDE WHERE KOSTENKATEGORIE LIKE '%abrechnung%' && KOSTENTRAEGER_TYP='Mietvertrag'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function set_datum_andere() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENTRAEGER_ID FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE ANFANG<'2007-01-01' && EINHEIT.EINHEIT_KURZNAME NOT LIKE '%E-%'" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETENTWICKLUNG SET ANFANG='2007-01-01' WHERE MIETVERTRAG_ID='$e_mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG, MIETENTWICKLUNG.MWST_ANTEIL FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' GROUP BY MIETENTWICKLUNG_DAT ORDER BY KOSTENKATEGORIE ASC, ANFANG ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT MIETENTWICKLUNG.MIETENTWICKLUNG_DAT, MIETENTWICKLUNG.KOSTENTRAEGER_ID, EINHEIT.EINHEIT_KURZNAME, MIETENTWICKLUNG.KOSTENKATEGORIE, MIETENTWICKLUNG.ANFANG, MIETENTWICKLUNG.ENDE, MIETENTWICKLUNG.BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.KOSTENTRAEGER_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID ) WHERE MIETENTWICKLUNG.KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY KOSTENKATEGORIE ASC LIMIT 0,30";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && ENDE='0000-00-00' GROUP BY KOSTENKATEGORIE ORDER BY KOSTENKATEGORIE ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && KOSTENKATEGORIE='$kos_kat' ORDER BY ANFANG";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>='$heute') && ANFANG <= '$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage1;
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>'$heute') && ANFANG>='$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE!='0000-00-00' && ENDE<'$heute') ORDER BY ENDE DESC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>='$heute') && ANFANG <= '$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage1;
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE='0000-00-00' OR ENDE>'$heute') && ANFANG>='$heute' ORDER BY KOSTENKATEGORIE, ANFANG, ENDE ASC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT * FROM `MIETENTWICKLUNG`  WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL='1' && (ENDE!='0000-00-00' && ENDE<'$heute') ORDER BY ENDE DESC";
        \end_layout
            \begin_layout Plain Layout
        $result1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETENTWICKLUNG VALUES (NULL, '$me_id', 'MIETVERTRAG', '$mv_id', '$kostenkat', '$anfang', '$ende', '$mwst_anteil', '$betrag', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Miete kalt' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE='Nebenkosten Vorauszahlung' && MIETENTWICKLUNG_AKTUELL='1' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET OPTION SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = 'SELECT ANFANG, ENDE, EINHEIT_KURZNAME, EINHEIT.EINHEIT_ID, MIETENTWICKLUNG.MIETVERTRAG_ID, KOSTENKATEGORIE, BETRAG FROM `MIETENTWICKLUNG` JOIN (MIETVERTRAG, EINHEIT) ON (MIETENTWICKLUNG.MIETVERTRAG_ID = MIETVERTRAG.MIETVERTRAG_ID && MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID) WHERE KOSTENKATEGORIE=\'Heizkosten Vorauszahlung\' && MIETENTWICKLUNG_AKTUELL=\'1\' GROUP BY EINHEIT_KURZNAME ORDER BY `EINHEIT`.`EINHEIT_KURZNAME` ASC';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, ANFANG, ENDE, BETRAG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME
        \end_layout
            \begin_layout Plain Layout
        FROM `MIETENTWICKLUNG` , MIETVERTRAG, EINHEIT
        \end_layout
            \begin_layout Plain Layout
        WHERE `KOSTENKATEGORIE` LIKE '$kosten_kat'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='$kostenkat' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mietvertrag_id' && DETAIL_AKTUELL = '1' && DETAIL_NAME LIKE '%Kaution%' ORDER BY DETAIL_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->kautions_betrag = $row ['DETAIL_INHALT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE='Miete kalt'  ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM `MIETVERTRAG`
        \end_layout
            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        WHERE `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG_ID NOT IN (SELECT KOSTENTRAEGER_ID AS MIETVERTRAG_ID FROM GELD_KONTO_BUCHUNGEN WHERE GELDKONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='MIETVERTRAG')
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_ID ASC,`MIETVERTRAG`.`MIETVERTRAG_BIS`  ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR (`KOSTENTRAEGER_TYP` = 'Mietvertrag' AND `KOSTENTRAEGER_ID` = '$mv_id') OR (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE `GELDKONTO_ID` = '$gk_id' AND DATE_FORMAT( `DATUM` , '%Y-%m' ) = '$jahr-$monat' AND ((`KOSTENTRAEGER_TYP` = 'Einheit' AND `KOSTENTRAEGER_ID` = '$einheit_id') OR  (`KOSTENTRAEGER_TYP` = 'Eigentuemer' AND `KOSTENTRAEGER_ID` = '$et_id'))    AND `AKTUELL` = '1' ORDER BY DATUM";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        // echo "<br><br><br>SELECT MIETVERTRAG_ID FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS >= '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM MIETVERTRAG WHERE EINHEIT_ID = '$einheit_id' && MIETVERTRAG_AKTUELL = '1'  && MIETVERTRAG_VON<='$datum_bis' && ( MIETVERTRAG_BIS > '$datum_von' OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // Setzen von Mietvertrags Vars bzw Einzugsdatum Auszugsdatum
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON, MIETVERTRAG_BIS FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // Setzen von Mietvertrags Vars bzw Einzugsdatum Auszugsdatum
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl; // Anzahl aller Personen im MV
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // $this->get_einheit_info($row[EINHEIT_ID]);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY DATUM DESC LIMIT 0,$buchungsanzahl" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `GELD_KONTO_BUCHUNGEN` WHERE AKTUELL='1' && KOSTENTRAEGER_ID='$mietvertrag_id' && KOSTENTRAEGER_TYP='Mietvertrag' ORDER BY GELD_KONTO_BUCHUNGEN_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->insert_geldbuchung ( $geld_konto_id, '80001', $kontoauszugsnr, 'MIETE', $bemerkung, $buchungsdatum, 'Mietvertrag', $mietvertrag_id, $betrag, $mwst_anteil );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* Interne Buchung */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BUCHUNGSNUMMER FROM MIETE_ZAHLBETRAG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && AKTUELL = '1' ORDER BY BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BUCHUNGSNUMMER'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '$ueberschuss', '$buchungsnummer', '$_POST[KOSTENKATEGORIE]', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$betrag', '$buchungsnummer', 'Miete kalt - VV', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$mietvertrag_id - SALDO AUF KM GEBUCHT<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$betrag', '$buchungsnummer', 'Betriebskostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$betrag', '$buchungsnummer', 'Heizkostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$hk_betrag', '$buchungsnummer', 'Heizkostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', 'Betriebskostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', 'Betriebskostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$hk_betrag', '$buchungsnummer', '$hk_bezeichnung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', '$bk_bezeichnung', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', '$bk_bezeichnung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_forderung = $this->import_forderung_monatlich ( $mietvertrag_id, $monat, $jahr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$nebenkosten_vz', '$buchungsnummer', 'Nebenkosten Vorauszahlung111', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$heizkosten_vz', '$buchungsnummer', 'Heizkosten Vorauszahlung111', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$rest', '$buchungsnummer', 'Miete kalt REST', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$rest', '$buchungsnummer', 'Miete kalt ÜBERSCHUSS', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '-$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '$betrag', '$buchungsnummer', 'Miete kalt', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '-$value', '$buchungsnummer', '$key', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$this->datum_heute', '$diff', '$buchungsnummer', 'Miete kalt ', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MONATSABSCHLUSS VALUES (NULL, '$mietvertrag_id', '$datum', '$betrag', '1', NULL)";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        if (! $resultat) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && GELDKONTO_ID='$geldkonto_id' && AKTUELL = '1' ORDER BY DATUM ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && AKTUELL = '1' ORDER BY DATUM ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL = '1' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['DATUM'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%rate%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE NOT LIKE 'RATENZAHLUNG' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* echo "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'ORDER BY ANFANG ASC"; */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENTRAEGER_TYP='MIETVERTRAG' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* echo "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'ORDER BY ANFANG ASC"; */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%abrechnung%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '1' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $datum = explode ( "-", $row [ENDE] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE, BETRAG, KOSTENKATEGORIE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE, BETRAG, KOSTENKATEGORIE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_num_rows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '1' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y' ) >= '$jahr' && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' ) && DATE_FORMAT( ANFANG, '%Y' ) <= '$jahr' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $datum = explode ( "-", $row [ENDE] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'RATENZAHLUNG' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' && KOSTENKATEGORIE NOT LIKE '%energie%' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' && KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_MAHNUNG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Mahngebühr' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'  && KOSTENKATEGORIE='Mahngebühr' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_FORDERUNG, SUM(MWST_ANTEIL) AS MWST_ANTEIL FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1'  && KOSTENKATEGORIE NOT LIKE '%rate%' && KOSTENKATEGORIE NOT LIKE '%abrechnung%' &&  KOSTENKATEGORIE NOT LIKE '%mahngebühr%' && KOSTENKATEGORIE NOT LIKE 'Saldo Vortrag Vorverwaltung'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Betriebskostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Heizkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '%Wasserkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_BETRIEBSKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Betriebskostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_HEIZKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Heizkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) SUMME_WASSERKOSTEN FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE 'Wasserkostenabrechnung%'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM `MIETENTWICKLUNG` WHERE `KOSTENTRAEGER_TYP` = 'Mietvertrag'  AND `KOSTENTRAEGER_ID` ='$mietvertrag_id' AND `KOSTENKATEGORIE` =  'Betriebskosten Vorauszahlung'  AND `MIETENTWICKLUNG_AKTUELL` = '1'  ORDER BY ANFANG DESC LIMIT 0 , 1) <= '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG  FROM `MIETENTWICKLUNG` WHERE `KOSTENTRAEGER_TYP` = 'Mietvertrag'  AND `KOSTENTRAEGER_ID` ='$mietvertrag_id' AND `KOSTENKATEGORIE` =  'Heizkosten Vorauszahlung'  AND `MIETENTWICKLUNG_AKTUELL` = '1'  ORDER BY ANFANG DESC LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // if($mietvertrag_id=='1379'){
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Nebenkosten VZ - Anteilig' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE = 'Nebenkosten VZ - Anteilig' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG' OR KOSTENKATEGORIE LIKE 'Nebenkosten VZ - Anteilig') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MOD' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC<br>";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt' OR KOSTENKATEGORIE LIKE 'MHG') ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' &&  KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='80001' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $my_arr = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '" . $this->jahr_heute . "-" . $this->monat_heute . "'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM MIETE_ZAHLBETRAG WHERE KONTO='$objekt_kontonummer' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '" . $this->jahr_heute . "-" . $this->monat_heute . "'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM MIETE_ZAHLBETRAG WHERE AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '" . $this->jahr_heute . "-" . $this->monat_heute . "'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_ZAHLBETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_ZAHLBETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && KONTENRAHMEN_KONTO='$kostenkonto' && AKTUELL='1' && DATE_FORMAT(DATUM, '%Y-%m')<='$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' && BEMERKUNG NOT LIKE 'Saldo Vortrag Vorverwaltung' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK AS BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE  GELDKONTO_ID='$gk->geldkonto_id' $ko_string && KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( 'Kein Geldkonto für das Objekt hinterlegt' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK AS BEMERKUNG FROM GELD_KONTO_BUCHUNGEN && KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM GELD_KONTO_BUCHUNGEN WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_UEBERSCHUSS FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && KOSTENKATEGORIE='UEBERSCHUSS' && MIETBUCHUNGEN_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG AS SALDO_VORVERWALTUNG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENKATEGORIE = 'Saldo Vortrag Vorverwaltung' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG AS DATUM FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && KOSTENKATEGORIE = 'Saldo Vortrag Vorverwaltung' && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ENDE AS DATUM FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id'  && MIETENTWICKLUNG_AKTUELL = '1' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM MIETENTWICKLUNG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = "SELECT SUM(BETRAG) AS BETRAG FROM MIETE_ZAHLBETRAG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && AKTUELL = '1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat'";
        \end_layout
            \begin_layout Plain Layout
        $row1 = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row1 ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DISTINCT MIETBUCHUNGEN.MIETVERTRAG_ID, MIETBUCHUNGEN.DATUM, MIETBUCHUNGEN.KOSTENKATEGORIE, MIETBUCHUNGEN.BETRAG, MIETBUCHUNGEN.BUCHUNGSNUMMER, MIETE_ZAHLBETRAG.BETRAG AS ZAHLBETRAG, MIETE_ZAHLBETRAG.DATUM AS ZAHLDATUM
        \end_layout
            \begin_layout Plain Layout
        FROM MIETBUCHUNGEN, MIETE_ZAHLBETRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETBUCHUNGEN.MIETVERTRAG_ID = '$mietvertrag_id' && MIETBUCHUNGEN.MIETBUCHUNGEN_AKTUELL = '1' && MIETBUCHUNGEN.BUCHUNGSNUMMER = MIETE_ZAHLBETRAG.BUCHUNGSNUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BUCHUNGSNUMMER FROM MIETE_ZAHLBETRAG WHERE MIETVERTRAG_ID = '$mietvertrag_id' && AKTUELL = '1' ORDER BY BUCHUNGSNUMMER DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BUCHUNGSNUMMER'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, DATUM, KOSTENKATEGORIE, BETRAG FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL = '1' && DATUM BETWEEN '$von_datum' AND '$bis_datum' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $buchungen_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, KOSTENKATEGORIE, SUM(BETRAG) AS GESAMT_BETRAG FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL = '1' && DATUM BETWEEN '$von_datum' AND '$bis_datum' GROUP BY KOSTENKATEGORIE ORDER BY GESAMT_BETRAG DESC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $buchungen_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, DATUM, KOSTENKATEGORIE, BETRAG FROM MIETBUCHUNGEN WHERE MIETVERTRAG_ID='$mietvertrag_id' && MIETBUCHUNGEN_AKTUELL = '1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_BIS>='$this->datum_heute' OR MIETVERTRAG_BIS='0000-00-00' && MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $mv_arr [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM FROM MIETE_ZAHLBETRAG WHERE BEMERKUNG = 'Saldo Vortrag Vorverwaltung' && MIETVERTRAG_ID ='$mietvertrag_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['DATUM'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT EINHEIT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m-%d' ) <= '$datum' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m-%d' ) >= '$datum'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ( SELECT sum(BETRAG) FROM MIETE_ZAHLBETRAG WHERE MIETVERTRAG_ID='$mietvertrag_id' ) AS ZB,  ( SELECT sum(BETRAG) FROM MIETBUCHUNGEN WHERE  MIETVERTRAG_ID='$mietvertrag_id' ) AS INTERN" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return $my_array;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, ENDE, KOSTENKATEGORIE, BETRAG FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM GELD_KONTO_BUCHUNGEN WHERE AKTUELL='1' && KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%' && KOSTENKATEGORIE NOT LIKE 'Kaltwasserabr%' ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietzeit_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENKATEGORIE, BETRAG * MJESECI AS GESAMT FROM (SELECT KOSTENKATEGORIE, BETRAG, ANFANG, ENDE, IF( ENDE = '0000-00-00' OR ENDE >= '$curdate', '$curdate', ENDE ) AS NEW_ENDE, IF( ENDE <= '$curdate' && ENDE != '0000-00-00', period_diff( concat( year( ENDE ) , if( month( ENDE ) <10, '0', '' ) , month( ENDE ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ), month( ANFANG ) ) ) +1, period_diff( concat( year( '$curdate' ) , if( month( '$curdate' ) <10, '0', '' ) , month( '$curdate' ) ) , concat( year( ANFANG ) , if( month( ANFANG ) <10, '0', '' ) , month( ANFANG ) ) ) +1 ) AS MJESECI FROM MIETENTWICKLUNG WHERE MIETENTWICKLUNG_AKTUELL = '1' && `KOSTENTRAEGER_TYP` = 'MIETVERTRAG' && `KOSTENTRAEGER_ID` = '$mv_id' && ANFANG<='$curdate' && KOSTENKATEGORIE !='Ratenzahlung' && KOSTENKATEGORIE NOT LIKE 'Mahngeb%' && KOSTENKATEGORIE NOT LIKE 'Kaltwasserabrechnung%' ORDER BY `MJESECI` ASC) AS t1 ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && (KOSTENKATEGORIE LIKE 'Miete kalt%' or KOSTENKATEGORIE LIKE 'MHG%') ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->erhoehungsbetrag = $row ['BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat') && DATE_FORMAT( ANFANG, '%Y-%m' ) >= '$jahr-$monat'  && (KOSTENKATEGORIE LIKE 'MHG' or KOSTENKATEGORIE LIKE 'Miete kalt') ORDER BY ANFANG ASC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETENTWICKLUNG` WHERE `KOSTENKATEGORIE` LIKE 'MOD' AND KOSTENTRAEGER_TYP='MIETVERTRAG' AND KOSTENTRAEGER_ID='$mv_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 1,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        if (! $numrows1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "SELECT ANFANG, BETRAG FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && KOSTENKATEGORIE LIKE 'Miete kalt' ORDER BY ANFANG ASC LIMIT 1,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        $row1 = mysql_fetch_assoc ( $result1 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME_RATE FROM MIETENTWICKLUNG WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID = '$mietvertrag_id' && MIETENTWICKLUNG_AKTUELL = '1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKATEGORIE LIKE '$kostenkat' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $summe = $row ['SUMME_RATE'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `MIETER_MAHNLISTEN`  WHERE DATUM='$datum' && MIETVERTRAG_ID='$mietvertrag_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SALDO FROM `MIETER_MAHNLISTEN`  WHERE DATUM='$datum' && MIETVERTRAG_ID='$mietvertrag_id' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZAHLUNGSFRIST_M, SALDO, MAHN_GEB  FROM `MIETER_MAHNLISTEN` WHERE MIETVERTRAG_ID='$mietvertrag_id' && ZAHLUNGSFRIST_M!='0000-00-00' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_zahlungsfrist_z($mv_id, $datum, $saldo) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_Z='$datum' WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' && ZAHLUNGSFRIST_Z='0000-00-00'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_Z='$datum' WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' && ZAHLUNGSFRIST_Z='0000-00-00'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_zahlungsfrist_m($mv_id, $datum, $saldo, $mahn_geb) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_M='$datum', MAHN_GEB='$mahn_geb'  WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETER_MAHNLISTEN SET ZAHLUNGSFRIST_M='$datum', MAHN_GEB='$mahn_geb'  WHERE MIETVERTRAG_ID='$mv_id' && SALDO='$saldo' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZAHLUNGSFRIST_Z, SALDO  FROM `MIETER_MAHNLISTEN` WHERE MIETVERTRAG_ID='$mietvertrag_id' && ZAHLUNGSFRIST_Z!='0000-00-00' ORDER BY DATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        WHERE MIETVERTRAG_AKTUELL = '1' && ( MIETVERTRAG_BIS > CURdate( )
        \end_layout
            \begin_layout Plain Layout
        OR MIETVERTRAG_BIS = '0000-00-00' ) ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG  LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'  && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID) LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'   ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
MOB_ZE_PROTOKOLL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MOB_ZE_PROTOKOLL` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KW` int(2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROJ_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `T_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `START` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `END` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',

\end_layout
\begin_layout Plain Layout

  `ABNAHME` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGENOMMEN` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=72 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
KW 
\end_layout
\begin_layout Description
PROJ_ID 
\end_layout
\begin_layout Description
T_ID 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
START 
\end_layout
\begin_layout Description
END 
\end_layout
\begin_layout Description
ABNAHME 
\end_layout
\begin_layout Description
ABGENOMMEN 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
MONATSABSCHLUSS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MONATSABSCHLUSS` (

\end_layout
\begin_layout Plain Layout

  `ABSCHLUSS_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ABSCHLUSS_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=182 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ABSCHLUSS_DAT 
\end_layout
\begin_layout Description
MIETVERTRAG_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
timestamp 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MONATSABSCHLUSS VALUES (NULL, '$mietvertrag_id', '$datum', '$betrag', '1', NULL)";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        if (! $resultat) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
MS_SONDERMERKMALE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `MS_SONDERMERKMALE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `JAHR` varchar(4) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ORT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MERKMAL` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WERT` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `A_KLASSE` int(2) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
JAHR 
\end_layout
\begin_layout Description
ORT 
\end_layout
\begin_layout Description
MERKMAL 
\end_layout
\begin_layout Description
WERT 
\end_layout
\begin_layout Description
A_KLASSE 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `MS_SONDERMERKMALE` WHERE JAHR='$jahr' && ORT='' ORDER BY A_KLASSE ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `MS_SONDERMERKMALE` WHERE JAHR='$jahr' && ORT='$ort' ORDER BY A_KLASSE ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `MS_SONDERMERKMALE` WHERE JAHR='$jahr' && ORT='$ort' ORDER BY A_KLASSE ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `MS_SONDERMERKMALE` GROUP BY MERKMAL ORDER BY MERKMAL ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MS_SONDERMERKMALE VALUES (NULL, '$jahr', '', '$merkmal', '$betrag', '$klasse')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MS_SONDERMERKMALE VALUES (NULL, '$jahr', '$ort', '$merkmal', '$betrag', '$klasse')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietspiegel.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM MS_SONDERMERKMALE WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MERKMAL, WERT, A_KLASSE FROM `MS_SONDERMERKMALE` WHERE (A_KLASSE IS NULL OR A_KLASSE='$a_klasse') && JAHR='$jahr' ORDER BY A_KLASSE ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $my_arr = Array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
OBJEKT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `OBJEKT` (

\end_layout
\begin_layout Plain Layout

  `OBJEKT_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_KURZNAME` varchar(20) CHARACTER SET latin1 COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EIGENTUEMER_PARTNER` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  UNIQUE KEY `OBJEKT_DAT` (`OBJEKT_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `OBJEKT_KURZNAME` (`OBJEKT_KURZNAME`),

\end_layout
\begin_layout Plain Layout

  KEY `OBJEKT_ID` (`OBJEKT_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=178 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
OBJEKT_DAT 
\end_layout
\begin_layout Description
OBJEKT_ID 
\end_layout
\begin_layout Description
OBJEKT_AKTUELL 
\end_layout
\begin_layout Description
OBJEKT_KURZNAME 
\end_layout
\begin_layout Description
EIGENTUEMER_PARTNER 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, OBJEKT_ID FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, OBJEKT_ID FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, OBJEKT_ID FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID, EINHEIT_KURZNAME, HAUS.OBJEKT_ID AS OBJEKT_ID
        \end_layout
            \begin_layout Plain Layout
        FROM  `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_select_db ( DB_NAME );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_wp_vorjahr_wert($objekt_id, $vorjahr, $kostenkonto) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PLAN_ID FROM WEG_WPLAN WHERE AKTUELL='1' && JAHR='$vorjahr' && OBJEKT_ID='$objekt_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' && OBJEKT_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (! isset ( $_REQUEST [einheit_update] )) {
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( haus_in_db, NULL ); // name, action
        \end_layout
            \begin_layout Plain Layout
        $objekt_kurzname = objekt_kurzname ( $_POST ["objekt_id"] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $submit_update_objekt = $_REQUEST ["submit_update_objekt"];
        \end_layout
            \begin_layout Plain Layout
        $neu_objekt_kurzname = $_REQUEST ["objekt_kurzname"];
        \end_layout
            \begin_layout Plain Layout
        $neu_objekt_kurzname = trim ( $neu_objekt_kurzname );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (isset ( $submit_update_objekt )) {
        \end_layout
            \begin_layout Plain Layout
        if ($neu_objekt_kurzname != '') {
        \end_layout
            \begin_layout Plain Layout
        echo "$neu_objekt_kurzname $objekt_dat";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        if (! isset ( $submit_update_objekt )) {
        \end_layout
            \begin_layout Plain Layout
        objekt_zum_aendern_holen ( $obj_id );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        objekt_update_kurzname ( $objekt_dat, $obj_id, $neu_objekt_kurzname );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "objekt_kurzname wurde in $neu_objekt_kurzname umbenannt." );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten ( "?daten=objekte_raus&objekte_raus=objekte_kurz" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<div class=\"tabelle_objekte\"><table>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        case "einheit_update" :
        \end_layout
            \begin_layout Plain Layout
        iframe_start ();
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Objekt: $objekt_kurzname" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<b>Objekt auswählen:</b><br>\n ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    form_einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "UPDATE....";
        \end_layout
            \begin_layout Plain Layout
        // $ma->update_wohnlage($_SESSION['objekt_id']);
        \end_layout
            \begin_layout Plain Layout
        $ma->update_klassen ( $_SESSION ['objekt_id'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $ma->update_klassen ( $_SESSION ['objekt_id'] );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        fehlermeldung_ausgeben ( "Objekt wählen!!!" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<hr>SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_QM, EINHEIT_LAGE, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<b>Objekt auswählen:</b><br>\n ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(HAUS_QM) AS SUMME FROM HAUS WHERE OBJEKT_ID='$objekt_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    objekte.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(HAUS_QM) AS SUMME FROM HAUS WHERE OBJEKT_ID='$objekt_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $SUMME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$letzte_belegnr', '$pos','$menge', '$netto_betrag', '$g_netto', '19', '0', '0', '$kostenkonto', 'Objekt', '$_SESSION[objekt_id]', '$datum', '$jahr', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    einheit.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_QM FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $title = "Alle Häuser";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_QM FROM HAUS where OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE, 0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $objekt_kurzname = objekt_namen_by_id ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        $title = "Häuser vom Objekt:  $objekt_kurzname";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT where OBJEKT_ID='$objekt_id' && OBJEKT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT FROM OBJEKT ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_ID='$obj_id' && OBJEKT_AKTUELL='1' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_ID='$OBJEKT_ID' && OBJEKT_AKTUELL='1' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat1 ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID FROM HAUS where OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $haus_ids = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT FROM OBJEKT WHERE OBJEKT_ID='$objekt_id' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_DAT='$objekt_dat' && OBJEKT_AKTUELL='1' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_KURZNAME LIKE '$kurzname' && OBJEKT_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_ID FROM OBJEKT ORDER BY OBJEKT_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT ORDER BY OBJEKT_ID WHERE OBJEKT_KURZNAME='$kurzname' && OBJEKT_AKTUELL=1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO OBJEKT (OBJEKT_DAT, OBJEKT_ID, OBJEKT_AKTUELL, OBJEKT_KURZNAME, EIGENTUEMER_PARTNER) VALUES (NULL,'$letzte_obj_id','1', '$objekt_kurzname', '$eigentuemer')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT, $OBJEKT_ID, $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_AKTUELL, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_ID='$obj_id' ORDER BY OBJEKT_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        erstelle_formular ( NULL, NULL );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        erstelle_submit_button ( "submit_update_objekt", "Ändern" );
        \end_layout
            \begin_layout Plain Layout
        ende_formular ();
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function objekt_update_kurzname($obj_dat, $obj_id, $obj_kurzname) {
        \end_layout
            \begin_layout Plain Layout
        $obj_kurzname = trim ( $obj_kurzname );
        \end_layout
            \begin_layout Plain Layout
        if ($obj_kurzname != '') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE OBJEKT SET OBJEKT_AKTUELL='0' WHERE OBJEKT_DAT='$obj_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO OBJEKT (OBJEKT_DAT, OBJEKT_ID, OBJEKT_AKTUELL, OBJEKT_KURZNAME) VALUES (NULL,'$obj_id','1', '$obj_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO OBJEKT (OBJEKT_DAT, OBJEKT_ID, OBJEKT_AKTUELL, OBJEKT_KURZNAME) VALUES (NULL,'$obj_id','1', '$obj_kurzname')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE OBJEKT SET OBJEKT_AKTUELL='0' WHERE OBJEKT_DAT='$obj_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( "OBJECT", $obj_dat, $obj_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<b>Objekt auswählen:</b><br>\n ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"haus_objekt\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_DAT, $OBJEKT_ID, $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\">$OBJEKT_KURZNAME</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr><td>Detailzugehörigkeit:</td><td> <select name=\"bereich_kategorie\" size=\"1\">\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"OBJEKT\">OBJEKT</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"HAUS\">HAUS</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<b>Objekt auswählen:</b><br>\n ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_DAT, OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<b>Objekt auswählen:</b><br>\n ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, OBJEKT_ID FROM HAUS WHERE HAUS_ID='$haus_id' && HAUS_AKTUELL='1' ORDER BY HAUS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS (HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, HAUS_AKTUELL, OBJEKT_ID) VALUES (NULL,'$haus_id','$strasse', '$nummer', '$stadt', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS (HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_STADT, HAUS_PLZ, HAUS_QM, HAUS_AKTUELL, OBJEKT_ID) VALUES (NULL, '$haus_id', '$strasse', '$nummer', '$stadt', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$obj_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_DAT, HAUS_ID, HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    haus_form_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_STRASSE, HAUS_NUMMER FROM HAUS WHERE OBJEKT_ID='$objekt_id' && HAUS_AKTUELL='1' ORDER BY HAUS_NUMMER ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, EINHEIT.TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE OBJEKT.OBJEKT_ID='$objekt_id' && `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_STRASSE FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' GROUP BY HAUS_STRASSE" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO OBJEKT VALUES(NULL, '$last_id', '1', '$objekt_kurzname','$eigentuemer_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'OBJEKT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE OBJEKT SET OBJEKT_AKTUELL='0' WHERE OBJEKT_DAT='$objekt_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO OBJEKT VALUES(NULL, '$objekt_id', '1', '$objekt_kurzname','$eigentuemer_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'OBJEKT', $last_dat, $objekt_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY OBJEKT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_name = $row ['OBJEKT_KURZNAME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EIGENTUEMER_PARTNER FROM OBJEKT WHERE OBJEKT_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY OBJEKT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_eigentuemer_partner_id = $row ['EIGENTUEMER_PARTNER'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `OBJEKT` WHERE OBJEKT_ID = '$objekt_id' && OBJEKT_AKTUELL = '1' ORDER BY OBJEKT_DAT DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_dat = $row ['OBJEKT_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DETAIL_INHALT FROM `DETAIL` WHERE DETAIL_NAME = 'Geld Konto Nummer' && DETAIL_ZUORDNUNG_TABELLE = 'OBJEKT' && DETAIL_ZUORDNUNG_ID = '$objekt_id' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_kontonummer = $row ['DETAIL_INHALT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_ID FROM OBJEKT WHERE OBJEKT_AKTUELL='1' && OBJEKT_KURZNAME='$objekt_name' ORDER BY OBJEKT_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // print_r($row);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_haeuser = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $objekte_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_ID, OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $objekte_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"$name\" size=1 id=\"$id\">\n";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $objekte_arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $objekt_name = $objekte_arr [$a] ['OBJEKT_KURZNAME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$objekt_id\" selected>$objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$objekt_id\">$objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function dropdown_haeuser_objekt($objekt_id, $label, $name, $id, $vorwahl = '') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function liste_haeuser_objekt($objekt_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER DESC LIMIT $this->start,$this->zeilen_pro_seite;" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $haeuser_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT HAUS_ID FROM HAUS WHERE HAUS_AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY HAUS_STRASSE, HAUS_NUMMER ASC;" );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_haeuser = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->seiten_anzahl = ceil ( $this->anzahl_haeuser / $this->zeilen_pro_seite );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, SUM(EINHEIT_QM) AS GESAMT_QM FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' ) WHERE EINHEIT_AKTUELL='1'  && EINHEIT.TYP = 'Gewerbe' GROUP BY OBJEKT.OBJEKT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ, HAUS_STADT, TYP FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (HAUS, OBJEKT) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && OBJEKT.OBJEKT_ID = '$objekt_id' )
        \end_layout
            \begin_layout Plain Layout
        WHERE EINHEIT_AKTUELL='1' GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS VALUES(NULL, '$last_id', '$strasse', '$haus_nr','$ort', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO HAUS VALUES(NULL, '$haus_id', '$strasse', '$haus_nr','$ort', '$plz', '$qm', '1', '$objekt_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$haus_str $haus_nr $hh->objekt_name</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, `TYP` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY HAUS_STRASSE, HAUS_NUMMER, OBJEKT_KURZNAME, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` ,EINHEIT_ID,  `EINHEIT_LAGE` , `EINHEIT_QM`, TYP FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, EINHEIT_LAGE";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID, PARTNER_NAME, COUNT(BELEG_NR) AS BELEGE FROM PARTNER_LIEFERANT JOIN RECHNUNGEN ON(PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.AUSSTELLER_ID OR PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.EMPFAENGER_ID) WHERE PARTNER_LIEFERANT.AKTUELL = '1'  && RECHNUNGEN.AKTUELL = '1' GROUP BY PARTNER_ID ORDER BY COUNT(BELEG_NR)  DESC, PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<p class=\"objekt_auswahl\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<select name=\"kosten_traeger_typ\" size=1>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Objekt\">Objekt</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Haus\">Haus</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, EINHEIT.HAUS_ID, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN ( HAUS, OBJEKT ) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID) WHERE EINHEIT.EINHEIT_AKTUELL='1' && HAUS.HAUS_AKTUELL='1' && EINHEIT.HAUS_ID = '$haus_id' && (TYP='Wohnraum' OR TYP='Gewerbe') && EINHEIT_ID NOT IN ( SELECT EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' && DATE_FORMAT( MIETVERTRAG_VON, '%Y-%m' ) <= '$jahr_monat' && ( DATE_FORMAT( MIETVERTRAG_BIS, '%Y-%m' ) >= '$jahr_monat' OR MIETVERTRAG_BIS = '0000-00-00' ) ) ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<SELECT SIZE=\"10\" NAME=\"IMPORT_AUS\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anzahl; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $objekt_n = $o_array [$a] [OBJEKT_KURZNAME];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT JOIN HAUS ON(HAUS.HAUS_ID=EINHEIT.HAUS_ID) JOIN OBJEKT ON(HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME FROM OBJEKT WHERE OBJEKT_AKTUELL='1' && OBJEKT_ID = '$id' order by OBJEKT_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $OBJEKT_KURZNAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_VON, MIETVERTRAG_BIS, MIETVERTRAG_DAT, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, OBJEKT.OBJEKT_ID, OBJEKT_KURZNAME, HAUS.HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, HAUS_PLZ,HAUS_STADT FROM MIETVERTRAG RIGHT JOIN(EINHEIT,HAUS,OBJEKT) ON (MIETVERTRAG.EINHEIT_ID = EINHEIT.EINHEIT_ID && EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL='1' && EINHEIT_AKTUELL='1' &&  HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_ID='$mietvertrag_id'  ORDER BY MIETVERTRAG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `MIETVERTRAG` WHERE (MIETVERTRAG_VON<='$datum_bis' && (MIETVERTRAG_BIS='0000-00-00' OR (MIETVERTRAG_BIS >= '$datum_von'))) && `MIETVERTRAG_AKTUELL` = '1' && MIETVERTRAG.EINHEIT_ID IN (SELECT EINHEIT_ID FROM EINHEIT, HAUS, OBJEKT WHERE EINHEIT.HAUS_ID=HAUS.HAUS_ID && HAUS.OBJEKT_ID='$objekt_id' && EINHEIT.EINHEIT_AKTUELL='1') ORDER BY EINHEIT_ID, MIETVERTRAG_VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_ME($objekt_id, $datum_von, $datum_bis) {
        \end_layout
            \begin_layout Plain Layout
        echo "VARS: $objekt_id, $datum_von, $datum_bis";
        \end_layout
            \begin_layout Plain Layout
        $arr = $this->mv_arr_zeitraum ( $objekt_id, $datum_von, $datum_bis );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(EINHEIT_QM) AS QM FROM `EINHEIT` RIGHT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->objekt_schluessel = $row [QM];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT_LAGE, EINHEIT_QM,  HAUS_STRASSE, HAUS_NUMMER
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '', '', '$leistung_id', '$dauer_min', 'Objekt', '1','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\" size=1 $js_action>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"\">Bitte wählen</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Objekt\">Objekt</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\" size=1 $js_action>\n";
        \end_layout
            \begin_layout Plain Layout
        $arr [0] ['typ'] = 'Objekt';
        \end_layout
            \begin_layout Plain Layout
        $arr [0] ['bez'] = 'Objekt';
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\" size=1 $js_action>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"\">Bitte wählen</option>\n";
        \end_layout
            \begin_layout Plain Layout
        if ($typ == 'Objekt') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, OBJEKT_ID FROM OBJEKT WHERE OBJEKT_AKTUELL='1' ORDER BY OBJEKT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\" selected>$OBJEKT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\">$OBJEKT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\" selected>$OBJEKT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$OBJEKT_ID\">$OBJEKT_KURZNAME</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT HAUS_ID, HAUS_STRASSE, HAUS_NUMMER, OBJEKT_ID FROM HAUS WHERE HAUS_AKTUELL='1' ORDER BY HAUS_STRASSE,  0+HAUS_NUMMER, OBJEKT_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\" selected>$h->haus_strasse $h->haus_nummer - $h->objekt_name</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$haus_id\">$h->haus_strasse $h->haus_nummer - $h->objekt_name</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  HAUS.OBJEKT_ID, OBJEKT_KURZNAME, MIETVERTRAG.EINHEIT_ID, EINHEIT_KURZNAME, MIETVERTRAG_ID FROM `EINHEIT` RIGHT JOIN (HAUS, OBJEKT, MIETVERTRAG) ON ( EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID = OBJEKT.OBJEKT_ID && EINHEIT.EINHEIT_ID=MIETVERTRAG.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        WHERE  HAUS_AKTUELL='1' && EINHEIT_AKTUELL='1' && OBJEKT_AKTUELL='1' && MIETVERTRAG_AKTUELL='1' GROUP BY MIETVERTRAG_ID ORDER BY LPAD(EINHEIT_KURZNAME, LENGTH(EINHEIT_KURZNAME), '1') ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz_gk = count ( $gk_arr_objekt );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_objekt_arr_gk($gk_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_ID  FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$gk_id' && KOSTENTRAEGER_TYP='Objekt'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `OBJEKT` WHERE `OBJEKT_ID`=$objekt_id && OBJEKT_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function dropdown_et_vorwahl($vorwahl_et_id, $objekt_id, $label, $name, $id, $js = '') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENTRAEGER_ID FROM  GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KOSTENTRAEGER_ID FROM GELD_KONTEN_ZUWEISUNG WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='Objekt' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KASSEN_ID, KASSEN_NAME, KASSEN_VERWALTER FROM `KASSEN` WHERE AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<p class=\"objekt_auswahl\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT OBJEKT_KURZNAME, HAUS_STRASSE, HAUS_NUMMER, `EINHEIT_KURZNAME` , `EINHEIT_ID`,  ltrim(rtrim(EINHEIT_LAGE)) AS EINHEIT_LAGE, `EINHEIT_QM` FROM EINHEIT , HAUS, OBJEKT
        \end_layout
            \begin_layout Plain Layout
        WHERE `EINHEIT_AKTUELL` = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID && HAUS_AKTUELL='1' && OBJEKT_AKTUELL='1' && OBJEKT.OBJEKT_ID='$objekt_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY EINHEIT_KURZNAME";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO REPORT_PROFILE VALUES (NULL, '$last_id', '$kurz_b', '$objekt_id', '$gk_id', '$p_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *
        \end_layout
            \begin_layout Plain Layout
        FROM MIETE_ZAHLBETRAG WHERE AKTUELL = '1' && KONTO='$objekt_kontonummer' && DATUM >= DATE_SUB( DATE_FORMAT( CURDATE( ) , '%Y-%m-1' ) , INTERVAL 1 MONTH )
        \end_layout
            \begin_layout Plain Layout
        ORDER BY BUCHUNGSNUMMER DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM `MIETE_ZAHLBETRAG` WHERE AKTUELL='1' && KONTO='$objekt_kontonummer' ORDER BY BUCHUNGSNUMMER DESC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "KN OK";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, MIETVERTRAG_ID, BEMERKUNG FROM MIETE_ZAHLBETRAG WHERE KONTO='$objekt_kontonummer' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '" . $this->jahr_heute . "-" . $this->monat_heute . "'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATUM, BETRAG, VERWENDUNGSZWECK AS BEMERKUNG FROM GELD_KONTO_BUCHUNGEN WHERE  GELDKONTO_ID='$gk->geldkonto_id' $ko_string && KOSTENTRAEGER_TYP='Mietvertrag' && KOSTENTRAEGER_ID='$mietvertrag_id' && AKTUELL='1' && DATE_FORMAT( DATUM, '%Y-%m' ) = '$jahr-$monat' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( 'Kein Geldkonto für das Objekt hinterlegt' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_leerstand.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT OBJEKT_KURZNAME, EINHEIT_ID, EINHEIT_KURZNAME,  EINHEIT_QM,  EINHEIT.HAUS_ID,  CONCAT(HAUS_STRASSE, HAUS_NUMMER) AS HAUS_STRASSE,  EINHEIT_QM, TRIM(EINHEIT_LAGE) AS EINHEIT_LAGE, EINHEIT.TYP
        \end_layout
            \begin_layout Plain Layout
        FROM `EINHEIT`
        \end_layout
            \begin_layout Plain Layout
        RIGHT JOIN (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"weg_objekte\">$label</label>\n<select name=\"$name\" id=\"$id\" size=\"1\" >\n";
        \end_layout
            \begin_layout Plain Layout
        $anz = count ( $arr );
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < $anz; $a ++) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$objekt_id\" selected>$o->objekt_kurzname</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$objekt_id\" >$o->objekt_kurzname</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "Keine WEG-Objekte verfügbar";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( 'Keine Einheiten im Objekt' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN WHERE AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY JAHR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( "Keine Wirtschaftspläne für das Objekt $e->objekt_kurzname" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$plan_id\" selected>WP $jahr $o->objekt_name ($plan_id.)</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$plan_id\">WP $jahr $o->objekt_name ($plan_id.)</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ( "Keine Wirtschaftspläne für das Objekt $e->objekt_kurzname" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WPLAN VALUES (NULL, '$id', '$wjahr', '$objekt_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PLAN_ID FROM WEG_WPLAN WHERE AKTUELL='1' && JAHR='$wjahr' && OBJEKT_ID='$objekt_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$profil_id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_klassen($objekt_id) {
        \end_layout
            \begin_layout Plain Layout
        echo "UPDATE AK4 für OBJEKT $objekt_id<br>";
        \end_layout
            \begin_layout Plain Layout
        $o = new objekt ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "UPDATE AK4 für OBJEKT $objekt_id<br>";
        \end_layout
            \begin_layout Plain Layout
        $o = new objekt ();
        \end_layout
            \begin_layout Plain Layout
        $einheiten_arr = $o->einheiten_objekt_arr ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietanpassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_wohnlage($objekt_id) {
        \end_layout
            \begin_layout Plain Layout
        $o = new objekt ();
        \end_layout
            \begin_layout Plain Layout
        $haus_arr = $o->haeuser_objekt_in_arr ( $objekt_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID FROM MIETVERTRAG
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG  LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID)
        \end_layout
            \begin_layout Plain Layout
        LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'  && MIETVERTRAG_BIS < CURdate() && MIETVERTRAG_BIS != '0000-00-00' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT.EINHEIT_ID, HAUS.HAUS_ID, OBJEKT.OBJEKT_ID  FROM MIETVERTRAG LEFT JOIN EINHEIT ON (MIETVERTRAG.EINHEIT_ID=EINHEIT.EINHEIT_ID) LEFT JOIN HAUS ON (EINHEIT.HAUS_ID=HAUS.HAUS_ID) LEFT JOIN OBJEKT ON (HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE MIETVERTRAG_AKTUELL = '1' && EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && OBJEKT_AKTUELL = '1'  && OBJEKT.OBJEKT_ID='$objekt_id'   ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MIETVERTRAG_ID, EINHEIT_ID FROM MIETVERTRAG WHERE MIETVERTRAG_AKTUELL = '1' ORDER BY EINHEIT_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
OBJEKT_PARTNER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `OBJEKT_PARTNER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(6) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `OBJEKT_ID` (`OBJEKT_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `PARTNER_ID` (`PARTNER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
OBJEKT_ID 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
PARTNER_LIEFERANT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PARTNER_LIEFERANT` (

\end_layout
\begin_layout Plain Layout

  `PARTNER_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_NAME` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STRASSE` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NUMMER` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLZ` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ORT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LAND` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PARTNER_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `PARTNER_ID` (`PARTNER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `STRASSE` (`STRASSE`),

\end_layout
\begin_layout Plain Layout

  KEY `NUMMER` (`NUMMER`),

\end_layout
\begin_layout Plain Layout

  KEY `PLZ` (`PLZ`),

\end_layout
\begin_layout Plain Layout

  KEY `ORT` (`ORT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2219 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PARTNER_DAT 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
PARTNER_NAME 
\end_layout
\begin_layout Description
STRASSE 
\end_layout
\begin_layout Description
NUMMER 
\end_layout
\begin_layout Description
PLZ 
\end_layout
\begin_layout Description
ORT 
\end_layout
\begin_layout Description
LAND 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PARTNER_NAME, PARTNER_ID, STRASSE, NUMMER, PLZ, ORT, LAND FROM PARTNER_LIEFERANT WHERE AKTUELL='1' && PARTNER_NAME LIKE '%$suchstring%' ORDER BY PARTNER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PARTNER_NAME, PARTNER_ID FROM PARTNER_LIEFERANT WHERE AKTUELL='1' ORDER BY PARTNER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PARTNER_NAME, $PARTNER_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE AKTUELL='1' ORDER BY PARTNER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PARTNER_NAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE AKTUELL='1' && PARTNER_ID='$id' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PARTNER_NAME ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE PARTNER_NAME = '$clean_arr[partnername]' && STRASSE='$clean_arr[strasse]' && NUMMER='$clean_arr[hausnummer]' && PLZ='$clean_arr[plz]' && AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID FROM PARTNER_LIEFERANT  ORDER BY PARTNER_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['PARTNER_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE AKTUELL = '1' ORDER BY PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1' ORDER BY PARTNER_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID FROM PARTNER_LIEFERANT WHERE REPLACE(PARTNER_NAME, '<br>', '') ='$partner_name' && AKTUELL = '1' ORDER BY PARTNER_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID, PARTNER_NAME, COUNT(BELEG_NR) AS BELEGE FROM PARTNER_LIEFERANT JOIN RECHNUNGEN ON(PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.AUSSTELLER_ID OR PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.EMPFAENGER_ID) WHERE PARTNER_LIEFERANT.AKTUELL = '1'  && RECHNUNGEN.AKTUELL = '1' GROUP BY PARTNER_ID ORDER BY COUNT(BELEG_NR)  DESC, PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<p class=\"objekt_auswahl\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['PARTNER_NAME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE='PARTNER_LIEFERANT' && DETAIL_NAME='Mandanten-Nr' && DETAIL_ZUORDNUNG_ID='$partner_id' && DETAIL_AKTUELL='1' ORDER BY DETAIL_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['PARTNER_NAME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME, STRASSE, NUMMER, PLZ, ORT FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // return
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PARTNER_NAME, PARTNER_ID FROM PARTNER_LIEFERANT WHERE AKTUELL='1' ORDER BY PARTNER_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PARTNER_NAME, $PARTNER_ID ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT (SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID=W_GERAETE.KOSTENTRAEGER_ID && AKTUELL='1' ORDER BY PARTNER_DAT DESC LIMIT 0,1) AS PART, `GERAETE_ID`, LAGE_RAUM AS EINBAUORT, HERSTELLER, BEZEICHNUNG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, `INTERVAL_M`, DATE_FORMAT(NOW(),'%Y-%m-%d') as HEUTE, DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -INTERVAL_M MONTH),'%Y-%m-%d') AS L_WART_FAELLIG, (SELECT DATUM FROM GEO_TERMINE WHERE GERAETE_ID=W_GERAETE.GERAETE_ID && AKTUELL='1' ORDER BY DATUM DESC LIMIT 0,1) AS L_WART FROM `W_GERAETE` WHERE `AKTUELL`='1' && GRUPPE_ID='$gruppen_id' && `KOSTENTRAEGER_TYP`='Partner' && (`KOSTENTRAEGER_ID`='3' or `KOSTENTRAEGER_ID`='947' or `KOSTENTRAEGER_ID`='986' or `KOSTENTRAEGER_ID`='661' or `KOSTENTRAEGER_ID`='1148' or `KOSTENTRAEGER_ID`='974') &&
        \end_layout
            \begin_layout Plain Layout
        GERAETE_ID NOT IN
        \end_layout
            \begin_layout Plain Layout
        (SELECT GERAETE_ID FROM GEO_TERMINE WHERE AKTUELL='1' && (DATUM>=DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -(INTERVAL_M-$monate_plus_int) MONTH),'%Y-%m-%d') AND DATUM <= DATE_FORMAT(NOW(),'%Y-%m-%d')) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID, PARTNER_NAME FROM PARTNER_LIEFERANT WHERE AKTUELL='1' ORDER BY PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        $p_id = $row ['PARTNER_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `PARTNER_LIEFERANT` WHERE  `AKTUELL` =  '1' AND  `PARTNER_NAME` LIKE  '%$suchtext%'
        \end_layout
            \begin_layout Plain Layout
        OR  `STRASSE` LIKE  '%$suchtext%'
        \end_layout
            \begin_layout Plain Layout
        OR  `PLZ` LIKE  '%$suchtext%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID FROM PARTNER_LIEFERANT WHERE PARTNER_NAME='$partner_name' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->partner_id = $row ['PARTNER_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM PARTNER_LIEFERANT WHERE PARTNER_ID='$partner_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE PARTNER_NAME = '$clean_arr[partnername]' && STRASSE='$clean_arr[strasse]' && NUMMER='$clean_arr[hausnummer]' && PLZ='$clean_arr[plz]' && AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID FROM PARTNER_LIEFERANT  ORDER BY PARTNER_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['PARTNER_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE AKTUELL = '1' ORDER BY PARTNER_NAME" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PARTNER_LIEFERANT WHERE AKTUELL = '1' ORDER BY PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PARTNER_LIEFERANT SET AKTUELL='0' WHERE PARTNER_DAT='$partner_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES(NULL, '$partner_id', '$partnername', '$strasse', '$hausnummer', '$plz', '$ort', '$land', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, $partner_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PARTNER_STICHWORT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PARTNER_STICHWORT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PARTNER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STICHWORT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=85 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
PARTNER_ID 
\end_layout
\begin_layout Description
STICHWORT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_STICHWORT VALUES (NULL, '$id', '$partner_id', '$stichwort',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_STICHWORT VALUES (NULL, '$id', '$partner_id', '$stichwort',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PARTNER_STICHWORT SET AKTUELL='0' WHERE PARTNER_ID='$partner_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT STICHWORT FROM  `PARTNER_STICHWORT` WHERE  `AKTUELL` =  '1'  && PARTNER_ID='$partner_id' && STICHWORT='$stichwort' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `PARTNER_STICHWORT` WHERE  `AKTUELL` =  '1' AND  `PARTNER_ID` =  '$partner_id'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY STICHWORT ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT STICHWORT FROM  `PARTNER_STICHWORT` WHERE  `AKTUELL` =  '1'  GROUP BY STICHWORT	ORDER BY STICHWORT ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `PARTNER_STICHWORT` WHERE  `AKTUELL` =  '1' AND  `STICHWORT` LIKE  '%$stichwort%'
        \end_layout
            \begin_layout Plain Layout
        ORDER BY STICHWORT ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PDF_VORLAGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PDF_VORLAGEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KURZTEXT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEXT` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPF_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KAT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=253 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
KURZTEXT 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
EMPF_TYP 
\end_layout
\begin_layout Description
KAT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_serienbrief.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_serienbrief.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE EMPF_TYP='$empf_typ' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_serienbrief.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE KAT='$kat' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_serienbrief.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE KAT='$kat' && EMPF_TYP='$empf_typ' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_serienbrief.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PDF_VORLAGEN WHERE DAT='$v_dat'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->v_kurztext = $row ['KURZTEXT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE EMPF_TYP='$empf_typ' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE KAT='$kat' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PDF_VORLAGEN WHERE KAT='$kat' && EMPF_TYP='$empf_typ' ORDER BY KURZTEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KAT FROM PDF_VORLAGEN GROUP BY KAT ORDER BY KAT ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EMPF_TYP AS KAT FROM PDF_VORLAGEN GROUP BY EMPF_TYP ORDER BY KAT ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  PDF_VORLAGEN WHERE KURZTEXT='$kurztext' && TEXT='$text' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PDF_VORLAGEN VALUES (NULL, '$kurztext', '$text', '$empf_typ', '$kat', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PDF_VORLAGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function vorlage_update($dat, $kurztext, $text, $kat = 'Alle', $empf_typ = 'Mieter') {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PDF_VORLAGEN SET KURZTEXT= '$kurztext', TEXT= '$text', KAT='$kat', EMPF_TYP='$empf_typ' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PDF_VORLAGEN SET KURZTEXT= '$kurztext', TEXT= '$text', KAT='$kat', EMPF_TYP='$empf_typ' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PDF_VORLAGEN', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PERSON
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PERSON` (

\end_layout
\begin_layout Plain Layout

  `PERSON_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PERSON_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_NACHNAME` varchar(200) CHARACTER SET latin1 COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_VORNAME` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_GEBURTSTAG` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PERSON_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `PERSON_ID` (`PERSON_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `PERSON_NACHNAME` (`PERSON_NACHNAME`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=4608 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PERSON_DAT 
\end_layout
\begin_layout Description
PERSON_ID 
\end_layout
\begin_layout Description
PERSON_NACHNAME 
\end_layout
\begin_layout Description
PERSON_VORNAME 
\end_layout
\begin_layout Description
PERSON_GEBURTSTAG 
\end_layout
\begin_layout Description
PERSON_AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    person_suche.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select></td>";
        \end_layout
            \begin_layout Plain Layout
        // echo "<td>Suchbegriff: <input type=\"text\" name=\"suchfeld\" size=\"50\" value=\"$suchbegriff\"></td><td>";
        \end_layout
            \begin_layout Plain Layout
        echo "<td width=20% align=left><input type=\"submit\" name=\"person_finden\" value=\"Finden\" class=\"buttons\"></td></tr>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT  DISTINCT MIETVERTRAG.EINHEIT_ID, MIETVERTRAG.MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_PERSON_ID";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " FROM `MIETVERTRAG`, PERSON_MIETVERTRAG WHERE ((MIETVERTRAG_BIS = '0000-00-00')OR (MIETVERTRAG_BIS >'2008-06-10'))";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " && ( MIETVERTRAG.MIETVERTRAG_ID = PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID) ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME, PERSON_VORNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "<div class=\"tabelle_personen\"><table>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON where PERSON_ID='$mieter_id' order by PERSON_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON where PERSON_ID='$mieter_id' && PERSON_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mycounter = 0;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON where PERSON_ID='$person_id' && PERSON_AKTUELL='1' ORDER BY PERSON_DAT LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_NACHNAME, $PERSON_VORNAME ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' && $such_tabelle LIKE '$suchbegriff%' ORDER BY PERSON_NACHNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $delete_link = "<a class=\"table_links\" href=\"?daten=person&anzeigen=person_loeschen&person_dat=$PERSON_DAT\">Löschen</a>";
        \end_layout
            \begin_layout Plain Layout
        $aendern_link = "<a class=\"table_links\" href=\"?daten=person&anzeigen=person_aendern&person_id=$PERSON_ID\">Ändern</a>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile1\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td>$mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        $einheit_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr class=\"zeile2\"><td width=15%>$sprung_marke_link</td><td width=15%>$PERSON_VORNAME</td><td width=20%>$haus_info_link</td><td>$einheit_link</td><td> $mietvertrag_link </td><td width=10%>$PERSON_GEBURTSTAG</td><td width=10%>$aendern_link</td><td width=10%>$delete_link</td><td width=10%>$detail_link</td></tr>";
        \end_layout
            \begin_layout Plain Layout
        $counter = 0;
        \end_layout
            \begin_layout Plain Layout
        $mietvertrag_link = "";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<tr><td colspan=3><SELECT class=\"personen_mv\" NAME=\"PERSON_ID[]\" MULTIPLE SIZE=25>\n";
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_DAT, $PERSON_ID, $PERSON_NACHNAME, $PERSON_VORNAME, $PERSON_GEBURTSTAG ) = mysql_fetch_row ( $resultat ) ) {
        \end_layout
            \begin_layout Plain Layout
        echo "<OPTION VALUE=\"$PERSON_ID\">$PERSON_NACHNAME $PERSON_VORNAME ($PERSON_GEBURTSTAG)</OPTION>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrags_ids_array[$a]' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON where PERSON_ID='$mieter_id' order by PERSON_DAT DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID FROM PERSON ORDER BY PERSON_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT FROM PERSON WHERE PERSON_ID='$person_id' ORDER BY PERSON_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$PERSON_MIETVERTRAG_MIETVERTRAG_ID' && PERSON_MIETVERTRAG_PERSON_ID='$person_id' ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_NACHNAME='$nachname' && PERSON_VORNAME='$vorname' && PERSON_GEBURTSTAG='$geburtstag' && PERSON_AKTUELL='1' ORDER BY PERSON_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_NACHNAME='$nachname' && PERSON_VORNAME='$vorname' && PERSON_GEBURTSTAG='$geburtstag' && PERSON_AKTUELL='1' ORDER BY PERSON_ID ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat1 = mysql_query ( $db_abfrage1 ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $resultat1 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON SET PERSON_AKTUELL='0' WHERE PERSON_DAT='$person_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // $numberOfRows = mysql_affected_rows();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON SET PERSON_AKTUELL='0' WHERE PERSON_ID='$person_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_alt = letzte_person_dat_of_person_id ( $person_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON (`PERSON_DAT`, `PERSON_ID`, `PERSON_NACHNAME`, `PERSON_VORNAME`, `PERSON_GEBURTSTAG`, `PERSON_AKTUELL`) VALUES (NULL, '$akt_person_id', '$_REQUEST[person_nachname]', '$_REQUEST[person_vorname]', date_format( '$gebdatum', '%Y-%m-%d' )
        \end_layout
            \begin_layout Plain Layout
        , '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON (`PERSON_DAT`, `PERSON_ID`, `PERSON_NACHNAME`, `PERSON_VORNAME`, `PERSON_GEBURTSTAG`, `PERSON_AKTUELL`) VALUES (NULL, '$akt_person_id', '$_REQUEST[person_nachname]', '$_REQUEST[person_vorname]', '$gebdatum', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON (`PERSON_DAT`, `PERSON_ID`, `PERSON_NACHNAME`, `PERSON_VORNAME`, `PERSON_GEBURTSTAG`, `PERSON_AKTUELL`) VALUES (NULL, '$akt_person_id', '$_REQUEST[person_nachname]', '$_REQUEST[person_vorname]', '$gebdatum', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $dat_neu = letzte_person_dat_of_person_id ( $akt_person_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_ID='$person_id' && PERSON_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_VORNAME='$vorname_v' && PERSON_NACHNAME='$name_v' ORDER BY PERSON_NACHNAME, PERSON_VORNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\" $javaaction>";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $personen ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $person_id = $personen [$a] ['PERSON_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$person_id\" selected>$nachname $vorname MV:$anz_mv $mv_str</option>";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$person_id\">$nachname $vorname</option>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        return $person_id;
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$et_id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `WEG_EIG_ID` FROM `WEG_EIGENTUEMER_PERSON` WHERE `PERSON_ID` = '$person_id' AND `AKTUELL` = '1' && `WEG_EIG_ID` IN (SELECT ID FROM  `WEG_MITEIGENTUEMER` WHERE  `EINHEIT_ID` ='$einheit_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' ORDER BY PERSON_DAT DESC LIMIT 0,1" ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' ORDER BY PERSON_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = 'PERSON' && DETAIL_NAME = 'Anrede' && DETAIL_ZUORDNUNG_ID = '$person_id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_details.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT DETAIL_INHALT FROM DETAIL WHERE DETAIL_ZUORDNUNG_TABELLE = 'PERSON' && DETAIL_NAME = 'Geschlecht' && DETAIL_ZUORDNUNG_ID = '$person_id' && DETAIL_AKTUELL = '1' ORDER BY DETAIL_DAT DESC LIMIT 0 , 1 ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $DETAIL_INHALT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function dropdown_personen_liste($label, $name, $id, $javaaction) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME, PERSON_VORNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" id=\"$id\" $javaaction>";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $personen ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $person_id = $personen [$a] ['PERSON_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function mv_personen_anzeigen_form($arr) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' WHERE MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$mv->einheit_kurzname***$mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOGIN` WHERE PERSON_ID='$person_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOG_BER` WHERE PERSON_ID='$person_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `KUNDEN_LOG_BER` SET AKTUELL='0' WHERE PERSON_ID='$person_id' &&  ZUGRIFF_OBJ='$ber_obj' && ZUGRIFF_ID='$ber_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM  `KUNDEN_LOG_BER` WHERE PERSON_ID='$person_id' && ZUGRIFF_OBJ='$ber_obj' && ZUGRIFF_ID='$ber_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `KUNDEN_LOG_BER` VALUES (NULL, '$last_id', '$person_id', '$ber_obj', '$ber_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `KUNDEN_LOGIN` VALUES (NULL, '$last_id', '$username', '$passwd', '$email', '$person_id', '$partner_id','1');";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE `KUNDEN_LOG_BER` SET AKTUELL='0' WHERE PERSON_ID='$person_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\" selected>$einheit_kn | $mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$mv_id\">$einheit_kn | $mv->personen_name_string</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' ORDER BY PERSON_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_nachname = ltrim ( rtrim ( strip_tags ( $row ['PERSON_NACHNAME'] ) ) );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl; // Wieviel MV hat die Person (nur aktuelle)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME ASC, PERSON_VORNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$id\">$label</label><select name=\"$name\" size=\"1\" id=\"$id\">";
        \end_layout
            \begin_layout Plain Layout
        for($a = 0; $a < count ( $arr ); $a ++) {
        \end_layout
            \begin_layout Plain Layout
        $person_id = $arr [$a] ['PERSON_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"$person_id\" selected>$person_nn $person_vn</OPTION>\n";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"$person_id\">$person_nn $person_vn</OPTION>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function save_person($nachname, $vorname, $geb_dat, $geschlecht, $telefon, $handy, $email) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON VALUES (NULL, '$l_pid', '$nachname', '$vorname', '$geb_dat_db', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PERSON', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_ID FROM PERSON ORDER BY PERSON_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PERSON WHERE  PERSON_NACHNAME='$nachname' && PERSON_VORNAME='$vorname' && PERSON_GEBURTSTAG='$geb_dat_db' &&PERSON_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM PERSON
        \end_layout
            \begin_layout Plain Layout
        WHERE (LTRIM( RTRIM( REPLACE( PERSON_NACHNAME, CHAR( 13, 10 ) ,  '' ) ) ) LIKE  '$nachname' && LTRIM( RTRIM( REPLACE( PERSON_VORNAME, CHAR( 13, 10 ) ,  '' ) ) ) LIKE  '$vorname'
        \end_layout
            \begin_layout Plain Layout
        ) OR
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' && (PERSON_NACHNAME LIKE '%$string%' OR PERSON_VORNAME LIKE '%$string%' )ORDER BY PERSON_NACHNAME, PERSON_VORNAME ASC LIMIT 0,50";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' && $such_tabelle LIKE '$suchbegriff%' ORDER BY PERSON_NACHNAME ASC LIMIT 0,50";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        die ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_DAT, PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, PERSON_GEBURTSTAG FROM PERSON WHERE PERSON_AKTUELL='1' ORDER BY PERSON_NACHNAME ASC LIMIT 0,50";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, `DETAIL_NAME` , `DETAIL_INHALT` , `DETAIL_BEMERKUNG` , `DETAIL_ZUORDNUNG_ID`
        \end_layout
            \begin_layout Plain Layout
        FROM `DETAIL` , PERSON
        \end_layout
            \begin_layout Plain Layout
        WHERE `DETAIL_NAME` LIKE '%Hinweis%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT PERSON_ID, PERSON_NACHNAME, PERSON_VORNAME, `DETAIL_NAME` , `DETAIL_INHALT` , `DETAIL_BEMERKUNG` , `DETAIL_ZUORDNUNG_ID`
        \end_layout
            \begin_layout Plain Layout
        FROM `DETAIL` , PERSON
        \end_layout
            \begin_layout Plain Layout
        WHERE `DETAIL_NAME` LIKE '%anschrift%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl; // Anzahl aller Personen im MV
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM PERSON WHERE PERSON_AKTUELL='1' && PERSON_ID='$person_id' ORDER BY PERSON_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $my_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_EIGENTUEMER_PERSON SET AKTUELL='0' where AKTUELL='1' && WEG_EIG_ID='$et_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIG_ID FROM WEG_EIGENTUEMER_PERSON WHERE PERSON_ID='$person_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIGENTUEMER_PERSON.WEG_EIG_ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM WEG_EIGENTUEMER_PERSON, WEG_MITEIGENTUEMER,EINHEIT WHERE PERSON_ID='$person_id' && WEG_MITEIGENTUEMER.AKTUELL='1' && WEG_EIGENTUEMER_PERSON.AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && WEG_EIGENTUEMER_PERSON.WEG_EIG_ID=WEG_MITEIGENTUEMER.ID && WEG_MITEIGENTUEMER.EINHEIT_ID=EINHEIT.EINHEIT_ID GROUP BY WEG_EIG_ID" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$et_id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $text_schrift );
        \end_layout
            \begin_layout Plain Layout
        for($b = 0; $b < $mv->anzahl_personen; $b ++) {
        \end_layout
            \begin_layout Plain Layout
        $anrede_p = $personen_anreden [$b] [anrede];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->update_zahlungsfrist_z ( $mv_id, $fristdatum_sql, '-' . $saldo );
        \end_layout
            \begin_layout Plain Layout
        /* PDF AUSGABE */
        \end_layout
            \begin_layout Plain Layout
        // if($mm<$mv->anzahl_personen-1){
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->update_zahlungsfrist_z ( $mv_id, $fristdatum_sql, '-' . $saldo );
        \end_layout
            \begin_layout Plain Layout
        /* PDF AUSGABE */
        \end_layout
            \begin_layout Plain Layout
        // if($mm<$mv->anzahl_personen-1){
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mahnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $pdf->selectFont ( $text_schrift );
        \end_layout
            \begin_layout Plain Layout
        for($b = 0; $b < $mv->anzahl_personen; $b ++) {
        \end_layout
            \begin_layout Plain Layout
        $anrede_p = $personen_anreden [$b] [anrede];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PERSON_MIETVERTRAG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PERSON_MIETVERTRAG` (

\end_layout
\begin_layout Plain Layout

  `PERSON_MIETVERTRAG_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PERSON_MIETVERTRAG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_MIETVERTRAG_PERSON_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_MIETVERTRAG_MIETVERTRAG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_MIETVERTRAG_AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PERSON_MIETVERTRAG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `PERSON_MIETVERTRAG_MIETVERTRAG_ID` (`PERSON_MIETVERTRAG_MIETVERTRAG_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `PERSON_MIETVERTRAG_PERSON_ID` (`PERSON_MIETVERTRAG_PERSON_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=4849 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PERSON_MIETVERTRAG_DAT 
\end_layout
\begin_layout Description
PERSON_MIETVERTRAG_ID 
\end_layout
\begin_layout Description
PERSON_MIETVERTRAG_PERSON_ID 
\end_layout
\begin_layout Description
PERSON_MIETVERTRAG_MIETVERTRAG_ID 
\end_layout
\begin_layout Description
PERSON_MIETVERTRAG_AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<br>UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT  DISTINCT MIETVERTRAG.EINHEIT_ID, MIETVERTRAG.MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID, PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_PERSON_ID";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " FROM `MIETVERTRAG`, PERSON_MIETVERTRAG WHERE ((MIETVERTRAG_BIS = '0000-00-00')OR (MIETVERTRAG_BIS >'2008-06-10'))";
        \end_layout
            \begin_layout Plain Layout
        $abfrage .= " && ( MIETVERTRAG.MIETVERTRAG_ID = PERSON_MIETVERTRAG.PERSON_MIETVERTRAG_MIETVERTRAG_ID) ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$vertrags_ids_array[$a]' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$mieter_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $mietvertraege = array ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$PERSON_MIETVERTRAG_MIETVERTRAG_ID' && PERSON_MIETVERTRAG_PERSON_ID='$person_id' ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_DAT FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_DAT ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG ORDER BY PERSON_MIETVERTRAG_ID DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( list ( $PERSON_MIETVERTRAG_ID ) = mysql_fetch_row ( $resultat ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "INSERT INTO PERSON_MIETVERTRAG (`PERSON_MIETVERTRAG_DAT`, `PERSON_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_PERSON_ID`, `PERSON_MIETVERTRAG_MIETVERTRAG_ID`, `PERSON_MIETVERTRAG_AKTUELL`) VALUES (NULL, '$letzte_pm_id', '$person_id', '$mietvertrag_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' where PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id_alt'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // personen zu MV gelöscht bzw auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' WHERE MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE PERSON_MIETVERTRAG SET PERSON_MIETVERTRAG_AKTUELL='0' WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET MIETENTWICKLUNG_AKTUELL='0' WHERE KOSTENTRAEGER_TYP LIKE 'MIETVERTRAG' && KOSTENTRAEGER_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE DETAIL SET DETAIL_AKTUELL='0' WHERE DETAIL_ZUORDNUNG_TABELLE LIKE 'MIETVERTRAG' && DETAIL_ZUORDNUNG_ID = '$mv_id'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mv_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG where PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_MIETVERTRAG_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_PERSON_ID='$person_id' && PERSON_MIETVERTRAG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->person_anzahl_mietvertraege = $anzahl; // Wieviel MV hat die Person (nur aktuelle)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anzahl = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->anzahl_personen_im_vertrag = $anzahl; // Anzahl aller Personen im MV
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_MIETVERTRAG_PERSON_ID FROM PERSON_MIETVERTRAG WHERE PERSON_MIETVERTRAG_MIETVERTRAG_ID='$mietvertrag_id' && PERSON_MIETVERTRAG_AKTUELL='1' ORDER BY PERSON_MIETVERTRAG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $my_array = array ();
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PHP_ABFRAGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PHP_ABFRAGEN` (

\end_layout
\begin_layout Plain Layout

  `ABFRAGE_ID` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KUERZEL` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BESCHREIBUNG` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SQL_ABFRAGE` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ABFRAGE_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ABFRAGE_ID 
\end_layout
\begin_layout Description
KUERZEL 
\end_layout
\begin_layout Description
BESCHREIBUNG 
\end_layout
\begin_layout Description
SQL_ABFRAGE 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
POSITIONEN_KATALOG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `POSITIONEN_KATALOG` (

\end_layout
\begin_layout Plain Layout

  `KATALOG_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `KATALOG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ART_LIEFERANT` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ARTIKEL_NR` varchar(20) CHARACTER SET utf8 NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LISTENPREIS` decimal(10,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RABATT_SATZ` decimal(4,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT` varchar(20) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_SATZ` int(2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SKONTO` decimal(3,2) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`KATALOG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `ARTIKEL_NR` (`ARTIKEL_NR`),

\end_layout
\begin_layout Plain Layout

  KEY `ART_LIEFERANT` (`ART_LIEFERANT`),

\end_layout
\begin_layout Plain Layout

  KEY `LISTENPREIS` (`LISTENPREIS`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=79642 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
KATALOG_DAT 
\end_layout
\begin_layout Description
KATALOG_ID 
\end_layout
\begin_layout Description
ART_LIEFERANT 
\end_layout
\begin_layout Description
ARTIKEL_NR 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
LISTENPREIS 
\end_layout
\begin_layout Description
RABATT_SATZ 
\end_layout
\begin_layout Description
EINHEIT 
\end_layout
\begin_layout Description
MWST_SATZ 
\end_layout
\begin_layout Description
SKONTO 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, EINHEIT, MWST_SATZ, SKONTO FROM POSITIONEN_KATALOG WHERE AKTUELL='1' && ART_LIEFERANT='$lieferant_id' && ARTIKEL_NR='$artikel_nr' ORDER BY KATALOG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        ob_clean ();
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "select * from POSITIONEN_KATALOG where ART_LIEFERANT='$lieferant_id' && ARTIKEL_NR='$artikel_nr' && AKTUELL='1' && LISTENPREIS='$preis' && RABATT_SATZ='$rabatt' && SKONTO='$pos_skonto' && BEZEICHNUNG='$bez'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "select * from POSITIONEN_KATALOG where ART_LIEFERANT='$lieferant_id' && ARTIKEL_NR='$artikel_nr' && AKTUELL='1' && LISTENPREIS='$preis' && RABATT_SATZ='$rabatt' && BEZEICHNUNG='$bez' && EINHEIT='$einheit' && MWST_SATZ='$pos_mwst' && SKONTO='$pos_skonto'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT LTRIM(RTRIM(ARTIKEL_NR)), BEZEICHNUNG, LISTENPREIS FROM `POSITIONEN_KATALOG`
        \end_layout
            \begin_layout Plain Layout
        WHERE `ART_LIEFERANT` = '$lieferant_id' AND (`ARTIKEL_NR` LIKE '$string%' OR `BEZEICHNUNG` LIKE '$string%') GROUP BY ARTIKEL_NR ORDER BY ARTIKEL_NR ASC LIMIT 0,5";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM (SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, ART_LIEFERANT, FORMAT((LISTENPREIS - (LISTENPREIS/100)* RABATT_SATZ)/100*(100+MWST_SATZ),2) AS BRUTTO FROM `POSITIONEN_KATALOG`
        \end_layout
            \begin_layout Plain Layout
        WHERE (`ARTIKEL_NR` LIKE '$string%' OR `BEZEICHNUNG` LIKE '$string%') ORDER BY ART_LIEFERANT ASC, LISTENPREIS DESC, KATALOG_ID DESC) AS AB1 GROUP BY ART_LIEFERANT, ARTIKEL_NR ORDER BY ARTIKEL_NR ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && ARTIKEL_NR = '$artikel_nr' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KATALOG_ID FROM POSITIONEN_KATALOG WHERE AKTUELL='1' ORDER BY KATALOG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [KATALOG_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && ARTIKEL_NR = '$artikel_nr' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && ARTIKEL_NR = '$artikel_nr' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id'  && AKTUELL='1' ORDER BY ARTIKEL_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ARTIKEL_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM POSITIONEN_KATALOG WHERE PARTNER_ID='$partner_id' && BEZEICHNUNG='$bezeichnung' && AKTUELL='1' ORDER BY ARTIKEL_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ARTIKEL_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KATALOG_ID FROM POSITIONEN_KATALOG WHERE AKTUELL='1' ORDER BY KATALOG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KATALOG_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$letzte_artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('POSITIONEN_KATALOG', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $this->get_last_artikelnr ( $partner_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '$pos_skonto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'POSITIONEN_KATALOG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $this->get_last_artikelnr ( $partner_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM POSITIONEN_KATALOG WHERE ART='$partner_id' && BEZEICHNUNG='$artikel_bezeichnung' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [ARTIKEL_NR];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $az = mysql_numrows ( $result ); // az = anzahl zeilen
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KATALOG_DAT FROM POSITIONEN_KATALOG WHERE ARTIKEL_NR='$art_nr' && ART_LIEFERANT='$lieferant_id' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function artikel_text_update($art_nr, $lieferant_id, $text) {
        \end_layout
            \begin_layout Plain Layout
        $dat = $this->get_last_artikel_dat ( $art_nr, $lieferant_id );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POSITIONEN_KATALOG SET BEZEICHNUNG='$text' WHERE KATALOG_DAT='$dat' && ARTIKEL_NR='$art_nr' && ART_LIEFERANT='$lieferant_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POSITIONEN_KATALOG SET BEZEICHNUNG='$text' WHERE KATALOG_DAT='$dat' && ARTIKEL_NR='$art_nr' && ART_LIEFERANT='$lieferant_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && ARTIKEL_NR = '$artikel_nr' && AKTUELL='1' ORDER BY KATALOG_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM POSITIONEN_KATALOG WHERE ARTIKEL_NR='$artikel_nr' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, EINHEIT FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$partner_id' && AKTUELL='1' GROUP BY ARTIKEL_NR ORDER BY KATALOG_DAT DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anzahl_artikel = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, SKONTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) AS UNSER_NETTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) AS UNSER_BRUTTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) /100 *(100-SKONTO) AS U_SKONTIERT FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$p_id'  && ARTIKEL_NR='$artikel_nr' && AKTUELL='1'   ORDER BY KATALOG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, SKONTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) AS UNSER_NETTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) AS UNSER_BRUTTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) /100 *(100-SKONTO) AS U_SKONTIERT FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$p_id'  && ARTIKEL_NR='$artikel_nr' && AKTUELL='1'   ORDER BY KATALOG_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "<br>SELECT ARTIKEL_NR, BEZEICHNUNG, LISTENPREIS, RABATT_SATZ, SKONTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) AS UNSER_NETTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) AS UNSER_BRUTTO, ((LISTENPREIS/100)*(100-RABATT_SATZ)) /100 * (100+MWST_SATZ) /100 *(100-SKONTO) AS U_SKONTIERT FROM POSITIONEN_KATALOG WHERE ART_LIEFERANT='$p_id' && ARTIKEL_NR='$artikel_nr' && AKTUELL='1' ORDER BY KATALOG_ID ASC<br>";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POSITIONEN_KATALOG WHERE AKTUELL='1' && ARTIKEL_NR LIKE '%$artikel_nr%' OR BEZEICHNUNG LIKE '%$artikel_nr%' GROUP BY ARTIKEL_NR, ART_LIEFERANT ORDER BY ART_LIEFERANT DESC, BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
POS_GRUPPE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `POS_GRUPPE` (

\end_layout
\begin_layout Plain Layout

  `B_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `B_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POS` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `UEBERSCHRIFT` varchar(255) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`B_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1058 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
B_DAT 
\end_layout
\begin_layout Description
B_ID 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
POS 
\end_layout
\begin_layout Description
UEBERSCHRIFT 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT UEBERSCHRIFT FROM POS_GRUPPE WHERE BELEG_NR='$beleg_nr' && POS='$pos' && AKTUELL = '1' ORDER BY B_DAT DESC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT UEBERSCHRIFT FROM POS_GRUPPE WHERE BELEG_NR='$beleg_nr' && POS='$pos' && AKTUELL = '1'";
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function insert_pool_bez_in_gruppe($pool_bez, $beleg_nr, $pos) {
        \end_layout
            \begin_layout Plain Layout
        $last_b_id = last_id2 ( 'POS_GRUPPE', 'B_ID' ) + 1;
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_GRUPPE VALUES (NULL, '$last_b_id', '$beleg_nr', '$pos','$pool_bez','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_GRUPPE VALUES (NULL, '$last_b_id', '$beleg_nr', '$pos','$pool_bez','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
POS_POOL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `POS_POOL` (

\end_layout
\begin_layout Plain Layout

  `PP_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `U_BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `U_POS` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POOL_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POS` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MENGE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINZEL_PREIS` decimal(10,3) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `V_PREIS` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_SUMME` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_SATZ` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SKONTO` decimal(3,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RABATT_SATZ` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKONTO` varchar(10) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_TYP` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PP_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=16299 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PP_DAT 
\end_layout
\begin_layout Description
U_BELEG_NR 
\end_layout
\begin_layout Description
U_POS 
\end_layout
\begin_layout Description
POOL_ID 
\end_layout
\begin_layout Description
POS 
\end_layout
\begin_layout Description
MENGE 
\end_layout
\begin_layout Description
EINZEL_PREIS 
\end_layout
\begin_layout Description
V_PREIS 
\end_layout
\begin_layout Description
G_SUMME 
\end_layout
\begin_layout Description
MWST_SATZ 
\end_layout
\begin_layout Description
SKONTO 
\end_layout
\begin_layout Description
RABATT_SATZ 
\end_layout
\begin_layout Description
KOSTENKONTO 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
AUSSTELLER_TYP 
\end_layout
\begin_layout Description
AUSSTELLER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_spalte_2($spalte, $prozent) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`=(EINZEL_PREIS+((EINZEL_PREIS/100)*$prozent)) WHERE AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`=(EINZEL_PREIS+((EINZEL_PREIS/100)*$prozent)) WHERE AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`=(EINZEL_PREIS+((EINZEL_PREIS/100)*$prozent)) WHERE POOL_ID='$pool_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`=$preis WHERE POOL_ID='$pool_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_spalte($pp_dat, $spalte, $wert) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`='$wert' WHERE PP_DAT='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET `$spalte`='$wert' WHERE PP_DAT='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET POS='$pos_new' WHERE PP_DAT='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET POS='$pos' WHERE POS='$pos_new' && POOL_ID='$pool_id' && PP_DAT!='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET POS='$pos_new' WHERE PP_DAT='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET POS='$pos' WHERE POS='$pos_new' && POOL_ID='$pool_id' && PP_DAT!='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POS FROM POS_POOL WHERE POOL_ID='$pool_id' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' && AKTUELL='1' ORDER BY POS DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT POS FROM POS_POOL WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' ORDER BY POS DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function insert_in_u_pool($obj, $pool_id) {
        \end_layout
            \begin_layout Plain Layout
        $pos = get_last_pos ( $obj->kos_typ, $obj->kos_id, $obj->rechnungs_empfaenger_typ, $obj->rechnungs_empfaenger_id, $pool_id ) + 1;
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_POOL VALUES(NULL, '$obj->beleg_nr', '$obj->pos', '$pool_id', '$pos', '$obj->menge', '$obj->einzel_preis','$obj->einzel_preis', '$obj->g_summe', '$obj->mwst_satz', '$obj->skonto', '$obj->rabatt_satz', '$obj->kostenkonto', '$obj->kos_typ', '$obj->kos_id','$obj->rechnungs_empfaenger_typ','$obj->rechnungs_empfaenger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_POOL VALUES(NULL, '$obj->beleg_nr', '$obj->pos', '$pool_id', '$pos', '$obj->menge', '$obj->einzel_preis','$obj->einzel_preis', '$obj->g_summe', '$obj->mwst_satz', '$obj->skonto', '$obj->rabatt_satz', '$obj->kostenkonto', '$obj->kos_typ', '$obj->kos_id','$obj->rechnungs_empfaenger_typ','$obj->rechnungs_empfaenger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_g_preis() {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET G_SUMME=(MENGE*V_PREIS)/100*(100-RABATT_SATZ) WHERE AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET G_SUMME=(MENGE*V_PREIS)/100*(100-RABATT_SATZ) WHERE AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_v_preis($spalte, $pp_dat, $prozent) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET V_PREIS=(EINZEL_PREIS+((EINZEL_PREIS/100)*$prozent)) WHERE PP_DAT='$pp_dat' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET V_PREIS=(EINZEL_PREIS+((EINZEL_PREIS/100)*$prozent)) WHERE PP_DAT='$pp_dat' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY POOL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOLS SET AKTUELL='0' WHERE ID='$pool_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOL SET AKTUELL='0' WHERE PP_DAT='$pp_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POOL_NAME  FROM  POS_POOLS WHERE ID='$pool_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POS_POOL WHERE AKTUELL = '1' GROUP BY KOS_TYP, KOS_ID, AUSSTELLER_TYP, AUSSTELLER_ID" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, (V_PREIS-EINZEL_PREIS)/(EINZEL_PREIS/100) AS PROZENTE FROM POS_POOL WHERE POOL_ID='$pool_id' && AKTUELL = '1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' ORDER BY POS ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT *, (V_PREIS-EINZEL_PREIS)/(EINZEL_PREIS/100) AS PROZENTE FROM POS_POOL WHERE AKTUELL = '1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' ORDER BY POS ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, (V_PREIS-EINZEL_PREIS)/(EINZEL_PREIS/100) AS PROZENTE FROM POS_POOL WHERE AKTUELL = '1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' ORDER BY POOL_ID, POS, U_BELEG_NR, U_POS ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_POOLS VALUES (NULL, '$l_pool_id', '$pool_bez', '$kos_typ','$kos_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AKTUELL FROM POS_POOLS WHERE ID='$pool_id' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE POS_POOLS SET AKTUELL='$akt_neu' WHERE ID='$pool_id' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' ORDER BY AKTUELL DESC, POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY AKTUELL DESC, POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_BELEG_NR, U_POS FROM POS_POOL WHERE PP_DAT='$pp_dat' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result1 = mysql_query ( "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='1' WHERE AKTUELL='1' && BELEG_NR='$U_BELEG_NR' && POSITION='$U_POS' && WEITER_VERWENDEN='0'" );
        \end_layout
            \begin_layout Plain Layout
        /* Löschen aus dem Unterpool */
        \end_layout
            \begin_layout Plain Layout
        mysql_query ( "DELETE FROM POS_POOL WHERE PP_DAT='$pp_dat'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "DELETE FROM POS_POOL WHERE PP_DAT='$pp_dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
POS_POOLS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `POS_POOLS` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POOL_NAME` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1087 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
POOL_NAME 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM  POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY POOL_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE POS_POOLS SET AKTUELL='0' WHERE ID='$pool_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POOL_NAME  FROM  POS_POOLS WHERE ID='$pool_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POS_POOLS VALUES (NULL, '$l_pool_id', '$pool_bez', '$kos_typ','$kos_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AKTUELL FROM POS_POOLS WHERE ID='$pool_id' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE POS_POOLS SET AKTUELL='$akt_neu' WHERE ID='$pool_id' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' ORDER BY AKTUELL DESC, POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM POS_POOLS WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' ORDER BY AKTUELL DESC, POOL_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
PROTOKOLL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `PROTOKOLL` (

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_DAT` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_WER` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_COMPUTER` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_WANN` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_TABELE` varchar(25) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_DAT_NEU` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROTOKOLL_DAT_ALT` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`PROTOKOLL_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1166634 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
PROTOKOLL_DAT 
\end_layout
\begin_layout Description
PROTOKOLL_WER 
\end_layout
\begin_layout Description
PROTOKOLL_COMPUTER 
\end_layout
\begin_layout Description
PROTOKOLL_WANN 
\end_layout
\begin_layout Description
PROTOKOLL_TABELE 
\end_layout
\begin_layout Description
PROTOKOLL_DAT_NEU 
\end_layout
\begin_layout Description
PROTOKOLL_DAT_ALT 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '$netto_betrag','$brutto_betrag','0.00', 'Partner', '$_SESSION[partner_id]','$empf_typ', '$empf_id','1', '1', '0', '0', '0', '0', '0', '$faellig_am', '0000-00-00', '$kurztext_neu', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '1', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', '1','$netto_betrag','19', '0','0', '$netto_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '$netto_betrag','0.00','0.00', 'Partner', '$_SESSION[partner_id]','$empf_typ', '$empf_id','1', '1', '0', '0', '0', '0', '0', '$faellig_am', '0000-00-00', '$kurztext_neu', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', $menge,'$netto_betrag','19', '0','0', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PROTOKOLL VALUES (NULL,'$wer', '$ip', NULL, '$tabele', '$dat_neu', '$dat_alt')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    formular_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE OBJEKT SET OBJEKT_AKTUELL='0' WHERE OBJEKT_DAT='$obj_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( "OBJECT", $obj_dat, $obj_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'OBJEKT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'OBJEKT', $last_dat, $objekt_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'HAUS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'HAUS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'EINHEIT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO EINHEIT VALUES (NULL, '$last_id', '$qm', '$lage', '$haus_id', '1', '$kurzname', '$typ')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'EINHEIT', $last_dat, $einheit_dat );
        \end_layout
            \begin_layout Plain Layout
        return $last_dat;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE EINHEIT SET EINHEIT_AKTUELL='0' WHERE EINHEIT_DAT='$einheit_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN VALUES (NULL, '$konto_id','$clean_arr[partnername] - Konto','$clean_arr[partnername]', '$clean_arr[KONTONUMMER]','$clean_arr[BLZ]', '$clean_arr[kreditinstitut]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Geldkonto dem Partner zuweisen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$this->rechnungs_typ_druck', '$rechnungsdatum_sql','$eingangsdatum', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$this->rechnungs_aussteller_typ', '$this->rechnungs_aussteller_id','$this->rechnungs_empfaenger_typ', '$this->rechnungs_empfaenger_id','1', '1', '1', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$kurzbeschreibung', '$empfangs_geld_konto')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$this->rechnungs_typ_druck', '$rechnungsdatum','$eingangsdatum', '$netto_betrag','$brutto_betrag','$brutto_betrag', '$skonto', '$clean_arr[Aussteller_typ]', '$clean_arr[Aussteller_id]','$clean_arr[Empfaenger_typ]', '$clean_arr[Empfaenger_id]','1', '1', '1', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$kurzbeschreibung', '$clean_arr[empfangs_geld_konto]')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto', '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$letzte_artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('POSITIONEN_KATALOG', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $this->get_last_artikelnr ( $partner_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO POSITIONEN_KATALOG VALUES (NULL, '$letzte_kat_id','$partner_id', '$artikel_nr','$bezeichnung', '$listenpreis', '$rabatt', '$einheit', '$mwst', '$pos_skonto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'POSITIONEN_KATALOG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $this->get_last_artikelnr ( $partner_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        echo "Dem Beleg $belegnr wurde die Kontonummer des Rechnungsausteller hinzugefügt<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a wurde gespeichert <br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a ($neue_artikel_nr) " . $_POST ['positionen'] [$a] ['bezeichnung'] . " wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$zeile', '$belegnr', '$u_beleg_nr','$ursprungs_art_lieferant','$ursprungs_artikel_nr', '$menge','$einzel_preis','$mwst_satz', '$pos_rabatt_satz', '$skonto', '$gpreis','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Position $a ($neue_artikel_nr) ".$positionen[$a]['bezeichnung']." wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0', MENGE='$neue_menge' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET WEITER_VERWENDEN='0' WHERE KONTIERUNG_DAT='$dat' ";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET AKTUELL='0' WHERE KONTIERUNG_DAT='$dat' && KONTIERUNG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTIERUNG_POSITIONEN SET AKTUELL='0' WHERE KONTIERUNG_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTIERUNG_POSITIONEN VALUES (NULL, '$kontierung_id','$beleg_nr', '$kontierungs_pos','$kontierungs_menge', '$einzel_preis', '$gesamt_preis', '$mwst_satz', '$skonto' , '$rabatt_satz', '$kontenrahmen_konto', '$kostentraeger_typ', '$kostentraeger_id', '$datum', '$verwendungs_jahr', '$weiter_verwenden', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO LIEFERSCHEINE VALUES (NULL, '$last_id','$datum', '$li_typ', '$li_id', '$empf_typ','$empf_id','$l_nr', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'LIEFERSCHEINE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATE_FORMAT(`PROTOKOLL_WANN`, '%Y-%m-%d') AS DATUM  FROM `PROTOKOLL` WHERE `PROTOKOLL_TABELE` LIKE '$table' && PROTOKOLL_DAT_NEU='$dat' ORDER BY PROTOKOLL_WANN DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EINHEITEN VALUES (NULL, '$last_w_id', '$w_name',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $this->last_bk_id = $last_bk_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Teilnahme am Lastschriftverfahren wurde vermerkt";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE MIETVERTRAG SET MIETVERTRAG_AKTUELL='0' where MIETVERTRAG_DAT='$mietvertrag_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () ); // aktuell auf 0 gesetzt
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETVERTRAG', $mietvertrag_dat, $mietvertrag_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETVERTRAG (`MIETVERTRAG_DAT`, `MIETVERTRAG_ID`, `MIETVERTRAG_VON`, `MIETVERTRAG_BIS`, `EINHEIT_ID`, `MIETVERTRAG_AKTUELL`) VALUES (NULL, '$mietvertrag_id_alt', '$mietvertrag_von', '$mietvertrag_bis', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETVERTRAG', $last_dat, $mietvertrag_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETVERTRAG SET MIETVERTRAG_BIS='$mietvertrag_bis' WHERE MIETVERTRAG_DAT='$mv_dat'" );
        \end_layout
            \begin_layout Plain Layout
        /* protokollieren fehlt */
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietvertrag.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = mysql_query ( "UPDATE MIETENTWICKLUNG SET ENDE='$mietvertrag_bis' WHERE KOSTENTRAEGER_TYP='MIETVERTRAG' && KOSTENTRAEGER_ID='$mv_id' && (ENDE='0000-00-00' OR ENDE>='$mietvertrag_bis') && MIETENTWICKLUNG_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        /* protokollieren fehlt */
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET AKTUELL='0' WHERE RECHNUNG_DAT='$rechnung_dat' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$beleg_nr', '$rnr', '$l_ausg_rnr', '$l_empf_e_nr', '$r_typ', '$r_datum_sql','$eingangsdatum_sql', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$aus_typ', '$aus_id','$empf_typ', '$empf_id','1', '1', '1', '0', '1', '0', '0', '$faellig', '0000-00-00', '$kurzinfo', '$empf_gk_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$r_typ aus UGL Importiert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$beleg_nr', '$rnr', '$l_ausg_rnr', '$l_empf_e_nr', '$r_typ', '$r_datum_sql','$eingangsdatum_sql', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$aus_typ', '$aus_id','$empf_typ', '$empf_id','1', '1', '1', '0', '1', '0', '0', '$faellig', '0000-00-00', '$kurzinfo', '$empf_gk_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$r_typ aus CSV Importiert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, '' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'BELEG2RG', $last_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '0','0.00','0.00', 'Partner', '$p_id','Partner', '$empf_p_id','1', '1', '0', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$r_org->kurzbeschreibung', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$beleg_nr','$p_id', '$art_nr', $menge,'$preis','$mwst', '$rab','$skonto', '$preis_g','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTIERUNG_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } // end for2
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_PROFILE VALUES (NULL, '$last_bk_id', '$bez', 'Wirtschaftseinheit', '$w_id','$jahr','$ber_datum','$ver_datum', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $this->last_bk_id = $last_bk_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ANPASSUNG VALUES (NULL, '$last_id','$kostenart', '$betrag', '$genkey','$profil_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_KONTEN VALUES (NULL, '$last_id','$kostenkonto', '$konto_bez', '$profil_id','1','0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN VALUES (NULL, '$last_b_id', '$profil_id', '$profil_bez','$profil_jahr', '$wirt_e', '$wirt_name', '$datum', '$anz_einheiten', '$qm_gesamt', '$qm_wohnraum', '$qm_gewerbe', '$anz_konten', '$anz_abrechnungen', '$ersteller', '$partner_id','$kontenrahmen_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN_KONTEN VALUES (NULL, '$last_a_id', '$b_id','$bk_k_id','$konto','$konto_bez','$g_kosten','$g_kosten_wo','$g_kosten_ge', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_a_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABRECHNUNGEN VALUES (NULL, '$last_e_id', '$b_id','$empf', '$zeitraum', '$mieternr', '$einheit_id','$einheit_name','$g_kosten','$g_hndl', '$vorschuss', '$saldo', '$saldo_art', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_e_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABR_ZEILEN VALUES (NULL, '$last_z_id','$bk_e_id', '$konto_id', '$konto_bez', '$g_kosten','$g_hndl', '$verteiler', '$ihre_me', '$anteil_hndl', '$beteiligung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_z_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_KONTEN VALUES (NULL, '$last_id','$kostenkonto', '$konto_bez', '$profil_id','$genkey_id','$hndl', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('BK_PROFILE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        // $_SESSION[bk_konto] = $kostenkonto;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO LEISTUNGSKATALOG VALUES (NULL, '$lk_id', '$leistungs_beschreibung', '$this->gewerk_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        if ($last_dat) {
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'LEISTUNGSKATALOG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $zettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTO_BUCHUNGEN SET AKTUELL='0' WHERE GELD_KONTO_BUCHUNGEN_DAT='$buchungs_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN_DAT', $buchungs_dat, $buchungs_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTO_BUCHUNGEN SET AKTUELL='1' WHERE GELD_KONTO_BUCHUNGEN_DAT='$alt_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN_DAT', $alt_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "<h3>Betrag von $betrag € wurde gebucht.</h3>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$buchung_id', '$g_buchungsnummer', '$kto_auszugsnr', '$rechnungsnr', '$betrag','$mwst', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "<h3>Betrag von $betrag € wurde gebucht.</h3>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `KUNDEN_LOG_BER` VALUES (NULL, '$last_id', '$person_id', '$ber_obj', '$ber_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KUNDEN_LOG_BER', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kundenweb.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KUNDEN_LOGIN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Mandat gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE_SEQ', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Mandat gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweck', '$betrag', '$von_gk_id', '$sep->IBAN', '$sep->BIC', '$sep->bankname', '$sep->beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE SEPA_UEBERWEISUNG SET FILE='$dateiname' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES (NULL, '$buchung_id', '$g_buchungsnummer', '$kto_auszugsnr', '$m_ref', '$betrag', '$mwst', '$vzweck', '$geldkonto_id', '$kostenkonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweckn', '$betrag', '$von_gk_id', '$iban', '$bic', '$bankname', '$beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_person.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PERSON', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, $me_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_mietentwicklung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'DETAIL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO GELD_KONTEN_ZUWEISUNG VALUES (NULL, '$last_b_id', '$geldkonto_id', '$kos_typ','$kos_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE GELD_KONTEN_ZUWEISUNG SET AKTUELL='0' WHERE AKTUELL = '1' && KONTO_ID='$geldkonto_id' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_geldkonten.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('GELD_KONTEN_ZUWEISUNG', $last_dat, '$last_dat');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KASSEN_BUCH SET AKTUELL='0' WHERE KASSEN_BUCH_DAT='$buchungs_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KASSEN_BUCH', $buchungs_dat, $buchungs_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('W_TERMINE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WARTUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'W_GERAETE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WARTUNG_ZUWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTIONS_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "<br>Kaution wurde gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KAUTION_FELD VALUES (NULL, '$feld',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_FELD', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KAUTION_FELD SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // protokollieren
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_FELD', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kautionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KAUTION_DATEN', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO REPORT_PROFILE VALUES (NULL, '$last_id', '$kurz_b', '$objekt_id', '$gk_id', '$p_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_listen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'REPORT_PROFILE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "INSERT INTO GELD_KONTO_BUCHUNGEN VALUES(NULL, '$last_id', '$g_buchungsnummer', '$auszugsnr', '$rechnungsnr', '$betrag', '$mwst_anteil', '$v_zweck', '$geldkonto_id', '$buchungskonto', '$datum', '$kostentraeger_typ', '$kostentraeger_id', '1')" );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'GELD_KONTO_BUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $wert = $this->nummer_punkt2komma ( $value );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$mietvertrag_id - SALDO AUF KM GEBUCHT<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } /* End foreach */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', 'Betriebskostennachzahlung', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO MIETBUCHUNGEN VALUES (NULL, '$mietvertrag_id', '$buchungsdatum', '$bk_betrag', '$buchungsnummer', '$bk_bezeichnung', '1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $aktuelle_forderung = $this->import_forderung_monatlich ( $mietvertrag_id, $monat, $jahr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } /* End foreach */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } /* End foreach */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } /* End foreach */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $gebucht = true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETENTWICKLUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETE_ZAHLBETRAG SET AKTUELL='0' WHERE   BUCHUNGSNUMMER='$bnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        /* Da nur Aktuell von 1 auf 0 gesetzt, ergibt es im Protokoll die gleiche Zeilennummer bzw. Buchungsnummer */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    mietkonto_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE MIETBUCHUNGEN SET MIETBUCHUNGEN_AKTUELL='0' WHERE   MIETBUCHUNG_DAT='$mietbuchung_dat' && MIETBUCHUNGEN_AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        /* Da nur Aktuell von 1 auf 0 gesetzt, ergibt es im Protokoll die gleiche Zeilennummer bzw. Mietbuchungsdat */
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'MIETBUCHUNGEN', $mietbuchung_dat, $mietbuchung_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN VALUES (NULL, '$k_id', '$k_bez', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTEN VALUES (NULL, '$k_id', '$konto','$bez', '$k_gruppe_id', '$kontoart_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTEN', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_GRUPPEN VALUES (NULL, '$g_id', '$g_bez',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_GRUPPEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_KONTOARTEN VALUES (NULL, '$k_id', '$kontoart',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_KONTOARTEN', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO KONTENRAHMEN_ZUWEISUNG VALUES (NULL, '$id', '$kos_typ','$kos_id', '$kontenrahmen_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'KONTENRAHMEN_ZUWEISUNG', $last_dat, 0 );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_kontenrahmen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE KONTENRAHMEN_ZUWEISUNG SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PDF_VORLAGEN VALUES (NULL, '$kurztext', '$text', '$empf_typ', '$kat', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PDF_VORLAGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE PDF_VORLAGEN SET KURZTEXT= '$kurztext', TEXT= '$text', KAT='$kat', EMPF_TYP='$empf_typ' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bpdf.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PDF_VORLAGEN', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WG_DEF', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_WG_DEF SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WG_DEF', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_PROFIL SET AKTUELL='0' WHERE ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_HK VALUES (NULL, '$id', '$betrag_a', 'Eigentuemer','$eig_id', '$p_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_HK', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_ZEILEN VALUES (NULL, '$id', '$profil_id', '$konto','$art', '$text', '$gen_key_id','$betrag_a','$hndl_betrag_a', '$kos_typ','$kos_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_ZEILEN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_PROFIL', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        $_SESSION ['hga_profil_id'] = $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_PROFIL SET AKTUELL='0' WHERE ID='$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$profil_id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_PROFIL', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_KONTOSTAND', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "EINGABE WURDE IN DEN DTAUS POOL AUFGENOMMEN" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO PARTNER_LIEFERANT VALUES (NULL, $partner_id, '$clean_arr[partnername]','$clean_arr[strasse]', '$clean_arr[hausnummer]','$clean_arr[plz]','$clean_arr[ort]','$clean_arr[land]','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'PARTNER_LIEFERANT', $last_dat, $partner_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
RECHNUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `RECHNUNGEN` (

\end_layout
\begin_layout Plain Layout

  `RECHNUNG_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RECHNUNGSNUMMER` varchar(20) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSTELLER_AUSGANGS_RNR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPFAENGER_EINGANGS_RNR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RECHNUNGSTYP` enum('Rechnung','Stornorechnung','Gutschrift','Kassenbeleg','Buchungsbeleg','Angebot','Schlussrechnung','Teilrechnung') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RECHNUNGSDATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINGANGSDATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NETTO` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BRUTTO` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SKONTOBETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPFAENGER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPFAENGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_ERFASST` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_VOLLSTAENDIG` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_ZUGEWIESEN` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_ZAHLUNG_FREIGEGEBEN` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_BEZAHLT` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `STATUS_BESTAETIGT` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FAELLIG_AM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZAHLT_AM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KURZBESCHREIBUNG` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EMPFANGS_GELD_KONTO` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`RECHNUNG_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `AUSSTELLER_TYP` (`AUSSTELLER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `AUSSTELLER_ID` (`AUSSTELLER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `EMPFAENGER_TYP` (`EMPFAENGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `EMPFAENGER_ID` (`EMPFAENGER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `BELEG_NR` (`BELEG_NR`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`),

\end_layout
\begin_layout Plain Layout

  KEY `RECHNUNGSDATUM` (`RECHNUNGSDATUM`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_ERFASST` (`STATUS_ERFASST`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_VOLLSTAENDIG` (`STATUS_VOLLSTAENDIG`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_ZUGEWIESEN` (`STATUS_ZUGEWIESEN`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_ZAHLUNG_FREIGEGEBEN` (`STATUS_ZAHLUNG_FREIGEGEBEN`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_BEZAHLT` (`STATUS_BEZAHLT`),

\end_layout
\begin_layout Plain Layout

  KEY `STATUS_BESTAETIGT` (`STATUS_BESTAETIGT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=36815 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
RECHNUNG_DAT 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
RECHNUNGSNUMMER 
\end_layout
\begin_layout Description
AUSTELLER_AUSGANGS_RNR 
\end_layout
\begin_layout Description
EMPFAENGER_EINGANGS_RNR 
\end_layout
\begin_layout Description
RECHNUNGSTYP 
\end_layout
\begin_layout Description
RECHNUNGSDATUM 
\end_layout
\begin_layout Description
EINGANGSDATUM 
\end_layout
\begin_layout Description
NETTO 
\end_layout
\begin_layout Description
BRUTTO 
\end_layout
\begin_layout Description
SKONTOBETRAG 
\end_layout
\begin_layout Description
AUSSTELLER_TYP 
\end_layout
\begin_layout Description
AUSSTELLER_ID 
\end_layout
\begin_layout Description
EMPFAENGER_TYP 
\end_layout
\begin_layout Description
EMPFAENGER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
STATUS_ERFASST 
\end_layout
\begin_layout Description
STATUS_VOLLSTAENDIG 
\end_layout
\begin_layout Description
STATUS_ZUGEWIESEN 
\end_layout
\begin_layout Description
STATUS_ZAHLUNG_FREIGEGEBEN 
\end_layout
\begin_layout Description
STATUS_BEZAHLT 
\end_layout
\begin_layout Description
STATUS_BESTAETIGT 
\end_layout
\begin_layout Description
FAELLIG_AM 
\end_layout
\begin_layout Description
BEZAHLT_AM 
\end_layout
\begin_layout Description
KURZBESCHREIBUNG 
\end_layout
\begin_layout Description
EMPFANGS_GELD_KONTO 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis', RABATT_SATZ='$rabatt' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis', SKONTO='$skonto' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$belegnr','$belegnr','$lieferant_id','$artikel_nr', '$menge','$preis','$pos_mwst', '$rabatt', '$pos_skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "$letzte_rech_pos_id $pos $belegnr $lieferant_id";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$belegnr', '$belegnr', '$lieferant_id','$artikel_nr', '$menge','$preis','$pos_mwst', '$rabatt', '$pos_skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "$letzte_rech_pos_id $pos $belegnr $lieferant_id";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        update_spalte ( $pp_dat, $spalte, $wert );
        \end_layout
            \begin_layout Plain Layout
        update_g_preis ( $pp_dat );
        \end_layout
            \begin_layout Plain Layout
        $rr = new rechnungen ();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        update_g_preis ( $pp_dat );
        \end_layout
            \begin_layout Plain Layout
        $rr = new rechnungen ();
        \end_layout
            \begin_layout Plain Layout
        $rr->u_pool_edit ( $kos_typ, $kos_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '$netto_betrag','$brutto_betrag','0.00', 'Partner', '$_SESSION[partner_id]','$empf_typ', '$empf_id','1', '1', '0', '0', '0', '0', '0', '$faellig_am', '0000-00-00', '$kurztext_neu', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '1', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', '1','$netto_betrag','19', '0','0', '$netto_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '$netto_betrag','0.00','0.00', 'Partner', '$_SESSION[partner_id]','$empf_typ', '$empf_id','1', '1', '0', '0', '0', '0', '0', '$faellig_am', '0000-00-00', '$kurztext_neu', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', $menge,'$netto_betrag','19', '0','0', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PARTNER_ID, PARTNER_NAME, COUNT(BELEG_NR) AS BELEGE FROM PARTNER_LIEFERANT JOIN RECHNUNGEN ON(PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.AUSSTELLER_ID OR PARTNER_LIEFERANT.PARTNER_ID=RECHNUNGEN.EMPFAENGER_ID) WHERE PARTNER_LIEFERANT.AKTUELL = '1'  && RECHNUNGEN.AKTUELL = '1' GROUP BY PARTNER_ID ORDER BY COUNT(BELEG_NR)  DESC, PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<p class=\"objekt_auswahl\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BELEG_NR) FROM RECHNUNGEN WHERE AKTUELL = '1' && (AUSSTELLER_ID='$p_id' OR EMPFAENGER_ID='$p_id')  ORDER BY PARTNER_NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1'  ORDER BY BELEG_NR DESC " . $navi->limit . "" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN.BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' AND RECHNUNGSTYP='Rechnung' OR RECHNUNGSTYP='Gutschrift'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT BELEG_NR FROM RECHNUNGEN WHERE BELEG_NR NOT IN (  SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE AKTUELL='1') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM RECHNUNGEN WHERE BELEG_NR NOT IN (  SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE AKTUELL='1') && AKTUELL='1' ORDER BY BELEG_NR DESC  $navi->limit" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN.BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL='1' ORDER BY BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT SUM( MENGE ) AS ERFASSTE_MENGE FROM `RECHNUNGEN_POSITIONEN` WHERE BELEG_NR = '$belegnr' && AKTUELL='1' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MWST_SATZ FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$position' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['MWST_SATZ'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE RECHNUNGSNUMMER = '$clean_arr[rechnungsnummer]' && RECHNUNGSDATUM = '$rechnungsdatum' && AUSSTELLER_TYP='$rechnungs_aussteller_typ' && AUSSTELLER_ID='$rechnungs_aussteller_id' && EMPFAENGER_TYP='$rechnungs_empfaenger_typ' && EMPFAENGER_ID='$rechnungs_empfaenger_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$rechnungs_typ', '$rechnungsdatum','$eingangsdatum', '$netto_betrag','$brutto_betrag','0.00', '$rechnungs_aussteller_typ', '$rechnungs_aussteller_id','$rechnungs_empfaenger_typ', '$rechnungs_empfaenger_id','1', '1', '0', '0', '1', '$status_bezahlt', '0', '$faellig_am', '$bezahlt_am', '$kurzbeschreibung', '$clean_arr[geld_konto]')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$this->rechnungs_typ_druck', '$rechnungsdatum_sql','$eingangsdatum', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$this->rechnungs_aussteller_typ', '$this->rechnungs_aussteller_id','$this->rechnungs_empfaenger_typ', '$this->rechnungs_empfaenger_id','1', '1', '1', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$kurzbeschreibung', '$empfangs_geld_konto')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE RECHNUNGSNUMMER = '$rechnungsnummer' && RECHNUNGSDATUM = '$rechnungsdatum' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' && EMPFAENGER_TYP='$empfaenger_typ' && EMPFAENGER_ID='$empfaenger_id' && AKTUELL = '1' && RECHNUNGSTYP='$rechnungs_typ'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result_3 = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE RECHNUNGSNUMMER = '$clean_arr[rechnungsnummer]' && RECHNUNGSDATUM = '$rechnungsdatum' && AUSSTELLER_TYP='$clean_arr[Aussteller_typ]' && AUSSTELLER_ID='$clean_arr[Aussteller]' && EMPFAENGER_TYP='$clean_arr[Empfaenger_typ]' && EMPFAENGER_ID='$clean_arr[Empfaenger]' && AKTUELL = '1' && RECHNUNGSTYP='$this->rechnungs_typ_druck'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows_3 = mysql_numrows ( $result_3 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$this->rechnungs_typ_druck', '$rechnungsdatum','$eingangsdatum', '$netto_betrag','$brutto_betrag','$brutto_betrag', '$skonto', '$clean_arr[Aussteller_typ]', '$clean_arr[Aussteller_id]','$clean_arr[Empfaenger_typ]', '$clean_arr[Empfaenger_id]','1', '1', '1', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$kurzbeschreibung', '$clean_arr[empfangs_geld_konto]')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNG_ID FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$typ' ORDER BY RECHNUNG_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [RECHNUNG_ID];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && (RECHNUNGSTYP='$rechnungs_typ' OR RECHNUNGSTYP='Gutschrift' OR RECHNUNGSTYP='Stornorechnung'  OR RECHNUNGSTYP='Schlussrechnung'  OR RECHNUNGSTYP='Teilrechnung') && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && RECHNUNGSTYP='$rechnungs_typ' && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && RECHNUNGSTYP='$rechnungs_typ' && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && (RECHNUNGSTYP='$rechnungs_typ' OR RECHNUNGSTYP='Gutschrift' OR RECHNUNGSTYP='Stornorechnung' OR RECHNUNGSTYP='Schlussrechnung'  OR RECHNUNGSTYP='Teilrechnung') && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && RECHNUNGSTYP='$rechnungs_typ' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && RECHNUNGSTYP='$rechnungs_typ'  && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR FROM RECHNUNGEN ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['BELEG_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR FROM RECHNUNGEN WHERE AUSSTELLER_TYP='Partner' && AUSSTELLER_ID='$aussteller_id' && EMPFAENGER_ID='$empfaenger_id' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row [BELEG_NR];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $rr->update_nettobetrag ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        $rr->update_bruttobetrag ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $rr->update_bruttobetrag ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_skontobetrag($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        $rr = new rechnungen ();
        \end_layout
            \begin_layout Plain Layout
        $betrag = nummer_komma2punkt ( nummer_punkt2komma ( $rr->summe_skonto_positionen ( $beleg_nr ) ) );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE RECHNUNGEN SET SKONTOBETRAG='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function summe_netto_positionen($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE RECHNUNGEN SET NETTO='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function summe_brutto_positionen($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM((MENGE*PREIS/100)*(100+MWST_SATZ) ) AS BRUTTO FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_bruttobetrag($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        $rr = new rechnungen ();
        \end_layout
            \begin_layout Plain Layout
        $rr->update_bruttobetrag ( $beleg_nr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $rr->update_bruttobetrag ( $beleg_nr );
        \end_layout
            \begin_layout Plain Layout
        // $betrag = nummer_komma2punkt(nummer_punkt2komma($this->summe_brutto_positionen($beleg_nr)));
        \end_layout
            \begin_layout Plain Layout
        // mysql_query ("UPDATE RECHNUNGEN SET BRUTTO='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, MENGE, GESAMT_NETTO  FROM `RECHNUNGEN_POSITIONEN` WHERE `U_BELEG_NR` = '$u_beleg_nr' AND `BELEG_NR` != '$u_beleg_nr' && ARTIKEL_NR='$art_nr' && `ART_LIEFERANT`='$partner_id' && AKTUELL='1' ORDER BY BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_gsumme_positionen() {
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $abfrage = "UPDATE RECHNUNGEN_POSITIONEN AS t1
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE RECHNUNGEN_POSITIONEN SET AKTUELL='0' WHERE BELEG_NR='$belegnr' && AKTUELL='1' && POSITION='$pos'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, ART_LIEFERANT  FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$beleg_nr' && POSITION='$position' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET EMPFANGS_GELD_KONTO='$empfangs_geld_konto' WHERE BELEG_NR='$belegnr' && AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $zahlungs_datum = date_german2mysql ( $this->bezahlt_am );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET EMPFANGS_GELD_KONTO='$empfangs_geld_konto', STATUS_ZAHLUNG_FREIGEGEBEN='1', STATUS_BEZAHLT='1', BEZAHLT_AM='$zahlungs_datum'  WHERE BELEG_NR='$belegnr' && AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        echo "Dem Beleg $belegnr wurde die Kontonummer des Rechnungsausteller hinzugefügt<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$a', '$belegnr','$this->rechnungs_aussteller_id','" . $_POST ['positionen'] [$a] ['artikel_nr'] . "', '$pos_menge','$pos_preis','$pos_mwst_satz', '$pos_rabatt', '$pos_gesamt_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a wurde gespeichert <br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$a', '$belegnr','$neue_artikel_nr', '" . $_POST ['positionen'] [$a] ['menge'] . "','$pos_preis','$pos_mwst_satz', '$pos_rabatt', '$pos_gesamt_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a ($neue_artikel_nr) " . $_POST ['positionen'] [$a] ['bezeichnung'] . " wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$zeile', '$belegnr', '$u_beleg_nr','$ursprungs_art_lieferant','$ursprungs_artikel_nr', '$menge','$einzel_preis','$mwst_satz', '$pos_rabatt_satz', '$skonto', '$gpreis','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Position $a ($neue_artikel_nr) ".$positionen[$a]['bezeichnung']." wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ARTIKEL_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ART_LIEFERANT FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ART_LIEFERANT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_VOLLSTAENDIG='1' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_VOLLSTAENDIG='0', STATUS_ZUGEWIESEN='0' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_ZUGEWIESEN='1' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_ZAHLUNG_FREIGEGEBEN='1' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_BEZAHLT='1', BEZAHLT_AM='$datum' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN_POS_ID FROM RECHNUNGEN_POSITIONEN ORDER BY RECHNUNGEN_POS_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['RECHNUNGEN_POS_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$beleg_nr' && AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE LTRIM(RTRIM(RECHNUNGSNUMMER)) = '$rnr' && AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller' && AUSSTELLER_TYP='Partner' && AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empfaengertyp' && EMPFAENGER_ID='$id' && AKTUELL = '1' ORDER BY EMPFAENGER_EINGANGS_RNR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger' && EMPFAENGER_TYP='Partner' && AUSSTELLER_ID='$aussteller' && AUSSTELLER_TYP='Partner' && AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM((GESAMT_NETTO/100)*(100+MWST_SATZ)) AS SUMME FROM `RECHNUNGEN_POSITIONEN` WHERE `U_BELEG_NR`!=`BELEG_NR` && `U_BELEG_NR` = '$belegnr' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['SUMME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' ORDER BY EMPFAENGER_EINGANGS_RNR DESC<hr>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT RECHNUNGSNUMMER, RECHNUNGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, U_BELEG_NR, POSITION, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS
        \end_layout
            \begin_layout Plain Layout
        FROM `RECHNUNGEN_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `ARTIKEL_NR` LIKE '%$artikel_nr%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT R_BELEG_ID, POS, ARTIKEL_NR, PREIS, MENGE, ART_LIEFERANT FROM `FENSTER_LIEFERUNG`, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE R_BELEG_ID=BELEG_NR && POS=POSITION" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $az = mysql_numrows ( $result ); // az = anzahl zeilen
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM `RECHNUNGEN` WHERE `RECHNUNGSTYP` IN ('Rechnung') AND `EMPFAENGER_TYP` = 'Partner' AND `EMPFAENGER_ID` = '$p_id' AND `AKTUELL` = '1' AND `STATUS_BESTAETIGT` = '0' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' ORDER BY `RECHNUNGEN`.`NETTO`  DESC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT * FROM `RECHNUNGEN` WHERE `RECHNUNGSTYP` IN ('Rechnung') AND `AUSSTELLER_TYP` = 'Partner' AND `AUSSTELLER_ID` = '$p_id' AND `AKTUELL` = '1' AND `STATUS_BEZAHLT` = '0' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' ORDER BY `RECHNUNGEN`.`NETTO`  DESC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->update_bruttobetrag ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        // die("UPDATE FERTIG");
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->update_bruttobetrag ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // die($row[RECHNUNGSNUMMER]);
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO  * ( (100 + MWST_SATZ) /100 ) * ((100-SKONTO)/100 ) )  AS SKONTO_BETRAG  FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // die("SKONTIERT $row[SKONTO_BETRAG]");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `KONTIERUNG_POSITIONEN` JOIN RECHNUNGEN ON (KONTIERUNG_POSITIONEN.BELEG_NR=RECHNUNGEN.BELEG_NR) WHERE `KOSTENTRAEGER_TYP` = '$kos_typ' AND `KOSTENTRAEGER_ID` = '$kos_id' AND KONTIERUNG_POSITIONEN.AKTUELL = '1' AND RECHNUNGEN.AKTUELL = '1' AND RECHNUNGEN.EMPFAENGER_TYP='PARTNER' && RECHNUNGEN.EMPFAENGER_ID='$partner_id' && KONTENRAHMEN_KONTO='$kostenkonto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE RECHNUNGEN SET SKONTOBETRAG='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function summe_netto_positionen($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO) AS NETTO_BETRAG FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['NETTO_BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE RECHNUNGEN SET NETTO='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function summe_brutto_positionen($beleg_nr) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO * ( ( 100 + MWST_SATZ ) /100 ))  AS BRUTTO  FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // die("BRUTTO $beleg_nr $row[BRUTTO]");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE RECHNUNGEN SET BRUTTO='$betrag' WHERE BELEG_NR='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function rechnungs_kuerzel_ermitteln($austeller_typ, $aussteller_id, $datum) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POSITION FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function drop_rechnungs_typen($beschreibung, $name, $id, $js, $selected_value) {
        \end_layout
            \begin_layout Plain Layout
        $enum_arr = $this->enum_typen_arr ( 'RECHNUNGEN', 'RECHNUNGSTYP' );
        \end_layout
            \begin_layout Plain Layout
        if (is_array ( $enum_arr )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ART_LIEFERANT FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_BEZAHLT='1', BEZAHLT_AM='$datum' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET STATUS_BESTAETIGT='1', BEZAHLT_AM='$datum' WHERE BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN SET AKTUELL='0' WHERE RECHNUNG_DAT='$rechnung_dat' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$belegnr', '$rechnungsnummer', '$a_ausnr', '$e_einnr', '$rechnungs_typ', '$r_datum','$ein_datum', '$netto','$brutto','$skontobetrag',  '$aussteller_typ', '$aussteller_id','$empfaenger_typ', '$empfaenger_id', '1', '$stat_erfasst', '$stat_voll', '$stat_zugew', '$stat_z_frei', '$stat_bezahlt', '$stat_bezahlt', '$faellig_am', '$bezahlt_am', '$kurzb', '$empfangs_gkonto')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, $alt_dat );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID=AUSSTELLER_ID  && EMPFAENGER_TYP=AUSSTELLER_TYP && AUSSTELLER_ID='$p_id' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID=AUSSTELLER_ID  && EMPFAENGER_TYP=AUSSTELLER_TYP  && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID=AUSSTELLER_ID  && EMPFAENGER_TYP=AUSSTELLER_TYP  && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID=AUSSTELLER_ID  && EMPFAENGER_TYP=AUSSTELLER_TYP && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' ORDER BY EMPFAENGER_EINGANGS_RNR DESC<hr>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER FROM RECHNUNGEN WHERE BELEG_NR='$beleg_nr' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$beleg_nr' && U_BELEG_NR IS NOT NULL && AKTUELL='1' GROUP BY U_BELEG_NR" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE U_BELEG_NR='$beleg_nr' && U_BELEG_NR IS NOT NULL && AKTUELL='1' GROUP BY U_BELEG_NR" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DAT FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' GROUP BY TEIL_R_ID ORDER BY TEIL_R_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' GROUP BY TEIL_R_ID ORDER BY TEIL_R_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', '$rechnungstyp', '$rechnungsdatum_sql','$rechnungsdatum_sql', '0.00','0.00','0.00', '$aussteller_typ', '$aussteller_id','$kos_typ_n', '$kos_id_n','1', '1', '1', '0', '1', '0', '0', '$f_datum_sql', '0000-00-00', '$kurzinfo', '$gk_id')";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, RECHNUNGSNUMMER, AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR $sort" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, RECHNUNGSNUMMER, AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR $sort" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, RECHNUNGSNUMMER, AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR $sort" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT BELEG_NR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aussteller_id' && AUSSTELLER_TYP='$aussteller_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' ORDER BY AUSTELLER_AUSGANGS_RNR $sort";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, RECHNUNGSNUMMER, AUSTELLER_AUSGANGS_RNR, EMPFAENGER_EINGANGS_RNR AS WE_NR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y' ) = '$jahr' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR $sort" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, RECHNUNGSNUMMER, AUSTELLER_AUSGANGS_RNR, EMPFAENGER_EINGANGS_RNR AS WE_NR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empfaenger_id' && EMPFAENGER_TYP='$empfaenger_typ' && DATE_FORMAT( RECHNUNGSDATUM, '%Y-%m' ) = '$jahr-$monat' && $r_sql && AKTUELL = '1' GROUP BY BELEG_NR ORDER BY EMPFAENGER_EINGANGS_RNR $sort" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, FORMAT((MENGE*PREIS/100)*(100-RABATT_SATZ),2) AS GESAMT_NETTO1 FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE RECHNUNGSTYP='Angebot' && AUSSTELLER_TYP='$aussteller_typ' && AUSSTELLER_ID='$aussteller_id' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['AUSTELLER_AUSGANGS_RNR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE RECHNUNGSTYP='Angebot' && EMPFAENGER_TYP='$empfaenger_typ' && EMPFAENGER_ID='$empfaenger_id' ORDER BY EMPFAENGER_EINGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['EMPFAENGER_EINGANGS_RNR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$id', '$ang_nr', '$n_ang_nr', '$n_empfaenger_rnr', 'Angebot', '$rechnungsdatum','$rechnungsdatum', '0.00','0.0','0.00', '$aussteller_typ', '$aussteller_id','$empfaenger_typ', '$empfaenger_id','1', '1', '0', '0', '1', '0', '0', '$rechnungsdatum', '$rechnungsdatum', '$kurzinfo', '9999999')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$id', '$ang_nr', '$n_ang_nr', '$n_empfaenger_rnr', 'Angebot', '$rechnungsdatum','$rechnungsdatum', '0.00','0.0','0.00', '$aussteller_typ', '$aussteller_id','$empfaenger_typ', '$empfaenger_id','1', '1', '0', '0', '1', '0', '0', '$rechnungsdatum', '$rechnungsdatum', '$kurzinfo', '9999999')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$beleg_nr', '$rnr', '$l_ausg_rnr', '$l_empf_e_nr', '$r_typ', '$r_datum_sql','$eingangsdatum_sql', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$aus_typ', '$aus_id','$empf_typ', '$empf_id','1', '1', '1', '0', '1', '0', '0', '$faellig', '0000-00-00', '$kurzinfo', '$empf_gk_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$r_typ aus UGL Importiert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$beleg_nr', '$rnr', '$l_ausg_rnr', '$l_empf_e_nr', '$r_typ', '$r_datum_sql','$eingangsdatum_sql', '$netto_betrag','$brutto_betrag','$skonto_betrag', '$aus_typ', '$aus_id','$empf_typ', '$empf_id','1', '1', '1', '0', '1', '0', '0', '$faellig', '0000-00-00', '$kurzinfo', '$empf_gk_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "$r_typ aus CSV Importiert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empf_id' && EMPFAENGER_TYP='$empf_typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && (RECHNUNGSTYP='$rechnungs_typ' OR RECHNUNGSTYP='Gutschrift' OR RECHNUNGSTYP='Stornorechnung' OR RECHNUNGSTYP='Schlussrechnung'  OR RECHNUNGSTYP='Teilrechnung') && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empf_id' && EMPFAENGER_TYP='$empf_typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && RECHNUNGSTYP='$rechnungs_typ'  && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EMPFAENGER_EINGANGS_RNR FROM RECHNUNGEN WHERE EMPFAENGER_ID='$empf_id' && EMPFAENGER_TYP='$empf_typ' && DATE_FORMAT(RECHNUNGSDATUM, '%Y') = '$jahr' && RECHNUNGSTYP='$rechnungs_typ'  && AKTUELL='1' ORDER BY BELEG_NR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && (RECHNUNGSTYP='$rechnungs_typ' OR RECHNUNGSTYP='Gutschrift' OR RECHNUNGSTYP='Stornorechnung' OR RECHNUNGSTYP='Schlussrechnung'  OR RECHNUNGSTYP='Teilrechnung') && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && RECHNUNGSTYP='$rechnungs_typ' && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT AUSTELLER_AUSGANGS_RNR FROM RECHNUNGEN WHERE AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSDATUM BETWEEN '$jahr-01-01' AND '$jahr-12-31' && RECHNUNGSTYP='$rechnungs_typ' && AKTUELL='1' ORDER BY AUSTELLER_AUSGANGS_RNR DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE  AKTUELL='1' && RECHNUNGSTYP='Angebot' ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $aussteller_id = $_SESSION ['partner_id'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE  AKTUELL='1' && RECHNUNGSTYP='Angebot' && AUSSTELLER_TYP='Partner' && AUSSTELLER_ID='$aussteller_id' ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$beleg_nr','$u_beleg_nr','$lieferant_id','$artikel_nr', '$menge','$preis','$mwst', '$rabatt', '$skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "<br><b>$db_abfrage</b>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR FROM RECHNUNGEN WHERE KURZBESCHREIBUNG='$kurzbeschreibung' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POSITION, U_BELEG_NR, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' && (RABATT_SATZ='99.99' OR SKONTO='9.99' OR RABATT_SATZ='999.99') ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET RABATT_SATZ='$u_rabatt', SKONTO='$skonto', GESAMT_NETTO='$neu_preis' WHERE POSITION='$_pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && ART_LIEFERANT='$art_lieferant' && ARTIKEL_NR='$art_nr' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $abfrage = "SELECT RECHNUNGEN . * , SUM(GESAMT_SUMME/100*(100-RABATT_SATZ)) AS SUMME_G
        \end_layout
            \begin_layout Plain Layout
        FROM `KONTIERUNG_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `KOSTENTRAEGER_TYP` LIKE '$kos_typ'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT POSITION, `ARTIKEL_NR`, MENGE, `PREIS`, `RABATT_SATZ`, `GESAMT_NETTO`, t1.BELEG_NR  FROM `RECHNUNGEN_POSITIONEN` as t1, RECHNUNGEN as t2 WHERE `ARTIKEL_NR` = '$art_nr' && t1.BELEG_NR=t2.BELEG_NR && t2.EMPFAENGER_TYP='$empf_typ' && t2.EMPFAENGER_ID='$empf_id' && t1.AKTUELL='1' && t2.AKTUELL='1' GROUP BY PREIS, RABATT_SATZ";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage.'<hr>';
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ); // or die(mysql_error());
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT POSITION, `ARTIKEL_NR`, MENGE, `PREIS`, `RABATT_SATZ`, `GESAMT_NETTO`, t1.BELEG_NR  FROM `RECHNUNGEN_POSITIONEN` as t1, RECHNUNGEN as t2 WHERE `ARTIKEL_NR` = '$art_nr' && t1.BELEG_NR=t2.BELEG_NR && t2.EMPFAENGER_TYP='$empf_typ' && t2.EMPFAENGER_ID='$empf_id' && t1.AKTUELL='1' && t2.AKTUELL='1' GROUP BY PREIS, RABATT_SATZ ORDER BY t1.BELEG_NR DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empf_typ' && EMPFAENGER_ID='$empf_id'  && AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSTYP='$r_typ' && AKTUELL = '1' ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empf_typ' && EMPFAENGER_ID='$empf_id'  && AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSTYP='$r_typ' && AKTUELL = '1' && BELEG_NR NOT IN (SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE AKTUELL='1')ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empf_typ' && EMPFAENGER_ID='$empf_id'  && AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSTYP='$r_typ' && AKTUELL = '1' && BELEG_NR  IN (SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE AKTUELL='1')ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_SCHLUSS VALUES (NULL, '$id', '$beleg_id', '$t_beleg_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, '' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_SCHLUSS SET AKTUELL='0' WHERE SCHLUSS_R_ID='$beleg_id' && TEIL_R_ID='$t_beleg_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN VALUES (NULL, '$letzte_belegnr', '$rechnungsnummer', '$letzte_aussteller_rnr', '$letzte_empfaenger_rnr', 'Rechnung', '$datum','$datum', '0','0.00','0.00', 'Partner', '$p_id','Partner', '$empf_p_id','1', '1', '0', '0', '1', '0', '0', '$faellig_am', '0000-00-00', '$r_org->kurzbeschreibung', '$gk->geldkonto_id')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$beleg_nr','$p_id', '$art_nr', $menge,'$preis','$mwst', '$rab','$skonto', '$preis_g','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN VALUES (NULL, '$last_b_id', '$profil_id', '$profil_bez','$profil_jahr', '$wirt_e', '$wirt_name', '$datum', '$anz_einheiten', '$qm_gesamt', '$qm_wohnraum', '$qm_gewerbe', '$anz_konten', '$anz_abrechnungen', '$ersteller', '$partner_id','$kontenrahmen_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_ABRECHNUNGEN_KONTEN VALUES (NULL, '$last_a_id', '$b_id','$bk_k_id','$konto','$konto_bez','$g_kosten','$g_kosten_wo','$g_kosten_ge', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_bk.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BK_EINZEL_ABRECHNUNGEN VALUES (NULL, '$last_e_id', '$b_id','$empf', '$zeitraum', '$mieternr', '$einheit_id','$einheit_name','$g_kosten','$g_hndl', '$vorschuss', '$saldo', '$saldo_art', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$beleg_nr','$beleg_nr','$lieferant_id','$artikel_nr', '$menge','$preis','$mwst', '$rabatt', '0.00', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AUSSTELLER_ID='$kos_id' && AUSSTELLER_TYP='$kos_typ' && AKTUELL = '1' ORDER BY BELEG_NR DESC LIMIT 0,$anzahl" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<label for=\"geld_konto_dropdown\">Ausgangsbeleg</label>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_ID='$kos_id' && EMPFAENGER_TYP='$kos_typ' && AKTUELL = '1' ORDER BY BELEG_NR DESC LIMIT 0,$anzahl" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        echo "<label for=\"geld_konto_dropdown\">Eingangsbeleg</label>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_in_rechnung_gestellt FROM RECHNUNGEN WHERE AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_aus_rechnung_erhalten FROM RECHNUNGEN WHERE AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='1' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kasse_direkt_gezahlt FROM RECHNUNGEN WHERE EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='1' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(SKONTOBETRAG) AS kassen_ausgaben_offen FROM RECHNUNGEN WHERE EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='0' && AKTUELL = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZAHLT_AM, BELEG_NR,  EMPFAENGER_TYP, EMPFAENGER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='1' ORDER BY BEZAHLT_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FAELLIG_AM, BELEG_NR,  EMPFAENGER_TYP, EMPFAENGER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && AUSSTELLER_TYP='Kasse' && AUSSTELLER_ID='$kassen_id' && STATUS_BEZAHLT='0' ORDER BY FAELLIG_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BEZAHLT_AM, BELEG_NR,  AUSSTELLER_TYP, AUSSTELLER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='1' ORDER BY BEZAHLT_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FAELLIG_AM, BELEG_NR,  AUSSTELLER_TYP, AUSSTELLER_ID, NETTO, BRUTTO, SKONTOBETRAG FROM `RECHNUNGEN` WHERE AKTUELL = '1' && EMPFAENGER_TYP='Kasse' && EMPFAENGER_ID='$kassen_id' && STATUS_BEZAHLT='0' ORDER BY FAELLIG_AM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND EMPFAENGER_TYP='Kasse' AND EMPFAENGER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND EMPFAENGER_TYP='Kasse' AND EMPFAENGER_ID='$kassen_id' ORDER BY BELEG_NR DESC " . $navi->limit . "" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND AUSSTELLER_TYP='Kasse' AND AUSSTELLER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND AUSSTELLER_TYP='Kasse' AND AUSSTELLER_ID='$kassen_id' ORDER BY BELEG_NR DESC " . $navi->limit . "" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT RECHNUNGSNUMMER, RECHNUNGEN_POSITIONEN.BELEG_NR, U_BELEG_NR, POSITION, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS, SKONTO, MWST_SATZ, GESAMT_NETTO, (GESAMT_NETTO/100)*(100+MWST_SATZ) AS BRUTTO, (GESAMT_NETTO/100)*(100+MWST_SATZ) /100 * (100-SKONTO) AS SKONTIERT
        \end_layout
            \begin_layout Plain Layout
        FROM `RECHNUNGEN_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `ARTIKEL_NR` LIKE '$artikel_nr'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `RECHNUNGEN_POSITIONEN`	WHERE  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR, BELEG_NR ORDER BY BELEG_NR DESC, POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR, BELEG_NR ORDER BY BELEG_NR DESC, POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `RECHNUNGEN_POSITIONEN`	WHERE   `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' 	&&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR,  BELEG_NR  ORDER BY BELEG_NR DESC,  POSITION ASC LIMIT 0,$limit" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR,  BELEG_NR  ORDER BY BELEG_NR DESC,  POSITION ASC LIMIT 0,$limit" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(MENGE) AS G_MENGE FROM  `RECHNUNGEN_POSITIONEN`	WHERE ARTIKEL_NR='$art_nr' &&  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, SUM(MENGE) AS G_MENGE, ARTIKEL_NR  FROM  `RECHNUNGEN_POSITIONEN`	WHERE  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1') GROUP BY ARTIKEL_NR ORDER BY G_MENGE DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1') GROUP BY ARTIKEL_NR ORDER BY G_MENGE DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSTYP  FROM  RECHNUNGEN WHERE AKTUELL = '1' && BELEG_NR='$erfass_nr' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_partners.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT  `AUSSTELLER_TYP` , AUSSTELLER_ID, SUM( NETTO ) AS NETTO, SUM( BRUTTO ) AS BRUTTO
        \end_layout
            \begin_layout Plain Layout
        FROM  `RECHNUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE  `RECHNUNGSTYP` =  'RECHNUNG'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
RECHNUNGEN_POSITIONEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `RECHNUNGEN_POSITIONEN` (

\end_layout
\begin_layout Plain Layout

  `RECHNUNGEN_POS_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `RECHNUNGEN_POS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POSITION` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `U_BELEG_NR` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `ART_LIEFERANT` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ARTIKEL_NR` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MENGE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PREIS` decimal(10,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MWST_SATZ` int(2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RABATT_SATZ` decimal(5,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SKONTO` decimal(3,2) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `GESAMT_NETTO` decimal(10,4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`RECHNUNGEN_POS_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BELEG_NR` (`BELEG_NR`),

\end_layout
\begin_layout Plain Layout

  KEY `U_BELEG_NR` (`U_BELEG_NR`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`),

\end_layout
\begin_layout Plain Layout

  KEY `POSITION` (`POSITION`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=179300 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
RECHNUNGEN_POS_DAT 
\end_layout
\begin_layout Description
RECHNUNGEN_POS_ID 
\end_layout
\begin_layout Description
POSITION 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
U_BELEG_NR 
\end_layout
\begin_layout Description
ART_LIEFERANT 
\end_layout
\begin_layout Description
ARTIKEL_NR 
\end_layout
\begin_layout Description
MENGE 
\end_layout
\begin_layout Description
PREIS 
\end_layout
\begin_layout Description
MWST_SATZ 
\end_layout
\begin_layout Description
RABATT_SATZ 
\end_layout
\begin_layout Description
SKONTO 
\end_layout
\begin_layout Description
GESAMT_NETTO 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis', RABATT_SATZ='$rabatt' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis', SKONTO='$skonto' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$belegnr','$belegnr','$lieferant_id','$artikel_nr', '$menge','$preis','$pos_mwst', '$rabatt', '$pos_skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "$letzte_rech_pos_id $pos $belegnr $lieferant_id";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$belegnr', '$belegnr', '$lieferant_id','$artikel_nr', '$menge','$preis','$pos_mwst', '$rabatt', '$pos_skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "$letzte_rech_pos_id $pos $belegnr $lieferant_id";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '1', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', '1','$netto_betrag','19', '0','0', '$netto_betrag','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$letzte_belegnr','$p_id', '$art_nr', $menge,'$netto_betrag','19', '0','0', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN.BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' AND RECHNUNGSTYP='Rechnung' OR RECHNUNGSTYP='Gutschrift'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT BELEG_NR FROM RECHNUNGEN WHERE BELEG_NR NOT IN (  SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE AKTUELL='1') && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows1 = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT * FROM RECHNUNGEN WHERE BELEG_NR NOT IN (  SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE AKTUELL='1') && AKTUELL='1' ORDER BY BELEG_NR DESC  $navi->limit" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        FROM RECHNUNGEN, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && RECHNUNGEN.AKTUELL='1' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN.BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT SUM( MENGE ) AS ERFASSTE_MENGE FROM `RECHNUNGEN_POSITIONEN` WHERE BELEG_NR = '$belegnr' && AKTUELL='1' " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MWST_SATZ FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$position' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['MWST_SATZ'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $numrows;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM((MENGE*PREIS/100)*(100+MWST_SATZ) ) AS BRUTTO FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, MENGE, GESAMT_NETTO  FROM `RECHNUNGEN_POSITIONEN` WHERE `U_BELEG_NR` = '$u_beleg_nr' AND `BELEG_NR` != '$u_beleg_nr' && ARTIKEL_NR='$art_nr' && `ART_LIEFERANT`='$partner_id' && AKTUELL='1' ORDER BY BELEG_NR ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_gsumme_positionen() {
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $abfrage = "UPDATE RECHNUNGEN_POSITIONEN AS t1
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE RECHNUNGEN_POSITIONEN SET AKTUELL='0' WHERE BELEG_NR='$belegnr' && AKTUELL='1' && POSITION='$pos'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR, ART_LIEFERANT  FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$beleg_nr' && POSITION='$position' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$a', '$belegnr','$this->rechnungs_aussteller_id','" . $_POST ['positionen'] [$a] ['artikel_nr'] . "', '$pos_menge','$pos_preis','$pos_mwst_satz', '$pos_rabatt', '$pos_gesamt_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a wurde gespeichert <br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$a', '$belegnr','$neue_artikel_nr', '" . $_POST ['positionen'] [$a] ['menge'] . "','$pos_preis','$pos_mwst_satz', '$pos_rabatt', '$pos_gesamt_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Position $a ($neue_artikel_nr) " . $_POST ['positionen'] [$a] ['bezeichnung'] . " wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$zeile', '$belegnr', '$u_beleg_nr','$ursprungs_art_lieferant','$ursprungs_artikel_nr', '$menge','$einzel_preis','$mwst_satz', '$pos_rabatt_satz', '$skonto', '$gpreis','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Position $a ($neue_artikel_nr) ".$positionen[$a]['bezeichnung']." wurde gespeichert<br>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ARTIKEL_NR FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ARTIKEL_NR'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ART_LIEFERANT FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ART_LIEFERANT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN_POS_ID FROM RECHNUNGEN_POSITIONEN ORDER BY RECHNUNGEN_POS_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['RECHNUNGEN_POS_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM((GESAMT_NETTO/100)*(100+MWST_SATZ)) AS SUMME FROM `RECHNUNGEN_POSITIONEN` WHERE `U_BELEG_NR`!=`BELEG_NR` && `U_BELEG_NR` = '$belegnr' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['SUMME'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT RECHNUNGSNUMMER, RECHNUNGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, U_BELEG_NR, POSITION, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS
        \end_layout
            \begin_layout Plain Layout
        FROM `RECHNUNGEN_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `ARTIKEL_NR` LIKE '%$artikel_nr%'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT R_BELEG_ID, POS, ARTIKEL_NR, PREIS, MENGE, ART_LIEFERANT FROM `FENSTER_LIEFERUNG`, RECHNUNGEN_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        WHERE R_BELEG_ID=BELEG_NR && POS=POSITION" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGSNUMMER, RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum_bis' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $az = mysql_numrows ( $result ); // az = anzahl zeilen
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "SET SQL_BIG_SELECTS=1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, COUNT( RECHNUNGEN_POSITIONEN.MENGE) AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR ORDER BY BEZEICHNUNG");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_lager.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR  ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && EINGANGSDATUM<='$datum' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1'  GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY RECHNUNGEN.EINGANGSDATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT RECHNUNGEN.EINGANGSDATUM, RECHNUNGEN_POSITIONEN.BELEG_NR, POSITION, BEZEICHNUNG, RECHNUNGEN_POSITIONEN.ART_LIEFERANT, RECHNUNGEN_POSITIONEN.ARTIKEL_NR, RECHNUNGEN_POSITIONEN.MENGE AS GEKAUFTE_MENGE, RECHNUNGEN_POSITIONEN.PREIS, RECHNUNGEN_POSITIONEN.MWST_SATZ FROM RECHNUNGEN RIGHT JOIN (RECHNUNGEN_POSITIONEN, POSITIONEN_KATALOG) ON ( RECHNUNGEN.BELEG_NR = RECHNUNGEN_POSITIONEN.BELEG_NR && POSITIONEN_KATALOG.ART_LIEFERANT = RECHNUNGEN_POSITIONEN.ART_LIEFERANT && RECHNUNGEN_POSITIONEN.ARTIKEL_NR = POSITIONEN_KATALOG.ARTIKEL_NR ) WHERE EMPFAENGER_TYP = 'Lager' && EMPFAENGER_ID = '$lager_id' && RECHNUNGEN_POSITIONEN.AKTUELL='1' && RECHNUNGEN.AKTUELL='1' GROUP BY RECHNUNGEN_POSITIONEN.ARTIKEL_NR, BELEG_NR ORDER BY BEZEICHNUNG ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO  * ( (100 + MWST_SATZ) /100 ) * ((100-SKONTO)/100 ) )  AS SKONTO_BETRAG  FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // die("SKONTIERT $row[SKONTO_BETRAG]");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO) AS NETTO_BETRAG FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['NETTO_BETRAG'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(GESAMT_NETTO * ( ( 100 + MWST_SATZ ) /100 ))  AS BRUTTO  FROM RECHNUNGEN_POSITIONEN WHERE `BELEG_NR`='$beleg_nr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        // die("BRUTTO $beleg_nr $row[BRUTTO]");
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POSITION FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ART_LIEFERANT FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$beleg_nr' && U_BELEG_NR IS NOT NULL && AKTUELL='1' GROUP BY U_BELEG_NR" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR FROM RECHNUNGEN_POSITIONEN WHERE U_BELEG_NR='$beleg_nr' && U_BELEG_NR IS NOT NULL && AKTUELL='1' GROUP BY U_BELEG_NR" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, FORMAT((MENGE*PREIS/100)*(100-RABATT_SATZ),2) AS GESAMT_NETTO1 FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows < 1) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$beleg_nr','$u_beleg_nr','$lieferant_id','$artikel_nr', '$menge','$preis','$mwst', '$rabatt', '$skonto', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        // echo "<br><b>$db_abfrage</b>";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT POSITION, U_BELEG_NR, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && AKTUELL='1' && (RABATT_SATZ='99.99' OR SKONTO='9.99' OR RABATT_SATZ='999.99') ORDER BY POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET RABATT_SATZ='$u_rabatt', SKONTO='$skonto', GESAMT_NETTO='$neu_preis' WHERE POSITION='$_pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && POSITION='$pos' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN_POSITIONEN WHERE BELEG_NR='$belegnr' && ART_LIEFERANT='$art_lieferant' && ARTIKEL_NR='$art_nr' && AKTUELL='1' ORDER BY RECHNUNGEN_POS_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_POSITIONEN SET GESAMT_NETTO='$gpreis' WHERE POSITION='$pos' && BELEG_NR='$belegnr' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT POSITION, `ARTIKEL_NR`, MENGE, `PREIS`, `RABATT_SATZ`, `GESAMT_NETTO`, t1.BELEG_NR  FROM `RECHNUNGEN_POSITIONEN` as t1, RECHNUNGEN as t2 WHERE `ARTIKEL_NR` = '$art_nr' && t1.BELEG_NR=t2.BELEG_NR && t2.EMPFAENGER_TYP='$empf_typ' && t2.EMPFAENGER_ID='$empf_id' && t1.AKTUELL='1' && t2.AKTUELL='1' GROUP BY PREIS, RABATT_SATZ";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage.'<hr>';
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ); // or die(mysql_error());
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT POSITION, `ARTIKEL_NR`, MENGE, `PREIS`, `RABATT_SATZ`, `GESAMT_NETTO`, t1.BELEG_NR  FROM `RECHNUNGEN_POSITIONEN` as t1, RECHNUNGEN as t2 WHERE `ARTIKEL_NR` = '$art_nr' && t1.BELEG_NR=t2.BELEG_NR && t2.EMPFAENGER_TYP='$empf_typ' && t2.EMPFAENGER_ID='$empf_id' && t1.AKTUELL='1' && t2.AKTUELL='1' GROUP BY PREIS, RABATT_SATZ ORDER BY t1.BELEG_NR DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$pos', '$letzte_belegnr', '$beleg_nr','$p_id', '$art_nr', $menge,'$preis','$mwst', '$rab','$skonto', '$preis_g','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_POSITIONEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_POSITIONEN VALUES (NULL, '$letzte_rech_pos_id', '$last_pos', '$beleg_nr','$beleg_nr','$lieferant_id','$artikel_nr', '$menge','$preis','$mwst', '$rabatt', '0.00', '$g_netto','1')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND EMPFAENGER_TYP='Kasse' AND EMPFAENGER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    kasse_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE AKTUELL = '1' AND RECHNUNGSTYP='Kassenbeleg' AND AUSSTELLER_TYP='Kasse' AND AUSSTELLER_ID='$kassen_id' ORDER BY BELEG_NR DESC" );
        \end_layout
            \begin_layout Plain Layout
        /*
        \end_layout
            \begin_layout Plain Layout
        * $result = mysql_query ("SELECT RECHNUNGEN. * , COUNT( RECHNUNGEN_POSITIONEN.POSITION ) AS ANZAHL_POSITIONEN
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT RECHNUNGSNUMMER, RECHNUNGEN_POSITIONEN.BELEG_NR, U_BELEG_NR, POSITION, ART_LIEFERANT, ARTIKEL_NR, MENGE, PREIS, SKONTO, MWST_SATZ, GESAMT_NETTO, (GESAMT_NETTO/100)*(100+MWST_SATZ) AS BRUTTO, (GESAMT_NETTO/100)*(100+MWST_SATZ) /100 * (100-SKONTO) AS SKONTIERT
        \end_layout
            \begin_layout Plain Layout
        FROM `RECHNUNGEN_POSITIONEN` , RECHNUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE `ARTIKEL_NR` LIKE '$artikel_nr'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `RECHNUNGEN_POSITIONEN`	WHERE  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR, BELEG_NR ORDER BY BELEG_NR DESC, POSITION ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `RECHNUNGEN_POSITIONEN`	WHERE   `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' 	&&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` =  'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')
        \end_layout
            \begin_layout Plain Layout
        GROUP BY ARTIKEL_NR,  BELEG_NR  ORDER BY BELEG_NR DESC,  POSITION ASC LIMIT 0,$limit" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(MENGE) AS G_MENGE FROM  `RECHNUNGEN_POSITIONEN`	WHERE ARTIKEL_NR='$art_nr' &&  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_katalog.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BELEG_NR, SUM(MENGE) AS G_MENGE, ARTIKEL_NR  FROM  `RECHNUNGEN_POSITIONEN`	WHERE  `ART_LIEFERANT` ='$partner_id' AND  `AKTUELL` =  '1' &&
        \end_layout
            \begin_layout Plain Layout
        BELEG_NR IN(SELECT BELEG_NR FROM  `RECHNUNGEN` WHERE  `AUSSTELLER_TYP` = 'Partner' AND  `AUSSTELLER_ID` ='$partner_id' AND  `AKTUELL` =  '1') GROUP BY ARTIKEL_NR ORDER BY G_MENGE DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
RECHNUNGEN_SCHLUSS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `RECHNUNGEN_SCHLUSS` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SCHLUSS_R_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEIL_R_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
SCHLUSS_R_ID 
\end_layout
\begin_layout Description
TEIL_R_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DAT FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' GROUP BY TEIL_R_ID ORDER BY TEIL_R_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE SCHLUSS_R_ID='$beleg_nr' && AKTUELL='1' GROUP BY TEIL_R_ID ORDER BY TEIL_R_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empf_typ' && EMPFAENGER_ID='$empf_id'  && AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSTYP='$r_typ' && AKTUELL = '1' && BELEG_NR NOT IN (SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE AKTUELL='1')ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM RECHNUNGEN WHERE EMPFAENGER_TYP='$empf_typ' && EMPFAENGER_ID='$empf_id'  && AUSSTELLER_ID='$aus_id' && AUSSTELLER_TYP='$aus_typ' && RECHNUNGSTYP='$r_typ' && AKTUELL = '1' && BELEG_NR  IN (SELECT TEIL_R_ID FROM RECHNUNGEN_SCHLUSS WHERE AKTUELL='1')ORDER BY RECHNUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO RECHNUNGEN_SCHLUSS VALUES (NULL, '$id', '$beleg_id', '$t_beleg_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, '' );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE RECHNUNGEN_SCHLUSS SET AKTUELL='0' WHERE SCHLUSS_R_ID='$beleg_id' && TEIL_R_ID='$t_beleg_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'RECHNUNGEN_SCHLUSS', $last_dat, $last_dat );
        \end_layout
            \begin_layout Plain Layout
        /* Ausgabe weil speichern erfolgreich */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
RECHNUNG_KUERZEL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `RECHNUNG_KUERZEL` (

\end_layout
\begin_layout Plain Layout

  `RK_DAT` int(4) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSSTELLER_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KUERZEL` varchar(20) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`RK_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=12 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
RK_DAT 
\end_layout
\begin_layout Description
AUSSTELLER_TYP 
\end_layout
\begin_layout Description
AUSSTELLER_ID 
\end_layout
\begin_layout Description
KUERZEL 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    berlussimo_class.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KUERZEL FROM RECHNUNG_KUERZEL WHERE AKTUELL = '1' && AUSSTELLER_TYP = '$austeller_typ' && AUSSTELLER_ID = '$aussteller_id' && ( VON <= '$datum' OR BIS >= '$datum' ) ORDER BY RK_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KUERZEL'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KUERZEL FROM RECHNUNG_KUERZEL WHERE AKTUELL = '1' && AUSSTELLER_TYP = '$austeller_typ' && AUSSTELLER_ID = '$aussteller_id' && ( VON <= '$datum' OR BIS >= '$datum' ) ORDER BY RK_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['KUERZEL'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
SEPA_KONTOS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_KONTOS` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BANKNAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGUENSTIGTER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
BANKNAME 
\end_layout
\begin_layout Description
BEGUENSTIGTER 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GELD_KONTEN.KONTO_ID, GELD_KONTEN.IBAN, GELD_KONTEN.BIC, GELD_KONTEN.BEGUENSTIGTER, GELD_KONTEN.KONTONUMMER, GELD_KONTEN.BLZ, GELD_KONTEN.INSTITUT, GELD_KONTEN.BEZEICHNUNG FROM GELD_KONTEN_ZUWEISUNG, GELD_KONTEN WHERE KOSTENTRAEGER_TYP = '$kos_typ' && KOSTENTRAEGER_ID = '$kos_id' && GELD_KONTEN.KONTO_ID = GELD_KONTEN_ZUWEISUNG.KONTO_ID && GELD_KONTEN_ZUWEISUNG.AKTUELL = '1' && GELD_KONTEN.AKTUELL = '1' GROUP BY GELD_KONTEN.KONTO_ID ORDER BY GELD_KONTEN.KONTO_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_KONTOS` WHERE `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' AND `AKTUELL` = '1' ORDER BY BEGUENSTIGTER";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
SEPA_MANDATE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_MANDATE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `M_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_REFERENZ` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GLAEUBIGER_ID` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GLAEUBIGER_GK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGUENSTIGTER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NAME` varchar(150) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANSCHRIFT` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTONR` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BLZ` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BANKNAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_UDATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_ADATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_EDATUM` date NOT NULL DEFAULT '9999-12-31',

\end_layout
\begin_layout Plain Layout

  `M_ART` enum('EINMALIG','WIEDERKEHREND') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NUTZUNGSART` enum('MIETZAHLUNG','RECHNUNGEN','HAUSGELD') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINZUGSART` enum('Aktuelles Saldo komplett','Nur die Summe aus Vertrag','Ratenzahlung') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=612 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
M_ID 
\end_layout
\begin_layout Description
M_REFERENZ 
\end_layout
\begin_layout Description
GLAEUBIGER_ID 
\end_layout
\begin_layout Description
GLAEUBIGER_GK_ID 
\end_layout
\begin_layout Description
BEGUENSTIGTER 
\end_layout
\begin_layout Description
NAME 
\end_layout
\begin_layout Description
ANSCHRIFT 
\end_layout
\begin_layout Description
KONTONR 
\end_layout
\begin_layout Description
BLZ 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
BANKNAME 
\end_layout
\begin_layout Description
M_UDATUM 
\end_layout
\begin_layout Description
M_ADATUM 
\end_layout
\begin_layout Description
M_EDATUM 
\end_layout
\begin_layout Description
M_ART 
\end_layout
\begin_layout Description
NUTZUNGSART 
\end_layout
\begin_layout Description
EINZUGSART 
\end_layout
\begin_layout Description
M_KOS_TYP 
\end_layout
\begin_layout Description
M_KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$m_r', '$g_id', '$g_gk_id', '$beg', '$name', '$ans', '$kto', '$blz', '$iban', '$bic', '$bank', '$m_udatum', '$m_adatum', '9999-12-31', 'WIEDERKEHREND', 'MIETZAHLUNG', '$eart', 'MIETVERTRAG', '$mv_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' AND M_EDATUM>='$datum_heute' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $gk_id = $_SESSION ['geldkonto_id'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' && M_EDATUM>='$datum_heute' && NUTZUNGSART='$nutzungsart' && GLAEUBIGER_GK_ID='$gk_id' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' AND M_EDATUM>='$datum_heute' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $gk_id = $_SESSION ['geldkonto_id'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' &&  M_EDATUM>='$datum_heute' AND NUTZUNGSART='$nutzungsart' && GLAEUBIGER_GK_ID='$gk_id' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' AND M_EDATUM>='$datum_heute' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $gk_id = $_SESSION ['geldkonto_id'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `AKTUELL` = '1' && NUTZUNGSART='$nutzungsart' AND M_EDATUM>='$datum_heute' && GLAEUBIGER_GK_ID='$gk_id' ORDER BY NAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `DAT` ='$dat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `M_REFERENZ` ='$m_ref' && AKTUELL='1' ORDER BY DAT LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_MANDATE` WHERE `M_REFERENZ` ='$m_ref' && AKTUELL='1' ORDER BY DAT LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `M_REFERENZ` = '$mref' AND M_EDATUM='9999-12-31' AND `AKTUELL` = '1' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM `SEPA_MANDATE` WHERE `M_REFERENZ` = '$mref' AND M_EDATUM='9999-12-31' AND `AKTUELL` = '1' LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE` WHERE `M_REFERENZ` = '$mref' AND `AKTUELL` = '1' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$mref', '$glaeubiger_id', '$gk_id', '$empf', '$name', '$anschrift', '$kto', '$blz', '$iban', '$bic', '$bankname', '$udatum', '$adatum', '$edatum', '$m_art', '$n_art', '$e_art', '$kos_typ', '$kos_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $sql ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE', $last_dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE `SEPA_MANDATE` SET AKTUELL='0' WHERE `DAT` = '$dat'" ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        ;
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE` VALUES (NULL, '$last_id', '$mref', '$glaeubiger_id', '$gk_id', '$empf', '$name', '$anschrift', '$kto', '$blz', '$iban', '$bic', '$bankname', '$udatum', '$adatum', '$edatum', '$m_art', '$n_art', '$e_art', '$kos_typ', '$kos_id', '1');";
        \end_layout
            \begin_layout Plain Layout
        // echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        echo "Mandat gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE_SEQ` VALUES (NULL, '$mref','$iban', '$seq', '$betrag', '$datei', '$datum', '$vzweck', '1');";
        \end_layout
            \begin_layout Plain Layout
        // echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE_SEQ', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Mandat gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' AND IBAN='$iban' && `AKTUELL` = '1' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' && `AKTUELL` = '1' LIMIT 0 , 1");
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' AND IBAN='$iban' AND `AKTUELL` = '1' ORDER BY DATUM" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' && DATUM='$datum' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI='$datei'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
SEPA_MANDATE_1_2_14
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_MANDATE_1_2_14` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `M_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_REFERENZ` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GLAEUBIGER_ID` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GLAEUBIGER_GK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGUENSTIGTER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NAME` varchar(150) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANSCHRIFT` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTONR` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BLZ` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BANKNAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_UDATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_ADATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_EDATUM` date NOT NULL DEFAULT '9999-12-31',

\end_layout
\begin_layout Plain Layout

  `M_ART` enum('EINMALIG','WIEDERKEHREND') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NUTZUNGSART` enum('MIETZAHLUNG','RECHNUNGEN','HAUSGELD') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINZUGSART` enum('Aktuelles Saldo komplett','Nur die Summe aus Vertrag','Ratenzahlung') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `M_KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=275 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
M_ID 
\end_layout
\begin_layout Description
M_REFERENZ 
\end_layout
\begin_layout Description
GLAEUBIGER_ID 
\end_layout
\begin_layout Description
GLAEUBIGER_GK_ID 
\end_layout
\begin_layout Description
BEGUENSTIGTER 
\end_layout
\begin_layout Description
NAME 
\end_layout
\begin_layout Description
ANSCHRIFT 
\end_layout
\begin_layout Description
KONTONR 
\end_layout
\begin_layout Description
BLZ 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
BANKNAME 
\end_layout
\begin_layout Description
M_UDATUM 
\end_layout
\begin_layout Description
M_ADATUM 
\end_layout
\begin_layout Description
M_EDATUM 
\end_layout
\begin_layout Description
M_ART 
\end_layout
\begin_layout Description
NUTZUNGSART 
\end_layout
\begin_layout Description
EINZUGSART 
\end_layout
\begin_layout Description
M_KOS_TYP 
\end_layout
\begin_layout Description
M_KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
SEPA_MANDATE_SEQ
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_MANDATE_SEQ` (

\end_layout
\begin_layout Plain Layout

  `ID` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `M_REFERENZ` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SEQ` varchar(4) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATEI` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK` varchar(140) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=8005 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ID 
\end_layout
\begin_layout Description
M_REFERENZ 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
SEQ 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
DATEI 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
VZWECK 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "INSERT INTO `SEPA_MANDATE_SEQ` VALUES (NULL, '$mref','$iban', '$seq', '$betrag', '$datei', '$datum', '$vzweck', '1');";
        \end_layout
            \begin_layout Plain Layout
        // echo "$sql<br>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_MANDATE_SEQ', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        // echo "Mandat gespeichert";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' AND IBAN='$iban' && `AKTUELL` = '1' LIMIT 0 , 1" );
        \end_layout
            \begin_layout Plain Layout
        // $result = mysql_query ("SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' && `AKTUELL` = '1' LIMIT 0 , 1");
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE `M_REFERENZ` = '$m_ref' AND IBAN='$iban' AND `AKTUELL` = '1' ORDER BY DATUM" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(BETRAG) AS ANZ, DATEI, SUM(BETRAG) AS SUMME, DATUM FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI LIKE '$vorz%' && DATUM='$datum' GROUP BY DATEI ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_MANDATE_SEQ` WHERE AKTUELL='1' && DATEI='$datei'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
SEPA_MANDATE_SEQ_03_frst
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_MANDATE_SEQ_03_frst` (

\end_layout
\begin_layout Plain Layout

  `ID` int(11) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `M_REFERENZ` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `SEQ` varchar(4) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATEI` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK` varchar(140) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=252 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ID 
\end_layout
\begin_layout Description
M_REFERENZ 
\end_layout
\begin_layout Description
SEQ 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
DATEI 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
VZWECK 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
SEPA_UEBERWEISUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SEPA_UEBERWEISUNG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FILE` varchar(50) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `KAT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK` varchar(144) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GK_ID_AUFTRAG` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IBAN` varchar(35) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIC` varchar(11) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BANKNAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGUENSTIGTER` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=29648 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
FILE 
\end_layout
\begin_layout Description
KAT 
\end_layout
\begin_layout Description
VZWECK 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
GK_ID_AUFTRAG 
\end_layout
\begin_layout Description
IBAN 
\end_layout
\begin_layout Description
BIC 
\end_layout
\begin_layout Description
BANKNAME 
\end_layout
\begin_layout Description
BEGUENSTIGTER 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
KONTO 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_personal.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM SEPA_UEBERWEISUNG WHERE FILE IS NULL && GK_ID_AUFTRAG ='$gk_id' && `AKTUELL` = '1' && VZWECK = '$vzweck' && KONTO='$konto' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweck', '$betrag', '$von_gk_id', '$sep->IBAN', '$sep->BIC', '$sep->bankname', '$sep->beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweck', '$betrag', '$von_gk_id', '$iban', '$bic', '$bank', '$empfaenger', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // echo "<hr>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE SEPA_UEBERWEISUNG SET FILE='$dateiname' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND GK_ID_AUFTRAG='$von_gk_id' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC LIMIT 0, 300" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC LIMIT 0, 300" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT FILE FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND GK_ID_AUFTRAG='$von_gk_id' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GK_ID_AUFTRAG, KAT, SUM(BETRAG) AS SUMME, COUNT(BETRAG) AS ANZ FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `AKTUELL` = '1' GROUP BY KAT, `GK_ID_AUFTRAG`" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT GK_ID_AUFTRAG, KAT, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `AKTUELL` = '1' GROUP BY KAT, `GK_ID_AUFTRAG`";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( BETRAG ) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `KOS_TYP` LIKE '$kos_typ' AND `KOS_ID` ='$kos_id' && KAT='$kat' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM( BETRAG ) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' && KAT='$kat' AND `AKTUELL` = '1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` = '$file' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweckn', '$betrag', '$von_gk_id', '$iban', '$bic', '$bankname', '$beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `SEPA_UEBERWEISUNG` WHERE `FILE` LIKE '$sepa_file' AND `BETRAG` = '$betrag' && GK_ID_AUFTRAG='$gk_id' && KOS_TYP='$kos_typ' &&  KOS_ID='$kos_id' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FILE, GK_ID_AUFTRAG, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE`='$file' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE SEPA_UEBERWEISUNG SET AKTUELL='0' WHERE DAT='$dat' && FILE IS NULL";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
SICH_EINBEHALT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `SICH_EINBEHALT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BELEG_NR` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PROZENT` decimal(2,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(7,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINBEHALT_BIS` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
BELEG_NR 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
PROZENT 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
EINBEHALT_BIS 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM SICH_EINBEHALT WHERE BELEG_NR='$beleg_nr' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM SICH_EINBEHALT ORDER BY EINBEHALT_BIS" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
START_STOP
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `START_STOP` (

\end_layout
\begin_layout Plain Layout

  `S_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `TAB` varchar(20) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TAB_DAT` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `START_TIME` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `END_TIME` timestamp NULL DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `UNTERBROCHEN` enum('1') DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`S_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
S_DAT 
\end_layout
\begin_layout Description
TAB 
\end_layout
\begin_layout Description
TAB_DAT 
\end_layout
\begin_layout Description
START_TIME 
\end_layout
\begin_layout Description
END_TIME 
\end_layout
\begin_layout Description
UNTERBROCHEN 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
STUNDENZETTEL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `STUNDENZETTEL` (

\end_layout
\begin_layout Plain Layout

  `ZETTEL_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ZETTEL_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BESCHREIBUNG` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ERFASSUNGSDATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ZETTEL_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3799 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ZETTEL_DAT 
\end_layout
\begin_layout Description
ZETTEL_ID 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
BESCHREIBUNG 
\end_layout
\begin_layout Description
ERFASSUNGSDATUM 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS STUNDEN  FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) WHERE `BENUTZER_ID` = '$mitarbeiter_id' AND STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$typ' && KOSTENTRAEGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS STUNDEN  FROM `STUNDENZETTEL_POS`  WHERE STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$typ' && KOSTENTRAEGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS G_STD FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM(DAUER_MIN)/60 AS STD, $preis*(SUM(DAUER_MIN)/60) AS LEISTUNG_EUR FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id' GROUP BY STUNDENZETTEL.BENUTZER_ID ORDER BY STD DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage.'<br>';
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( DAUER_MIN ) AS G_ZEIT FROM `STUNDENZETTEL_POS` WHERE `ZETTEL_ID` = '$zettel_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['G_ZEIT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID, STUNDENZETTEL.BENUTZER_ID, BESCHREIBUNG, ERFASSUNGSDATUM, benutzername, STUNDENSATZ, STUNDEN_PW  FROM STUNDENZETTEL JOIN  BENUTZER ON (STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id) WHERE ZETTEL_ID='$id' && AKTUELL = '1' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT COUNT(*) AS ZAHL FROM `STUNDENZETTEL` WHERE `BENUTZER_ID` = '$benutzer_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['ZAHL'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_dat' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID, BESCHREIBUNG, ERFASSUNGSDATUM FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY ERFASSUNGSDATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function stundenzettel_erfassen($zettel_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function stundenzettel_anlegen($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function stundenzettel_speichern($benutzer_id, $beschreibung) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $mein_letzerzettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id' && AKTUELL = '1' ORDER BY ZETTEL_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ZETTEL_ID FROM STUNDENZETTEL WHERE AKTUELL = '1' ORDER BY ZETTEL_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_ID FROM STUNDENZETTEL_POS WHERE AKTUELL = '1' ORDER BY ST_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES ('$dat', '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE STUNDENZETTEL_POS SET IN_BELEG='$erf_nr' WHERE ST_DAT='$st_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM STUNDENZETTEL WHERE BENUTZER_ID='$benutzer_id'  && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1' && (IN_BELEG != '0' OR IN_BELEG != NULL) LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && (IN_BELEG != '0' OR IN_BELEG != NULL) && AKTUELL='1' GROUP BY IN_BELEG" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "DELETE FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_id'" );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Zeile gelöscht, Sie werden weitergeleitet!" );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten_in_sec ( "login_mitarbeiter.php?daten=zeiterfassung&option=zettel_eingabe&zettel_id=$zettel_id", 2 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function pdf_header($partner_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BENUTZER_ID FROM STUNDENZETTEL WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1' ORDER BY ZETTEL_DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_tage_urlaub_offen_arr($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM NOT IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM  IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT STUNDENZETTEL_POS.ZETTEL_ID, STUNDENZETTEL.BESCHREIBUNG FROM `STUNDENZETTEL_POS` , STUNDENZETTEL
        \end_layout
            \begin_layout Plain Layout
        WHERE `DATUM` = '$datum' AND STUNDENZETTEL_POS.`AKTUELL` = '1' && STUNDENZETTEL.`AKTUELL` = '1' && STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID && STUNDENZETTEL.BENUTZER_ID = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL VALUES (NULL, '$l_zettel_id', '$benutzer_id', '$beschreibung', '$datum',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        $zettel_id = $this->mein_letzer_zettel ( $benutzer_id );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '', '', '$leistung_id', '$dauer_min', 'Objekt', '1','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60) AS STD, SUM(STUNDENSATZ *DAUER_MIN  /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID,BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60 ) AS STD, SUM( BENUTZER.STUNDENSATZ * DAUER_MIN /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
STUNDENZETTEL_POS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `STUNDENZETTEL_POS` (

\end_layout
\begin_layout Plain Layout

  `ST_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ST_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZETTEL_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEGINN` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ENDE` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LEISTUNG_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DAUER_MIN` decimal(4,0) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HINWEIS` mediumtext COLLATE latin1_german2_ci,

\end_layout
\begin_layout Plain Layout

  `IN_BELEG` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`ST_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`),

\end_layout
\begin_layout Plain Layout

  KEY `ZETTEL_ID` (`ZETTEL_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `LEISTUNG_ID` (`LEISTUNG_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_TYP` (`KOSTENTRAEGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_ID` (`KOSTENTRAEGER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=55819 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
ST_DAT 
\end_layout
\begin_layout Description
ST_ID 
\end_layout
\begin_layout Description
ZETTEL_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
BEGINN 
\end_layout
\begin_layout Description
ENDE 
\end_layout
\begin_layout Description
LEISTUNG_ID 
\end_layout
\begin_layout Description
DAUER_MIN 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
HINWEIS 
\end_layout
\begin_layout Description
IN_BELEG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS STUNDEN  FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) WHERE `BENUTZER_ID` = '$mitarbeiter_id' AND STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$typ' && KOSTENTRAEGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS STUNDEN  FROM `STUNDENZETTEL_POS`  WHERE STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$typ' && KOSTENTRAEGER_ID='$id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(DAUER_MIN)/60 AS G_STD FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id'";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_statistik.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM(DAUER_MIN)/60 AS STD, $preis*(SUM(DAUER_MIN)/60) AS LEISTUNG_EUR FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON (STUNDENZETTEL.ZETTEL_ID=STUNDENZETTEL_POS.ZETTEL_ID) JOIN BENUTZER ON(STUNDENZETTEL.BENUTZER_ID=BENUTZER.benutzer_id) WHERE  STUNDENZETTEL_POS.DATUM BETWEEN '$datum_a' AND '$datum_e' && STUNDENZETTEL.AKTUELL = '1' && STUNDENZETTEL_POS.AKTUELL = '1' && KOSTENTRAEGER_TYP='$kos_typ' && KOSTENTRAEGER_ID='$kos_id' GROUP BY STUNDENZETTEL.BENUTZER_ID ORDER BY STD DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage.'<br>';
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( DAUER_MIN ) AS G_ZEIT FROM `STUNDENZETTEL_POS` WHERE `ZETTEL_ID` = '$zettel_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['G_ZEIT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_dat' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_DAT, ST_ID, ZETTEL_ID, DATUM, LEISTUNG_ID, DAUER_MIN, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, HINWEIS, BEGINN, ENDE, LEISTUNGSKATALOG.BEZEICHNUNG FROM STUNDENZETTEL_POS JOIN LEISTUNGSKATALOG ON (STUNDENZETTEL_POS.LEISTUNG_ID = LEISTUNGSKATALOG.LK_ID) WHERE ZETTEL_ID='$zettel_id' && STUNDENZETTEL_POS.AKTUELL = '1' ORDER BY  DATUM, ST_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ST_ID FROM STUNDENZETTEL_POS WHERE AKTUELL = '1' ORDER BY ST_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES ('$dat', '$l_id', '$zettel_id', '$datum', '$beginn', '$ende', '$leistung_id', '$dauer_min', '$kostentraeger_typ', '$kostentraeger_id','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE STUNDENZETTEL_POS SET IN_BELEG='$erf_nr' WHERE ST_DAT='$st_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1' && (IN_BELEG != '0' OR IN_BELEG != NULL) LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT IN_BELEG FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && (IN_BELEG != '0' OR IN_BELEG != NULL) && AKTUELL='1' GROUP BY IN_BELEG" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "DELETE FROM STUNDENZETTEL_POS WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_id'" );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "Zeile gelöscht, Sie werden weitergeleitet!" );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten_in_sec ( "login_mitarbeiter.php?daten=zeiterfassung&option=zettel_eingabe&zettel_id=$zettel_id", 2 );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id' && ST_DAT='$pos_dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function pdf_header($partner_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_tage_urlaub_offen_arr($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM NOT IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM  IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        WHERE `BENUTZER_ID` = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = " SELECT STUNDENZETTEL_POS.ZETTEL_ID, STUNDENZETTEL.BESCHREIBUNG FROM `STUNDENZETTEL_POS` , STUNDENZETTEL
        \end_layout
            \begin_layout Plain Layout
        WHERE `DATUM` = '$datum' AND STUNDENZETTEL_POS.`AKTUELL` = '1' && STUNDENZETTEL.`AKTUELL` = '1' && STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID && STUNDENZETTEL.BENUTZER_ID = '$benutzer_id'
        \end_layout
            \begin_layout Plain Layout
        LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO STUNDENZETTEL_POS VALUES (NULL, '$l_id', '$zettel_id', '$datum', '', '', '$leistung_id', '$dauer_min', 'Objekt', '1','$hinweis', '0', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'STUNDENZETTEL_POS', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60) AS STD, SUM(STUNDENSATZ *DAUER_MIN  /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID,BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT GEWERKE.BEZEICHNUNG, SUM( DAUER_MIN /60 ) AS STD, SUM( BENUTZER.STUNDENSATZ * DAUER_MIN /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, STUNDENZETTEL.BENUTZER_ID, benutzername, STUNDENSATZ, SUM( DAUER_MIN ) /60 AS STD, STUNDENSATZ * ( SUM( DAUER_MIN ) /60 ) AS LEISTUNG_EUR
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL_POS` JOIN STUNDENZETTEL ON ( STUNDENZETTEL.ZETTEL_ID = STUNDENZETTEL_POS.ZETTEL_ID )
        \end_layout
            \begin_layout Plain Layout
        JOIN BENUTZER ON ( STUNDENZETTEL.BENUTZER_ID = BENUTZER.benutzer_id )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage1 = "SELECT KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, BENUTZER.BENUTZER_ID, benutzername, DATUM, BEGINN, ENDE, DAUER_MIN, DAUER_MIN/60 AS STUNDEN, LEISTUNG_ID, BEZEICHNUNG FROM `STUNDENZETTEL_POS`
        \end_layout
            \begin_layout Plain Layout
        JOIN STUNDENZETTEL ON
        \end_layout
            \begin_layout Plain Layout
        (STUNDENZETTEL_POS.ZETTEL_ID=STUNDENZETTEL.ZETTEL_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
TODO_LISTE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `TODO_LISTE` (

\end_layout
\begin_layout Plain Layout

  `T_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `T_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `UE_ID` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `TEXT` mediumtext CHARACTER SET latin1 COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ERSTELLT` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `ANZEIGEN_AB` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_TYP` varchar(30) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VERFASSER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ERLEDIGT` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKUT` enum('JA','NEIN') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WERT_EUR` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`T_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5420 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
T_DAT 
\end_layout
\begin_layout Description
T_ID 
\end_layout
\begin_layout Description
UE_ID 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
ERSTELLT 
\end_layout
\begin_layout Description
ANZEIGEN_AB 
\end_layout
\begin_layout Description
BENUTZER_TYP 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
VERFASSER_ID 
\end_layout
\begin_layout Description
ERLEDIGT 
\end_layout
\begin_layout Description
AKUT 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
WERT_EUR 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO TODO_LISTE VALUES (NULL, '$last_id', '$t_id', '$_REQUEST[text]', NULL, '$anz_ab','$typ', '$_REQUEST[benutzer_id]','$_SESSION[benutzer_id]', '0','$_REQUEST[akut]','$_REQUEST[kostentraeger_typ]','$kostentraeger_id', '$wert_eur','1')";
        \end_layout
            \begin_layout Plain Layout
        echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM TODO_LISTE WHERE T_ID='$proj_id' && AKTUELL='1' ORDER BY ANZEIGEN_AB ASC" );
        \end_layout
            \begin_layout Plain Layout
        $anz = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($anz) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM TODO_LISTE WHERE T_ID='$proj_id' && AKTUELL='1' ORDER BY ANZEIGEN_AB ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM TODO_LISTE WHERE T_ID='$proj_id' && AKTUELL='1' ORDER BY ANZEIGEN_AB ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID!='0' && ERLEDIGT='$erl' ORDER BY KOS_TYP, KOS_ID, UE_ID, VERFASSER_ID, ANZEIGEN_AB ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *, DATE_FORMAT(ERSTELLT, '%d.%m.%Y') AS ERSTELLT_D FROM  `TODO_LISTE` WHERE  ERLEDIGT='$erledigt' &&`KOS_TYP` = '$kos_typ' && KOS_ID='$kos_id'  ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        if ($erledigt == '1') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *, DATE_FORMAT(ERSTELLT, '%d.%m.%Y') AS ERSTELLT_D FROM  `TODO_LISTE` WHERE  ERLEDIGT='$erledigt' &&`KOS_TYP` = '$kos_typ' && KOS_ID='$kos_id'  ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT *, DATE_FORMAT(ERSTELLT, '%d.%m.%Y') AS ERSTELLT_D FROM  `TODO_LISTE` WHERE  `KOS_TYP` = '$kos_typ' && KOS_ID='$kos_id'  ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE TODO_LISTE SET UE_ID='$p_id' WHERE T_ID='$t_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE TODO_LISTE SET ERLEDIGT='1' WHERE T_DAT='$t_dat'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' && T_ID NOT IN (SELECT UE_ID FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID!='0' && ERLEDIGT='$erl') ORDER BY KOS_TYP, KOS_ID, UE_ID, VERFASSER_ID, ANZEIGEN_AB ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE (BENUTZER_ID='$b_id' OR VERFASSER_ID='$b_id') && AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' ORDER BY VERFASSER_ID, BENUTZER_ID, TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        // $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' && UE_ID='0' && ERLEDIGT='$erl' ORDER BY TEXT ASC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1'  ORDER BY T_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo "<hr>";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE AKTUELL='1' AND ERLEDIGT='$erl' ORDER BY T_ID DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo "<hr>";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM TODO_LISTE WHERE UE_ID ='$t_id' && ANZEIGEN_AB <= DATE_FORMAT(NOW(), '%Y-%m-%d' ) && AKTUELL='1' ORDER BY ERLEDIGT ASC, AKUT ASC, ANZEIGEN_AB ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT TEXT FROM TODO_LISTE WHERE T_ID='$t_id' && AKTUELL='1' ORDER BY T_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['TEXT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ERLEDIGT FROM TODO_LISTE WHERE T_ID='$t_id' && AKTUELL='1' ORDER BY T_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOS_TYP, KOS_ID FROM TODO_LISTE WHERE T_ID='$t_id' && AKTUELL='1' ORDER BY T_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * 	FROM `TODO_LISTE` 	WHERE (	`BENUTZER_ID` ='$benutzer_id'	OR `VERFASSER_ID` ='$benutzer_id' )
        \end_layout
            \begin_layout Plain Layout
        AND `AKTUELL` = '1' AND ERLEDIGT='$erl' ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT T_ID AS PROJ_ID
        \end_layout
            \begin_layout Plain Layout
        FROM `TODO_LISTE`
        \end_layout
            \begin_layout Plain Layout
        WHERE (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT T_ID AS PROJ_ID
        \end_layout
            \begin_layout Plain Layout
        FROM `TODO_LISTE`
        \end_layout
            \begin_layout Plain Layout
        WHERE (
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOS_TYP, KOS_ID FROM TODO_LISTE WHERE T_ID='$t_id' && AKTUELL='1' ORDER BY T_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if (is_array ( $row )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE TODO_LISTE SET TEXT='$_REQUEST[text]', ANZEIGEN_AB='$anz_ab', BENUTZER_ID='$_REQUEST[benutzer_id]', ERLEDIGT='$erledigt', AKUT='$_REQUEST[akut]', KOS_TYP='$_REQUEST[kostentraeger_typ]', KOS_ID='$kostentraeger_id' WHERE T_DAT='$this->t_dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        weiterleiten ( "?daten=todo" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM TODO_LISTE WHERE T_ID='$t_id' && AKTUELL='1' ORDER BY T_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->t_dat = $row ['T_DAT'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM TODO_LISTE WHERE T_ID ='$t_id'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        if ($art = 'Projekt') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM TODO_LISTE WHERE T_ID ='$t_id' OR UE_ID='$t_id'";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_todo.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * 	FROM `TODO_LISTE` 	WHERE BENUTZER_TYP='$typ' && `BENUTZER_ID` ='$id' AND `AKTUELL` = '1' AND ERLEDIGT='$erl' ORDER BY ERSTELLT DESC";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage."<br>";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
TRANSFER_TAB
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `TRANSFER_TAB` (

\end_layout
\begin_layout Plain Layout

  `MIETVERTRAG_ID` int(6) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(6) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_KURZNAME` varchar(40) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FM_Kurzname` varchar(40) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FM_Einheitenname` varchar(40) COLLATE latin1_german2_ci NOT NULL

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
MIETVERTRAG_ID 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
EINHEIT_KURZNAME 
\end_layout
\begin_layout Description
FM_Kurzname 
\end_layout
\begin_layout Description
FM_Einheitenname 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  && MIETVERTRAG_ID!='0'order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_mietbuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT MIETVERTRAG_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    import_geldkontobuchungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT_ID FROM TRANSFER_TAB WHERE RTRIM( LTRIM( FM_Einheitenname ) ) ='$fm_einheitenname'  order by MIETVERTRAG_ID DESC limit 0,1";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
UEBERWEISUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `UEBERWEISUNG` (

\end_layout
\begin_layout Plain Layout

  `U_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DTAUS_ID` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `A_KONTO_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `E_KONTO_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAGS_ART` enum('Bruttobetrag','Nettobetrag','Skontobetrag') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK1` varchar(27) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK2` varchar(27) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VZWECK3` varchar(27) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BUCHUNGSTEXT` mediumtext COLLATE latin1_german2_ci,

\end_layout
\begin_layout Plain Layout

  `ZAHLUNGSART` enum('VOLL','TEIL') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZUGSTAB` enum('MIETVERTRAG','RECHNUNG') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZUGS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSZUGSNR` varchar(10) COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AUSZUGS_DATUM` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`U_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`),

\end_layout
\begin_layout Plain Layout

  KEY `DTAUS_ID` (`DTAUS_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=8108 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
U_DAT 
\end_layout
\begin_layout Description
DTAUS_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
A_KONTO_ID 
\end_layout
\begin_layout Description
E_KONTO_ID 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
BETRAGS_ART 
\end_layout
\begin_layout Description
VZWECK1 
\end_layout
\begin_layout Description
VZWECK2 
\end_layout
\begin_layout Description
VZWECK3 
\end_layout
\begin_layout Description
BUCHUNGSTEXT 
\end_layout
\begin_layout Description
ZAHLUNGSART 
\end_layout
\begin_layout Description
BEZUGSTAB 
\end_layout
\begin_layout Description
BEZUGS_ID 
\end_layout
\begin_layout Description
AUSZUGSNR 
\end_layout
\begin_layout Description
AUSZUGS_DATUM 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_personal.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM SEPA_UEBERWEISUNG WHERE FILE IS NULL && GK_ID_AUFTRAG ='$gk_id' && `AKTUELL` = '1' && VZWECK = '$vzweck' && KONTO='$konto' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweck', '$betrag', '$von_gk_id', '$sep->IBAN', '$sep->BIC', '$sep->bankname', '$sep->beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweck', '$betrag', '$von_gk_id', '$iban', '$bic', '$bank', '$empfaenger', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        // echo "<hr>";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        return $last_b_id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE SEPA_UEBERWEISUNG SET FILE='$dateiname' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND GK_ID_AUFTRAG='$von_gk_id' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC LIMIT 0, 300" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID, FILE, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT DESC LIMIT 0, 300" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT FILE FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NOT NULL AND GK_ID_AUFTRAG='$von_gk_id' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GK_ID_AUFTRAG, KAT, SUM(BETRAG) AS SUMME, COUNT(BETRAG) AS ANZ FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `AKTUELL` = '1' GROUP BY KAT, `GK_ID_AUFTRAG`" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT GK_ID_AUFTRAG, KAT, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `AKTUELL` = '1' GROUP BY KAT, `GK_ID_AUFTRAG`";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( BETRAG ) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `KOS_TYP` LIKE '$kos_typ' AND `KOS_ID` ='$kos_id' && KAT='$kat' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM( BETRAG ) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `KOS_TYP` = '$kos_typ' AND `KOS_ID` ='$kos_id' && KAT='$kat' AND `AKTUELL` = '1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `SEPA_UEBERWEISUNG` WHERE `FILE` = '$file' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO SEPA_UEBERWEISUNG VALUES (NULL, '$last_b_id', NULL, '$kat', '$vzweckn', '$betrag', '$von_gk_id', '$iban', '$bic', '$bankname', '$beguenstigter', '$kos_typ', '$kos_id', '$konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'SEPA_UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `SEPA_UEBERWEISUNG` WHERE `FILE` LIKE '$sepa_file' AND `BETRAG` = '$betrag' && GK_ID_AUFTRAG='$gk_id' && KOS_TYP='$kos_typ' &&  KOS_ID='$kos_id' AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT FILE, GK_ID_AUFTRAG, SUM(BETRAG) AS SUMME FROM `SEPA_UEBERWEISUNG` WHERE `FILE`='$file' AND `AKTUELL` = '1' GROUP BY FILE ORDER BY DAT LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KAT FROM `SEPA_UEBERWEISUNG` WHERE `FILE` IS NULL AND KAT='$kat' AND `GK_ID_AUFTRAG` ='$von_gk_id' AND `AKTUELL` = '1' GROUP BY KAT ORDER BY DAT" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_sepa.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE SEPA_UEBERWEISUNG SET AKTUELL='0' WHERE DAT='$dat' && FILE IS NULL";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM UEBERWEISUNG WHERE  A_KONTO_ID='$a_konto_id' && E_KONTO_ID='$e_konto_id' && BEZUGSTAB='$bezugstab' && BEZUGS_ID='$bezugsid'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $resultat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO UEBERWEISUNG VALUES (NULL, NULL, '$datum', '$a_konto_id', '$e_konto_id', '$betrag', '$betrags_art', '$vzweck1', '$vzweck2', '$vzweck3', '$buchungstext','$zahlungart', '$bezugstab', '$bezugsid', NULL, NULL,   '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'UEBERWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        hinweis_ausgeben ( "EINGABE WURDE IN DEN DTAUS POOL AUFGENOMMEN" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT A_KONTO_ID FROM `UEBERWEISUNG` WHERE `AKTUELL`='1' && DTAUS_ID IS NULL GROUP BY `A_KONTO_ID`" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT A_KONTO_ID, E_KONTO_ID, DATUM, BETRAG, VZWECK1, VZWECK2, VZWECK3, BUCHUNGSTEXT FROM `UEBERWEISUNG` WHERE `A_KONTO_ID` = '$g_konto_id'  AND `AKTUELL` = '1' && DTAUS_ID IS NULL" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM `UEBERWEISUNG` WHERE `A_KONTO_ID` = '$g_konto_id'  AND `AKTUELL` = '1' && DTAUS_ID IS NULL" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DTAUS_ID  FROM `UEBERWEISUNG` WHERE  `AKTUELL` = '1' && DTAUS_ID IS NOT NULL ORDER BY DTAUS_ID DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return $row ['DTAUS_ID'];
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE`UEBERWEISUNG`SET DTAUS_ID='$letzte_dtaus_id', DATUM='$datum' WHERE `A_KONTO_ID` = '$g_konto_id'  AND `AKTUELL` = '1' && DTAUS_ID IS NULL" );
        \end_layout
            \begin_layout Plain Layout
        return $letzte_dtaus_id;
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DTAUS_ID, DATUM, BEZUGSTAB  FROM `UEBERWEISUNG` WHERE `AKTUELL`='1' && A_KONTO_ID='$g_konto_id'  && DTAUS_ID IS NOT NULL GROUP BY DTAUS_ID  ORDER BY DATUM DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `UEBERWEISUNG` WHERE `DTAUS_ID` = '$dtaus_id'  AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM `UEBERWEISUNG` WHERE `DTAUS_ID` = '$dtaus_id'  AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME FROM `UEBERWEISUNG` WHERE `DTAUS_ID`  IS NULL  AND `AKTUELL` = '1' && A_KONTO_ID='$geldkonto_id' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT SUM( BETRAG ) AS SUMME FROM `UEBERWEISUNG` WHERE `DTAUS_ID` = '$dtaus_id' && BEZUGSTAB = 'Rechnung' && BEZUGS_ID = '$belegnr' AND `AKTUELL` = '1' " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *  FROM `UEBERWEISUNG` WHERE `DTAUS_ID` = '$dtaus_id'  AND `AKTUELL` = '1'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $this->update_ueberweisung_dat ( $u_dat, $datum, $kto_auszugsnr );
        \end_layout
            \begin_layout Plain Layout
        $r = new rechnung ();
        \end_layout
            \begin_layout Plain Layout
        $r->rechnung_als_freigegeben ( $belegnr );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function update_ueberweisung_dat($u_dat, $datum, $kto_auszugsnr) {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE `UEBERWEISUNG` SET AUSZUGSNR='$kto_auszugsnr', AUSZUGS_DATUM='$datum' WHERE `U_DAT` = '$u_dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_ueberweisung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE `UEBERWEISUNG` SET AUSZUGSNR='$kto_auszugsnr', AUSZUGS_DATUM='$datum' WHERE `U_DAT` = '$u_dat'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function form_ueberweisung_manuell() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
URLAUB
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `URLAUB` (

\end_layout
\begin_layout Plain Layout

  `U_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTRAG_D` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTEIL` decimal(2,1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ART` enum('Urlaub','Krank','oK','Auszahlung','Unbezahlt') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`U_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `ANTEIL` (`ANTEIL`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=920054 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
U_DAT 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
ANTRAG_D 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
ANTEIL 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
ART 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "UPDATE STUNDENZETTEL_POS SET AKTUELL='0' WHERE ZETTEL_ID='$zettel_id'" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function get_tage_urlaub_offen_arr($benutzer_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM NOT IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_zeiterfassung.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `URLAUB` WHERE `BENUTZER_ID` = '$benutzer_id' AND `AKTUELL` = '1' && DATE_FORMAT( DATUM, '%Y' ) = YEAR( NOW( ) ) && DATUM  IN (
        \end_layout
            \begin_layout Plain Layout
        SELECT DATUM
        \end_layout
            \begin_layout Plain Layout
        FROM `STUNDENZETTEL` , STUNDENZETTEL_POS
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzer_id, benutzername, URLAUB, EINTRITT, AUSTRITT FROM BENUTZER WHERE DATE_FORMAT(EINTRITT, '%Y') <= '$jahr' &&  (DATE_FORMAT(AUSTRITT, '%Y') >= '$jahr' OR AUSTRITT='0000-00-00') && DATE_FORMAT(AUSTRITT, '%Y-%m-%d') < '$datum_h' ORDER BY benutzername ASC " );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzername, URLAUB AS ANSPRUCH, SUM( ANTEIL )  AS GEPLANT , URLAUB - SUM( ANTEIL ) AS REST
        \end_layout
            \begin_layout Plain Layout
        FROM `URLAUB` , BENUTZER
        \end_layout
            \begin_layout Plain Layout
        WHERE URLAUB.ART = '$art' && URLAUB.BENUTZER_ID = BENUTZER.benutzer_id && URLAUB.BENUTZER_ID='$benutzer_id' && DATE_FORMAT( DATUM, '%Y' ) = '$jahr' && DATUM> CURDATE() && AKTUELL='1'  GROUP BY URLAUB.`BENUTZER_ID` LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT benutzername, URLAUB AS ANSPRUCH, SUM( ANTEIL )  AS GENOMMEN , URLAUB - SUM( ANTEIL ) AS REST
        \end_layout
            \begin_layout Plain Layout
        FROM `URLAUB` , BENUTZER
        \end_layout
            \begin_layout Plain Layout
        WHERE URLAUB.ART = '$art' && URLAUB.BENUTZER_ID = BENUTZER.benutzer_id && URLAUB.BENUTZER_ID='$benutzer_id' && DATE_FORMAT( DATUM, '%Y' ) = '$jahr' && DATUM<= CURDATE() && AKTUELL='1' GROUP BY URLAUB.`BENUTZER_ID` LIMIT 0 , 1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_DAT, benutzername, ANTRAG_D, DATUM, ANTEIL, ART from BENUTZER JOIN URLAUB ON (BENUTZER.benutzer_id = URLAUB.BENUTZER_ID) WHERE BENUTZER.benutzer_id='$benutzer_id' && DATE_FORMAT(URLAUB.DATUM, '%Y') = '$jahr' && AKTUELL='1' ORDER BY  DATUM ASC " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT U_DAT, benutzername, ANTRAG_D, DATUM, ANTEIL, ART from BENUTZER JOIN URLAUB ON (BENUTZER.benutzer_id = URLAUB.BENUTZER_ID) WHERE BENUTZER.benutzer_id='$benutzer_id' && DATE_FORMAT(URLAUB.DATUM, '%Y') = '$jahr' && AKTUELL='1' ORDER BY DATUM ASC " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"$name\">$beschreibung</label><select name=\"$name\" id=\"$id\" $js> \n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Urlaub\" selected>Urlaub</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Krank\">Krank</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<option value=\"Urlaub\" selected>Urlaub</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Krank\">Krank</option>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"Auszahlung\">Auszahlung</option>\n";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function tage_arr($benutzer_id, $datum_a, $datum_e, $art = 'Urlaub') {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANTEIL FROM URLAUB_EINST WHERE DATE_FORMAT(DATUM, '%m-%d') ='$monat-$tag' LIMIT 0,1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO URLAUB VALUES (NULL, '$benutzer_id','$datum_heute','$datum', '$anteil', '1', '$art')";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM URLAUB WHERE DATUM='$datum' && BENUTZER_ID='$benutzer_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE URLAUB SET AKTUELL='0' WHERE U_DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "gelöscht";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE URLAUB SET AKTUELL='0' WHERE DATUM='$datum' && BENUTZER_ID='$benutzer_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        echo "gelöscht";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM URLAUB WHERE AKTUELL='1' && BENUTZER_ID='$benutzer_id' && DATUM='$datum'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO BENUTZER VALUES ('$last_id', '$benutzername', '$passwort', '$stundensatz', '$geb_dat', '$gewerk_id', '$eintritt', '$austritt', '$urlaub', '$stunden_pw')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_benutzer.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE BENUTZER SET benutzername='$benutzername', passwort='$passwort', STUNDENSATZ='$stundensatz', GEB_DAT='$geb_dat', GEWERK_ID='$gewerk_id', EINTRITT='$eintritt', AUSTRITT='$austritt', URLAUB='$urlaub', STUNDEN_PW='$stunden_pw' WHERE benutzer_id='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
URLAUB_BELOW
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `URLAUB_BELOW` (

\end_layout
\begin_layout Plain Layout

  `U_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTRAG_D` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTEIL` decimal(2,1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ART` enum('Urlaub','Krank','Auszahlung','Unbezahlt') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`U_DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `ANTEIL` (`ANTEIL`),

\end_layout
\begin_layout Plain Layout

  KEY `DATUM` (`DATUM`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=124352 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
U_DAT 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
ANTRAG_D 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
ANTEIL 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout
\begin_layout Description
ART 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
URLAUB_EINST
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `URLAUB_EINST` (

\end_layout
\begin_layout Plain Layout

  `UE_DAT` int(2) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANTEIL` decimal(2,1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`UE_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
UE_DAT 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
ANTEIL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_urlaub.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANTEIL FROM URLAUB_EINST WHERE DATE_FORMAT(DATUM, '%m-%d') ='$monat-$tag' LIMIT 0,1 " );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
VERPACKUNGS_E
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `VERPACKUNGS_E` (

\end_layout
\begin_layout Plain Layout

  `V_ID` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `V_EINHEIT` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`V_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `V_EINHEIT` (`V_EINHEIT`),

\end_layout
\begin_layout Plain Layout

  KEY `BEZEICHNUNG` (`BEZEICHNUNG`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=27 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
V_ID 
\end_layout
\begin_layout Description
V_EINHEIT 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_rechnungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT V_EINHEIT, BEZEICHNUNG  FROM VERPACKUNGS_E WHERE AKTUELL='1' ORDER BY BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WARTUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WARTUNGEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GERAETE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WARTUNGSDATUM` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEMERKUNG` mediumtext COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `PLAN_ID` (`PLAN_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `GERAETE_ID` (`GERAETE_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
GERAETE_ID 
\end_layout
\begin_layout Description
PLAN_ID 
\end_layout
\begin_layout Description
WARTUNGSDATUM 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
BEMERKUNG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ndurchgefuehrte_wartungen($monat, $jahr, $plan_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID NOT IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGEN.WARTUNGSDATUM, '%Y') = YEAR(NOW()) OR DATE_FORMAT(WARTUNGEN.WARTUNGSDATUM, '%Y') = YEAR(NOW())-1 && WARTUNGEN.PLAN_ID='$plan_id' && WARTUNGEN.AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        )
        \end_layout
            \begin_layout Plain Layout
        ORDER BY LAGE_TYP ASC, LAGE_ID ASC , W_GERAETE.IM_EINSATZ ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT GERAETE_ID
        \end_layout
            \begin_layout Plain Layout
        FROM WARTUNGEN
        \end_layout
            \begin_layout Plain Layout
        WHERE DATE_FORMAT( WARTUNGEN.WARTUNGSDATUM, '%Y' ) = YEAR( NOW( ) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_ADD( WARTUNGSDATUM, INTERVAL $this->intervall $this->intervall_period )  AS N_WARTUNG FROM `WARTUNGEN` WHERE `GERAETE_ID` ='$geraet_id'  AND `PLAN_ID` ='$plan_id' AND `AKTUELL` = '1' ORDER BY WARTUNGSDATUM DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT MAX(WARTUNGSDATUM) AS WARTUNGSDATUM, DATE_ADD( MAX(WARTUNGSDATUM), INTERVAL $this->intervall $this->intervall_period ) AS N_WARTUNG1, DATE_ADD( DATE_ADD( MAX(WARTUNGSDATUM), INTERVAL $this->intervall $this->intervall_period ) , INTERVAL $this->intervall $this->intervall_period ) AS N_WARTUNG2, DATE_ADD( DATE_ADD( DATE_ADD( MAX(WARTUNGSDATUM), INTERVAL $this->intervall $this->intervall_period ) , INTERVAL $this->intervall $this->intervall_period ) , INTERVAL $this->intervall $this->intervall_period ) AS N_WARTUNG3
        \end_layout
            \begin_layout Plain Layout
        FROM `WARTUNGEN`
        \end_layout
            \begin_layout Plain Layout
        WHERE PLAN_ID = '$plan_id'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WARTUNGEN VALUES (NULL, '$geraete_id', '$plan_id', '$wartungsdatum','$benutzer_id', '$bemerkung', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WARTUNGEN', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WARTUNGSPLAN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WARTUNGSPLAN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLAN_BEZEICHNUNG` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `INTERVALL` int(3) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `INTERVALL_PERIOD` enum('DAY','MONTH','YEAR') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEWERK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `PLAN_ID` (`PLAN_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
PLAN_ID 
\end_layout
\begin_layout Description
PLAN_BEZEICHNUNG 
\end_layout
\begin_layout Description
INTERVALL 
\end_layout
\begin_layout Description
INTERVALL_PERIOD 
\end_layout
\begin_layout Description
GEWERK_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ndurchgefuehrte_wartungen($monat, $jahr, $plan_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID NOT IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `WARTUNGSPLAN` WHERE `PLAN_ID` ='$plan_id'   AND `AKTUELL` = '1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PLAN_ID, PLAN_BEZEICHNUNG  FROM `WARTUNGSPLAN` WHERE  `AKTUELL` ='1' ORDER BY PLAN_BEZEICHNUNG ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "<label for=\"plan_id\">Wartungsplan</label><select name=\"plan_id\" id=\"plan_id\" size=1>\n";
        \end_layout
            \begin_layout Plain Layout
        echo "<option value=\"\">Bitte wählen</option>\n";
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "</select>\n";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function wartungsplan_auswahl() {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `WARTUNGSPLAN` WHERE `PLAN_ID` ='$plan_id'   AND `AKTUELL` = '1'  LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WARTUNG_ZUWEISUNG
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WARTUNG_ZUWEISUNG` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GERAETE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `GERAETE_ID` (`GERAETE_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `PLAN_ID` (`PLAN_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
GERAETE_ID 
\end_layout
\begin_layout Description
PLAN_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ndurchgefuehrte_wartungen($monat, $jahr, $plan_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID NOT IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "select W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT(W_GERAETE.IM_EINSATZ,'%d.%m.%Y') IM_EINSATZ, LAGE_TYP, LAGE_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        from W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        LEFT OUTER JOIN WARTUNG_ZUWEISUNG on (W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) AS IM_EINSATZ, DATE_FORMAT( WARTUNGSDATUM, '%d.%m.%Y' ) AS L_WARTUNG, DATE_FORMAT( DATE_ADD( WARTUNGSDATUM, INTERVAL $this->intervall $this->intervall_period ) , '%d.%m.%Y' ) AS N_WARTUNG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) AS IM_EINSATZ, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) IM_EINSATZ, KOSTENTRAEGER_TYP,KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        LEFT OUTER JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WARTUNG_ZUWEISUNG VALUES (NULL, '$geraete_id', '$plan_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WARTUNG_ZUWEISUNG', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT W_GERAETE.GERAETE_ID  FROM W_GERAETE JOIN WARTUNG_ZUWEISUNG ON(W_GERAETE.GERAETE_ID=WARTUNG_ZUWEISUNG.GERAETE_ID) WHERE WARTUNG_ZUWEISUNG.PLAN_ID='$plan_id' && WARTUNG_ZUWEISUNG.AKTUELL='1' && W_GERAETE.AKTUELL='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_EIGENTUEMER_PERSON
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_EIGENTUEMER_PERSON` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WEG_EIG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `PERSON_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=2307 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
WEG_EIG_ID 
\end_layout
\begin_layout Description
PERSON_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$et_id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `WEG_EIG_ID` FROM `WEG_EIGENTUEMER_PERSON` WHERE `PERSON_ID` = '$person_id' AND `AKTUELL` = '1' && `WEG_EIG_ID` IN (SELECT ID FROM  `WEG_MITEIGENTUEMER` WHERE  `EINHEIT_ID` ='$einheit_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_EIGENTUEMER_PERSON SET AKTUELL='0' where AKTUELL='1' && WEG_EIG_ID='$et_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIG_ID FROM WEG_EIGENTUEMER_PERSON WHERE PERSON_ID='$person_id' && AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIGENTUEMER_PERSON.WEG_EIG_ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM WEG_EIGENTUEMER_PERSON, WEG_MITEIGENTUEMER,EINHEIT WHERE PERSON_ID='$person_id' && WEG_MITEIGENTUEMER.AKTUELL='1' && WEG_EIGENTUEMER_PERSON.AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && WEG_EIGENTUEMER_PERSON.WEG_EIG_ID=WEG_MITEIGENTUEMER.ID && WEG_MITEIGENTUEMER.EINHEIT_ID=EINHEIT.EINHEIT_ID GROUP BY WEG_EIG_ID" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } // end for
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_EIGENTUEMER_PERSON VALUES (NULL, '$p_id', '$et_id', '$person_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_EIGENTUEMER_PERSON', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_HGA_HK
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_HGA_HK` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WEG_HGA_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=418 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
WEG_HGA_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM WEG_HGA_HK WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && WEG_HGA_ID='$hga_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM WEG_HGA_HK WHERE AKTUELL='1' && WEG_HGA_ID='$hga_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_HK SET AKTUELL='0' WHERE WEG_HGA_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_HK SET AKTUELL='0' WHERE WEG_HGA_ID='$p_id' && KOS_ID='$eig_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_HK VALUES (NULL, '$id', '$betrag_a', 'Eigentuemer','$eig_id', '$p_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_HK', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM `WEG_HGA_HK` WHERE KOS_TYP='Eigentuemer' && `KOS_ID` ='$et_id' AND  `WEG_HGA_ID` ='$p_id' AND  `AKTUELL` =  '1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_HGA_PROFIL
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_HGA_PROFIL` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `JAHR` int(4) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GELDKONTO_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IHR_GK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WPLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HG_KONTO` int(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HK_KONTO` int(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IHR_KONTO` int(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=39 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
JAHR 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout
\begin_layout Description
OBJEKT_ID 
\end_layout
\begin_layout Description
GELDKONTO_ID 
\end_layout
\begin_layout Description
IHR_GK_ID 
\end_layout
\begin_layout Description
WPLAN_ID 
\end_layout
\begin_layout Description
HG_KONTO 
\end_layout
\begin_layout Description
HK_KONTO 
\end_layout
\begin_layout Description
IHR_KONTO 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_HGA_PROFIL WHERE AKTUELL='1' && ID='$p_id' ORDER BY DAT ASC LIMIT 0,1" ) or mysql_error ();
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_HGA_PROFIL WHERE AKTUELL='1' ORDER BY ID DESC" ) or mysql_error ();
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_PROFIL SET AKTUELL='0' WHERE ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_PROFIL', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        $_SESSION ['hga_profil_id'] = $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_PROFIL SET AKTUELL='0' WHERE ID='$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_PROFIL VALUES (NULL, '$profil_id', '$bez', '$jahr','$von','$bis', '$objekt_id', '$gk_id', '$gk_id_ihr', '$wp_id', '$hg_konto', '$hk_konto', '$ihr_konto', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_PROFIL', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_HGA_ZEILEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_HGA_ZEILEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WEG_HG_P_ID` int(1) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTO` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ART` enum('Ausgaben/Einnahmen','Mittelverwendung','Verrechnung') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEXT` varchar(200) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GEN_KEY_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HNDL_BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=830 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
WEG_HG_P_ID 
\end_layout
\begin_layout Description
KONTO 
\end_layout
\begin_layout Description
ART 
\end_layout
\begin_layout Description
TEXT 
\end_layout
\begin_layout Description
GEN_KEY_ID 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
HNDL_BETRAG 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, TEXT FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KONTO, TEXT FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' && ART='$art'  GROUP BY KONTO ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT KONTO, TEXT FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' && ART='$art' GROUP BY KONTO ORDER BY KONTO ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' && KONTO='$konto' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' ORDER BY KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_ZEILEN SET AKTUELL='0' WHERE KONTO='$konto' && WEG_HG_P_ID='$profil_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        mysql_query ( "UPDATE WEG_HGA_ZEILEN SET BETRAG='$betrag' WHERE AKTUELL='1' && WEG_HG_P_ID='$profil_id' && KONTO='$konto'" ) or mysql_error ();
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function tab_zeilen($p_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$p_id' ORDER BY KONTO, ART ASC" ) or mysql_error ();
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HGA_ZEILEN SET AKTUELL='0' WHERE WEG_HG_P_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, SUM(HNDL_BETRAG) AS SUMME_HNDL FROM WEG_HGA_ZEILEN WHERE AKTUELL='1' && WEG_HG_P_ID='$profil_id' && KONTO='$konto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        $this->summe_zeilen = 0;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_HGA_ZEILEN VALUES (NULL, '$id', '$profil_id', '$konto','$art', '$text', '$gen_key_id','$betrag_a','$hndl_betrag_a', '$kos_typ','$kos_id','1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_HGA_ZEILEN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_HG_ZAHLUNGEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_HG_ZAHLUNGEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BUCHUNGS_DAT` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `BUCHUNGS_SUMME` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKONTO` int(10) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WEG_HGA_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=47 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BUCHUNGS_DAT 
\end_layout
\begin_layout Description
BUCHUNGS_SUMME 
\end_layout
\begin_layout Description
KOSTENKONTO 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
WEG_HGA_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKONTO, SUM(BUCHUNGS_SUMME) AS SUMME FROM WEG_HG_ZAHLUNGEN WHERE  AKTUELL='1' &&  WEG_HGA_ID='$p_id' GROUP BY KOSTENKONTO ORDER BY `WEG_HG_ZAHLUNGEN`.`KOSTENKONTO` ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BUCHUNGS_SUMME) AS SUMME FROM WEG_HG_ZAHLUNGEN WHERE  AKTUELL='1' &&  WEG_HGA_ID='$p_id' && KOSTENKONTO='$kostenkonto' ORDER BY `WEG_HG_ZAHLUNGEN`.`KOSTENKONTO` ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BUCHUNGS_DAT, BUCHUNGS_SUMME FROM WEG_HG_ZAHLUNGEN WHERE  AKTUELL='1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && WEG_HGA_ID='$hga_id' && KOSTENKONTO='$kostenkonto' ORDER BY BUCHUNGS_DAT ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT BUCHUNGS_DAT FROM WEG_HG_ZAHLUNGEN WHERE AKTUELL='1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && WEG_HGA_ID='$hga_id' && KOSTENKONTO='$kostenkonto' ORDER BY BUCHUNGS_DAT ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_HG_ZAHLUNGEN SET AKTUELL='0' WHERE WEG_HGA_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_IHR_III
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_IHR_III` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KONTENRAHMEN_KONTO` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IHR_GK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
KONTENRAHMEN_KONTO 
\end_layout
\begin_layout Description
IHR_GK_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        echo "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        echo "SELECT `KONTENRAHMEN_KONTO`, SUM(BETRAG) AS SUMME  FROM `WEG_IHR_III` WHERE `IHR_GK_ID` = '$gk_id' AND `AKTUELL` = '1' && DATE_FORMAT(DATUM, '%Y') = '$jahr' GROUP BY `KONTENRAHMEN_KONTO` ORDER BY DATUM ASC";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_KONTOSTAND
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_KONTOSTAND` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GK_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
GK_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM WEG_KONTOSTAND WHERE GK_ID='$gk_id' && AKTUELL='1' && DATUM='$datum' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_KONTOSTAND VALUES (NULL, '$id', '$gk_id', '$datum', '$betrag_db', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_KONTOSTAND', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_KONTOSTAND WHERE AKTUELL='1' && GK_ID='$gk_id' && DATUM='$datum'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_KONTOSTAND WHERE AKTUELL='1' && GK_ID='$gk_id' ORDER BY DATUM ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_MITEIGENTUEMER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_MITEIGENTUEMER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1524 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM `WEG_MITEIGENTUEMER` , EINHEIT WHERE EINHEIT_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM `WEG_MITEIGENTUEMER` , EINHEIT WHERE EINHEIT_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) ) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$von', '$bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_import.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT `WEG_EIG_ID` FROM `WEG_EIGENTUEMER_PERSON` WHERE `PERSON_ID` = '$person_id' AND `AKTUELL` = '1' && `WEG_EIG_ID` IN (SELECT ID FROM  `WEG_MITEIGENTUEMER` WHERE  `EINHEIT_ID` ='$einheit_id' AND  `AKTUELL` =  '1')" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID ";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $anz_gk = count ( $gk_arr_objekt );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME, EINHEIT.HAUS_ID, HAUS.OBJEKT_ID FROM `WEG_MITEIGENTUEMER` , EINHEIT, HAUS WHERE EINHEIT_AKTUELL = '1' && HAUS_AKTUELL = '1' && AKTUELL = '1' && EINHEIT.HAUS_ID = HAUS.HAUS_ID && EINHEIT.EINHEIT_ID = WEG_MITEIGENTUEMER.EINHEIT_ID GROUP BY ID ORDER BY  EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_MITEIGENTUEMER SET AKTUELL='0' where AKTUELL='1' && ID='$et_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON $sortvon" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' && (DATE_FORMAT(VON, '%Y') <='$jahr' AND BIS='0000-00-00' OR DATE_FORMAT(VON, '%Y') <='$jahr' AND DATE_FORMAT(BIS, '%Y') >='$jahr') ORDER BY VON ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' && (DATE_FORMAT(VON, '%Y') <='$jahr' AND BIS='0000-00-00' OR DATE_FORMAT(VON, '%Y') <='$jahr' AND DATE_FORMAT(BIS, '%Y') >='$jahr') ORDER BY VON ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT * FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, VON, BIS FROM WEG_MITEIGENTUEMER WHERE ID='$e_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WEG_EIGENTUEMER_PERSON.WEG_EIG_ID, WEG_MITEIGENTUEMER.EINHEIT_ID, EINHEIT_KURZNAME FROM WEG_EIGENTUEMER_PERSON, WEG_MITEIGENTUEMER,EINHEIT WHERE PERSON_ID='$person_id' && WEG_MITEIGENTUEMER.AKTUELL='1' && WEG_EIGENTUEMER_PERSON.AKTUELL='1' && EINHEIT.EINHEIT_AKTUELL='1' && WEG_EIGENTUEMER_PERSON.WEG_EIG_ID=WEG_MITEIGENTUEMER.ID && WEG_MITEIGENTUEMER.EINHEIT_ID=EINHEIT.EINHEIT_ID GROUP BY WEG_EIG_ID" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT PERSON_ID FROM WEG_EIGENTUEMER_PERSON WHERE WEG_EIG_ID='$id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_MITEIGENTUEMER SET BIS='$akt_eigentuemer_bis' where AKTUELL='1' && ID='$alt_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "1";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$eigentuemer_von', '$eigentuemer_bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$eigentuemer_von', '$eigentuemer_bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_MITEIGENTUEMER VALUES (NULL, '$id', '$einheit_id', '$von', '$bis', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_MITEIGENTUEMER', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        return $id;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_MITEIGENTUEMER WHERE EINHEIT_ID='$einheit_id' && AKTUELL='1' ORDER BY VON DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_WG_DEF
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_WG_DEF` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ANFANG` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ENDE` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKAT` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `E_KONTO` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUPPE` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `G_KONTO` varchar(10) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=3995 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
ANFANG 
\end_layout
\begin_layout Description
ENDE 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
KOSTENKAT 
\end_layout
\begin_layout Description
E_KONTO 
\end_layout
\begin_layout Description
GRUPPE 
\end_layout
\begin_layout Description
G_KONTO 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, E_KONTO FROM WEG_WG_DEF WHERE KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && KOSTENKAT = '$kostenkat' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if (! empty ( $row ['SUMME'] )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, E_KONTO, KOSTENKAT FROM WEG_WG_DEF WHERE KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' GROUP BY KOSTENKAT ORDER BY E_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT E_KONTO, KOSTENKAT FROM WEG_WG_DEF WHERE KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' GROUP BY KOSTENKAT ORDER BY E_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, G_KONTO, ANFANG, ENDE FROM WEG_WG_DEF WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && E_KONTO = '$e_konto' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if (! empty ( $row ['SUMME'] )) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT E_KONTO, KOSTENKAT FROM WEG_WG_DEF WHERE KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' GROUP BY KOSTENKAT ORDER BY E_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, G_KONTO FROM WEG_WG_DEF WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && GRUPPE = '$gruppe' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME, G_KONTO FROM WEG_WG_DEF WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && GRUPPE = '$gruppe' ORDER BY ANFANG ASC";
        \end_layout
            \begin_layout Plain Layout
        // die();
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKAT FROM WEG_WG_DEF WHERE KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' GROUP BY KOSTENKAT ORDER BY E_KONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS SUMME, G_KONTO, E_KONTO, ANFANG, ENDE FROM WEG_WG_DEF WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ORDER BY ANFANG ASC" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM(BETRAG) AS SUMME, G_KONTO, E_KONTO, ANFANG, ENDE FROM WEG_WG_DEF WHERE KOS_TYP='$kos_typ' && KOS_ID='$kos_id' && AKTUELL='1' && ( ENDE = '0000-00-00' OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ORDER BY ANFANG ASC<br><br>";
        \end_layout
            \begin_layout Plain Layout
        // die('SIVAC');
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WG_DEF WHERE AKTUELL='1' && DAT='$dat'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ID FROM WEG_WG_DEF WHERE AKTUELL='1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WG_DEF WHERE AKTUELL='1' GROUP BY KOSTENKAT ORDER BY E_KONTO, KOSTENKAT ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WG_DEF VALUES (NULL, '$id', '$von', '$bis', '$betrag', '$kostenkat', '$e_konto', '$gruppe', '$g_konto','Einheit', '$einheit_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Zugewiesene MIETBUCHUNG_DAT auslesen */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WG_DEF', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT KOSTENKAT FROM WEG_WG_DEF WHERE AKTUELL='1' && E_KONTO='$e_konto' GROUP BY E_KONTO ORDER BY ANFANG DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WG_DEF WHERE AKTUELL='1' && KOS_TYP='$kos_typ' && KOS_ID='$kos_id' ORDER BY ANFANG ASC, ENDE DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        function wohngeld_def_delete($dat) {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_WG_DEF SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_WG_DEF SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WG_DEF', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT ANFANG FROM WEG_WG_DEF WHERE AKTUELL='1' &&  KOS_TYP LIKE '$kos_typ' && KOS_ID='$kos_id' ORDER BY ANFANG ASC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM( BETRAG ) AS SUMME FROM WEG_WG_DEF WHERE KOS_TYP = '$kos_typ' && KOS_ID = '$kos_id' && AKTUELL = '1' && ( ENDE = '0000-00-00'
        \end_layout
            \begin_layout Plain Layout
        OR DATE_FORMAT( ENDE, '%Y-%m' ) >= '$jahr-$monat' && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' ) && DATE_FORMAT( ANFANG, '%Y-%m' ) <= '$jahr-$monat' && E_KONTO = '$e_konto'" );
        \end_layout
            \begin_layout Plain Layout
        // echo "SELECT SUM( BETRAG ) AS SUMME FROM WEG_WG_DEF WHERE KOS_TYP = '$kos_typ' && KOS_ID = '$kos_id' && AKTUELL = '1' && ( ENDE = '0000-00-00'
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_WPLAN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_WPLAN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `JAHR` varchar(4) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `OBJEKT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=55 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
PLAN_ID 
\end_layout
\begin_layout Description
JAHR 
\end_layout
\begin_layout Description
OBJEKT_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PLAN_ID FROM WEG_WPLAN WHERE AKTUELL='1' && JAHR='$vorjahr' && OBJEKT_ID='$objekt_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($row) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM WEG_WPLAN_ZEILEN WHERE WPLAN_ID='$vorplan_id' && AKTUELL='1' && KOSTENKONTO='$kostenkonto' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return nummer_punkt2komma ( $row ['BETRAG'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN WHERE AKTUELL='1' && OBJEKT_ID='$objekt_id' ORDER BY JAHR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN WHERE AKTUELL='1' ORDER BY JAHR DESC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT JAHR FROM WEG_WPLAN WHERE AKTUELL='1' && PLAN_ID='$wp_id' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN_ZEILEN WHERE AKTUELL='1' && WPLAN_ID='$wplan_id' ORDER BY KOSTENKONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM WEG_WPLAN_ZEILEN WHERE AKTUELL='1' && WPLAN_ID='$wplan_id' && KOSTENKONTO='$konto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WPLAN VALUES (NULL, '$id', '$wjahr', '$objekt_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WPLAN_ZEILEN VALUES (NULL, '$id', '$wp_id', '$kostenkonto', '$betrag' , '$betrag_vj' , '$formel', '$wirt_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_WPLAN_ZEILEN SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT PLAN_ID FROM WEG_WPLAN WHERE AKTUELL='1' && JAHR='$wjahr' && OBJEKT_ID='$objekt_id'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN WHERE PLAN_ID='$wp_id' && AKTUELL='1' ORDER BY DAT DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_WPLAN_ZEILEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_WPLAN_ZEILEN` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WPLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKONTO` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG_VJ` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `FORMEL` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WIRT_ID` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=806 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
WPLAN_ID 
\end_layout
\begin_layout Description
KOSTENKONTO 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
BETRAG_VJ 
\end_layout
\begin_layout Description
FORMEL 
\end_layout
\begin_layout Description
WIRT_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT BETRAG FROM WEG_WPLAN_ZEILEN WHERE WPLAN_ID='$vorplan_id' && AKTUELL='1' && KOSTENKONTO='$kostenkonto' LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        return nummer_punkt2komma ( $row ['BETRAG'] );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM WEG_WPLAN_ZEILEN WHERE AKTUELL='1' && WPLAN_ID='$wplan_id' ORDER BY KOSTENKONTO ASC" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows > 0) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT SUM(BETRAG) AS BETRAG FROM WEG_WPLAN_ZEILEN WHERE AKTUELL='1' && WPLAN_ID='$wplan_id' && KOSTENKONTO='$konto'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WEG_WPLAN_ZEILEN VALUES (NULL, '$id', '$wp_id', '$kostenkonto', '$betrag' , '$betrag_vj' , '$formel', '$wirt_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', '0', $last_dat );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WEG_WPLAN_ZEILEN SET AKTUELL='0' WHERE DAT='$dat'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_weg.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'WEG_WPLAN_ZEILEN', $dat, $dat );
        \end_layout
            \begin_layout Plain Layout
        return true;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WEG_WPLAN_ZEILEN1_ALT
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WEG_WPLAN_ZEILEN1_ALT` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `WPLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENKONTO` varchar(20) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BETRAG` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_TYP` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOS_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GENKEY_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=231 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
WPLAN_ID 
\end_layout
\begin_layout Description
KOSTENKONTO 
\end_layout
\begin_layout Description
BETRAG 
\end_layout
\begin_layout Description
KOS_TYP 
\end_layout
\begin_layout Description
KOS_ID 
\end_layout
\begin_layout Description
GENKEY_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
WERKZEUGE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WERKZEUGE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BELEG_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `POS` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ARTIKEL_NR` varchar(100) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `MENGE` decimal(10,2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KURZINFO` varchar(255) COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german1_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1261 DEFAULT CHARSET=latin1 COLLATE=latin1_german1_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BELEG_ID 
\end_layout
\begin_layout Description
POS 
\end_layout
\begin_layout Description
ARTIKEL_NR 
\end_layout
\begin_layout Description
MENGE 
\end_layout
\begin_layout Description
KURZINFO 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
DATUM 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WERKZEUGE VALUES(NULL, '$l_id', '$beleg_id', '$pos', '$art_nr', '1', '', NULL, NULL, '1')";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE ARTIKEL_NR='$art_nr' && BELEG_ID='$beleg_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID='$b_id' ORDER BY ID, ARTIKEL_NR, ID, KURZINFO";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE AKTUELL='1' && BENUTZER_ID IS NOT NULL ORDER BY BENUTZER_ID, ARTIKEL_NR";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET AKTUELL='0' WHERE AKTUELL='1' && ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID=NULL WHERE AKTUELL='1' && ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID=NULL WHERE AKTUELL='1' && BENUTZER_ID='$b_id'";
        \end_layout
            \begin_layout Plain Layout
        // echo $db_abfrage;
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "UPDATE WERKZEUGE SET BENUTZER_ID='$b_id' WHERE ID='$w_id' && AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_werkzeug.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM WERKZEUGE WHERE ID='$w_id' ORDER BY DAT";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WIRT_EINHEITEN
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WIRT_EINHEITEN` (

\end_layout
\begin_layout Plain Layout

  `W_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `W_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `W_NAME` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`W_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=122 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
W_DAT 
\end_layout
\begin_layout Description
W_ID 
\end_layout
\begin_layout Description
W_NAME 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT LTRIM(RTRIM(W_NAME)) FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    ajax_info.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_NAME FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_ID, W_NAME FROM `WIRT_EINHEITEN` WHERE `AKTUELL`='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT.*, HAUS.* FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ORDER BY LENGTH(EINHEIT.EINHEIT_KURZNAME) ASC, EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && EINHEIT.TYP='$typ' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_ID  FROM `WIRT_EINHEITEN` WHERE  WIRT_EINHEITEN.AKTUELL='1' &&  WIRT_EINHEITEN.W_NAME='$w_name' ORDER BY W_DAT DESC LIMIT 0,1 ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && EINHEIT.TYP='Gewerbe' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN`  WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' LIMIT 0,1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EINHEITEN VALUES (NULL, '$last_w_id', '$w_name',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        /* Protokollieren */
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id' && EINHEIT_ID='$e_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_buchen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT W_NAME FROM WIRT_EINHEITEN WHERE AKTUELL='1' ORDER BY W_NAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        // echo "<meta content=\"text/html; charset=ISO-8859-1\" http-equiv=\"content-type\">";
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
WIRT_EIN_TAB
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `WIRT_EIN_TAB` (

\end_layout
\begin_layout Plain Layout

  `WZ_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `WZ_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `W_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `EINHEIT_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`WZ_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=7129 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
WZ_DAT 
\end_layout
\begin_layout Description
WZ_ID 
\end_layout
\begin_layout Description
W_ID 
\end_layout
\begin_layout Description
EINHEIT_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EIN_TAB` WHERE `W_ID` ='$w_id' AND `EINHEIT_ID` ='$einheit_id' AND `AKTUELL` = '1' LIMIT 0 , 1";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT EINHEIT.*, HAUS.* FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ORDER BY LENGTH(EINHEIT.EINHEIT_KURZNAME) ASC, EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT * FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' && EINHEIT.TYP='$typ' ORDER BY EINHEIT.EINHEIT_KURZNAME ASC";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1' ";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT SUM(EINHEIT_QM) AS G_QM  FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && EINHEIT.TYP='Gewerbe' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  W_NAME FROM `WIRT_EINHEITEN` JOIN WIRT_EIN_TAB ON (WIRT_EINHEITEN.W_ID=WIRT_EIN_TAB.W_ID) JOIN EINHEIT ON (EINHEIT.EINHEIT_ID=WIRT_EIN_TAB.EINHEIT_ID) JOIN HAUS ON (HAUS.HAUS_ID=EINHEIT.HAUS_ID) WHERE  WIRT_EINHEITEN.AKTUELL='1' && WIRT_EIN_TAB.AKTUELL='1' && WIRT_EINHEITEN.W_ID='$w_id' && EINHEIT.EINHEIT_AKTUELL='1' && HAUS_AKTUELL='1'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT  WZ_DAT FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EIN_TAB VALUES (NULL, '$last_wtab_id', '$w_id', '$import_aus', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EIN_TAB VALUES (NULL, '$last_wtab_id', '$w_id', '$ein_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO WIRT_EIN_TAB VALUES (NULL, '$last_wtab_id', '$w_id', '$ein_id', '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT WHERE EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT WHERE HAUS_ID='$haus_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT EINHEIT_ID, EINHEIT_KURZNAME  FROM EINHEIT JOIN HAUS ON(HAUS.HAUS_ID=EINHEIT.HAUS_ID) JOIN OBJEKT ON(HAUS.OBJEKT_ID=OBJEKT.OBJEKT_ID) WHERE OBJEKT.OBJEKT_ID='$objekt_id' && EINHEIT_AKTUELL='1' && EINHEIT_ID NOT IN (SELECT EINHEIT_ID FROM WIRT_EIN_TAB WHERE AKTUELL='1' && W_ID='$w_id') GROUP BY EINHEIT_ID ORDER BY EINHEIT_KURZNAME ASC" );
        \end_layout
            \begin_layout Plain Layout
        while ( $row = mysql_fetch_assoc ( $result ) )
        \end_layout
            \begin_layout Plain Layout
        $einheiten_array [] = $row;
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wirtschafts_e.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "DELETE FROM WIRT_EIN_TAB WHERE W_ID='$w_id' && EINHEIT_ID='$e_id'";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        header ( "Location: ?daten=bk&option=wirt_einheiten_hinzu&w_id=$w_id" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
W_GERAETE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_GERAETE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GERAETE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUPPE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BEZEICHNUNG` varchar(50) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HERSTELLER` varchar(50) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BAUJAHR` varchar(4) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `LAGE_RAUM` varchar(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_TYP` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `KOSTENTRAEGER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `RECHNUNG_AN` mediumtext CHARACTER SET utf8 COLLATE utf8_bin NOT NULL,

\end_layout
\begin_layout Plain Layout

  `INTERVAL_M` int(3) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `GERAETE_ID` (`GERAETE_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `GRUPPE_ID` (`GRUPPE_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_TYP` (`KOSTENTRAEGER_TYP`),

\end_layout
\begin_layout Plain Layout

  KEY `KOSTENTRAEGER_ID` (`KOSTENTRAEGER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=1554 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
GERAETE_ID 
\end_layout
\begin_layout Description
GRUPPE_ID 
\end_layout
\begin_layout Description
BEZEICHNUNG 
\end_layout
\begin_layout Description
HERSTELLER 
\end_layout
\begin_layout Description
BAUJAHR 
\end_layout
\begin_layout Description
LAGE_RAUM 
\end_layout
\begin_layout Description
KOSTENTRAEGER_TYP 
\end_layout
\begin_layout Description
KOSTENTRAEGER_ID 
\end_layout
\begin_layout Description
RECHNUNG_AN 
\end_layout
\begin_layout Description
INTERVAL_M 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $sql = "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')";
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        function ndurchgefuehrte_wartungen($monat, $jahr, $plan_id) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT WARTUNGSPLAN.`PLAN_ID`, IM_EINSATZ, `PLAN_BEZEICHNUNG`, `INTERVALL_NAME`, `FAKTOR`, W_GERAETE.GERAETE_ID, HERSTELLER, W_GERAETE.BEZEICHNUNG FROM `WARTUNGSPLAN` join (WARTUNG_ZUWEISUNG, W_GERAETE) ON (WARTUNG_ZUWEISUNG.PLAN_ID=WARTUNGSPLAN.PLAN_ID && WARTUNG_ZUWEISUNG.GERAETE_ID=W_GERAETE.GERAETE_ID) WHERE DATE_FORMAT(IM_EINSATZ, '%m') = '01' && W_GERAETE.GERAETE_ID NOT IN (SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGSDATUM, '%Y') = '2010')" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "select W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT(W_GERAETE.IM_EINSATZ,'%d.%m.%Y') IM_EINSATZ, LAGE_TYP, LAGE_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        from W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        LEFT OUTER JOIN WARTUNG_ZUWEISUNG on (W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID)
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT GERAETE_ID FROM WARTUNGEN WHERE DATE_FORMAT(WARTUNGEN.WARTUNGSDATUM, '%Y') = YEAR(NOW()) OR DATE_FORMAT(WARTUNGEN.WARTUNGSDATUM, '%Y') = YEAR(NOW())-1 && WARTUNGEN.PLAN_ID='$plan_id' && WARTUNGEN.AKTUELL='1'
        \end_layout
            \begin_layout Plain Layout
        )
        \end_layout
            \begin_layout Plain Layout
        ORDER BY LAGE_TYP ASC, LAGE_ID ASC , W_GERAETE.IM_EINSATZ ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) AS IM_EINSATZ, DATE_FORMAT( WARTUNGSDATUM, '%d.%m.%Y' ) AS L_WARTUNG, DATE_FORMAT( DATE_ADD( WARTUNGSDATUM, INTERVAL $this->intervall $this->intervall_period ) , '%d.%m.%Y' ) AS N_WARTUNG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) AS IM_EINSATZ, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( " SELECT W_GERAETE.GERAETE_ID, W_GERAETE.BAUJAHR, W_GERAETE.BEZEICHNUNG, W_GERAETE.HERSTELLER, DATE_FORMAT( W_GERAETE.IM_EINSATZ, '%d.%m.%Y' ) IM_EINSATZ, KOSTENTRAEGER_TYP,KOSTENTRAEGER_ID, WARTUNG_ZUWEISUNG.PLAN_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_GERAETE
        \end_layout
            \begin_layout Plain Layout
        LEFT OUTER JOIN WARTUNG_ZUWEISUNG ON ( W_GERAETE.GERAETE_ID = WARTUNG_ZUWEISUNG.GERAETE_ID )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `W_GERAETE` WHERE `GERAETE_ID` ='$geraet_id'   AND `AKTUELL` = '1'  LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO W_GERAETE VALUES (NULL, '$geraete_id', '$bezeichnung', '$hersteller','$baujahr', '$eingebaut', '$kostentraeger_typ', '$kostentraeger_id',  '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        protokollieren ( 'W_GERAETE', $last_dat, '0' );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT GERAETE_ID FROM W_GERAETE WHERE AKTUELL='1' ORDER BY GERAETE_ID DESC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $row = mysql_fetch_assoc ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT W_GERAETE.GERAETE_ID  FROM W_GERAETE JOIN WARTUNG_ZUWEISUNG ON(W_GERAETE.GERAETE_ID=WARTUNG_ZUWEISUNG.GERAETE_ID) WHERE WARTUNG_ZUWEISUNG.PLAN_ID='$plan_id' && WARTUNG_ZUWEISUNG.AKTUELL='1' && W_GERAETE.AKTUELL='1' ORDER BY KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM  `W_GERAETE` WHERE  `LAGE_RAUM` =  '$lage' AND  `AKTUELL` =  '1'" );
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        if ($numrows) {
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "SELECT (SELECT PARTNER_NAME FROM PARTNER_LIEFERANT WHERE PARTNER_ID=W_GERAETE.KOSTENTRAEGER_ID && AKTUELL='1' ORDER BY PARTNER_DAT DESC LIMIT 0,1) AS PART, `GERAETE_ID`, LAGE_RAUM AS EINBAUORT, HERSTELLER, BEZEICHNUNG, KOSTENTRAEGER_TYP, KOSTENTRAEGER_ID, `INTERVAL_M`, DATE_FORMAT(NOW(),'%Y-%m-%d') as HEUTE, DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -INTERVAL_M MONTH),'%Y-%m-%d') AS L_WART_FAELLIG, (SELECT DATUM FROM GEO_TERMINE WHERE GERAETE_ID=W_GERAETE.GERAETE_ID && AKTUELL='1' ORDER BY DATUM DESC LIMIT 0,1) AS L_WART FROM `W_GERAETE` WHERE `AKTUELL`='1' && GRUPPE_ID='$gruppen_id' && `KOSTENTRAEGER_TYP`='Partner' && (`KOSTENTRAEGER_ID`='3' or `KOSTENTRAEGER_ID`='947' or `KOSTENTRAEGER_ID`='986' or `KOSTENTRAEGER_ID`='661' or `KOSTENTRAEGER_ID`='1148' or `KOSTENTRAEGER_ID`='974') &&
        \end_layout
            \begin_layout Plain Layout
        GERAETE_ID NOT IN
        \end_layout
            \begin_layout Plain Layout
        (SELECT GERAETE_ID FROM GEO_TERMINE WHERE AKTUELL='1' && (DATUM>=DATE_FORMAT(DATE_ADD(DATE_FORMAT(NOW(),'%Y-%m-%d'), INTERVAL -(INTERVAL_M-$monate_plus_int) MONTH),'%Y-%m-%d') AND DATUM <= DATE_FORMAT(NOW(),'%Y-%m-%d')) )
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
W_GRUPPE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_GRUPPE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `GRUPPE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUPPE` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEAM_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `GRUPPE_ID` (`GRUPPE_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `GRUPPE` (`GRUPPE`),

\end_layout
\begin_layout Plain Layout

  KEY `TEAM_ID` (`TEAM_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=14 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
GRUPPE_ID 
\end_layout
\begin_layout Description
GRUPPE 
\end_layout
\begin_layout Description
TEAM_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
W_TEAMS
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_TEAMS` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `TEAM_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEAM_BEZ` varchar(50) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `TEAM_ID` (`TEAM_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
TEAM_ID 
\end_layout
\begin_layout Description
TEAM_BEZ 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
W_TEAMS_BENUTZER
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_TEAMS_BENUTZER` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TEAM_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `TEAM_ID` (`TEAM_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=73 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
TEAM_ID 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
W_TEAM_PROFILE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_TEAM_PROFILE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(11) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `1` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `2` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `3` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `4` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `5` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `6` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `7` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `VON` time NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BIS` time NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TERMINE_TAG` int(2) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `START_ADRESSE` varchar(100) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTIV` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`),

\end_layout
\begin_layout Plain Layout

  KEY `1` (`1`),

\end_layout
\begin_layout Plain Layout

  KEY `2` (`2`),

\end_layout
\begin_layout Plain Layout

  KEY `4` (`4`),

\end_layout
\begin_layout Plain Layout

  KEY `5` (`5`),

\end_layout
\begin_layout Plain Layout

  KEY `3` (`3`),

\end_layout
\begin_layout Plain Layout

  KEY `6` (`6`),

\end_layout
\begin_layout Plain Layout

  KEY `7` (`7`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTUELL` (`AKTUELL`),

\end_layout
\begin_layout Plain Layout

  KEY `AKTIV` (`AKTIV`),

\end_layout
\begin_layout Plain Layout

  KEY `BENUTZER_ID` (`BENUTZER_ID`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=24 DEFAULT CHARSET=latin1

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
ID 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
1 
\end_layout
\begin_layout Description
2 
\end_layout
\begin_layout Description
3 
\end_layout
\begin_layout Description
4 
\end_layout
\begin_layout Description
5 
\end_layout
\begin_layout Description
6 
\end_layout
\begin_layout Description
7 
\end_layout
\begin_layout Description
VON 
\end_layout
\begin_layout Description
BIS 
\end_layout
\begin_layout Description
TERMINE_TAG 
\end_layout
\begin_layout Description
START_ADRESSE 
\end_layout
\begin_layout Description
AKTIV 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout


\end_layout
\begin_layout Subsection
W_TERMINE
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `W_TERMINE` (

\end_layout
\begin_layout Plain Layout

  `DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `PLAN_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DATUM_FAELLIG` date NOT NULL,

\end_layout
\begin_layout Plain Layout

  `TERMIN` datetime NOT NULL,

\end_layout
\begin_layout Plain Layout

  `DAUER_MIN` varchar(3) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `GERAETE_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGESAGT` enum('0','1') COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGESAGT_AM` date DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `ABGESAGT_VON` enum('Kunde','Wartungsfirma') COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `GRUND` varchar(200) COLLATE latin1_german2_ci DEFAULT '',

\end_layout
\begin_layout Plain Layout

  `ABSAGE_AUFGENOMMEN` int(7) DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `ABSAGE_RECHTZEITIG` enum('0','1') COLLATE latin1_german2_ci DEFAULT NULL,

\end_layout
\begin_layout Plain Layout

  `AKTUELL` enum('0','1') COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
DAT 
\end_layout
\begin_layout Description
PLAN_ID 
\end_layout
\begin_layout Description
DATUM_FAELLIG 
\end_layout
\begin_layout Description
TERMIN 
\end_layout
\begin_layout Description
DAUER_MIN 
\end_layout
\begin_layout Description
GERAETE_ID 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
ABGESAGT 
\end_layout
\begin_layout Description
ABGESAGT_AM 
\end_layout
\begin_layout Description
ABGESAGT_VON 
\end_layout
\begin_layout Description
GRUND 
\end_layout
\begin_layout Description
ABSAGE_AUFGENOMMEN 
\end_layout
\begin_layout Description
ABSAGE_RECHTZEITIG 
\end_layout
\begin_layout Description
AKTUELL 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        SELECT GERAETE_ID
        \end_layout
            \begin_layout Plain Layout
        FROM W_TERMINE
        \end_layout
            \begin_layout Plain Layout
        WHERE DATE_FORMAT( TERMIN, '%Y' ) = YEAR( NOW( ) ) && PLAN_ID = '$plan_id' && AKTUELL='1' && ABGESAGT='0')
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT * FROM `W_TERMINE` WHERE DATE_FORMAT( TERMIN, '%Y-%m-%d' ) = '$datum_sql'  && DATE_FORMAT( TERMIN, '%H:%i' )= '$zeit' && BENUTZER_ID='$benutzer_id' && PLAN_ID='$plan_id' && ABGESAGT='0'" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATE_FORMAT(TERMIN, '%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN, '%H:%i') AS ZEIT, BENUTZER_ID FROM `W_TERMINE` WHERE GERAETE_ID='$geraete_id' && DATE_FORMAT( TERMIN, '%Y' ) = YEAR( NOW( ) )  && PLAN_ID='$plan_id'  && ABGESAGT='0'  && TERMIN >NOW()  ORDER BY TERMIN DESC LIMIT 0,1" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(TERMIN,'%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT FROM W_TERMINE WHERE PLAN_ID='$plan_id' && BENUTZER_ID='$benutzer_id' && DATE_FORMAT(TERMIN,'%Y-%m-%d') BETWEEN '$ab' AND '$bis' ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        } else {
        \end_layout
            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(TERMIN,'%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT FROM W_TERMINE WHERE PLAN_ID='$plan_id' && DATE_FORMAT(TERMIN,'%Y-%m-%d') BETWEEN '$ab' AND '$bis' ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT *, DATE_FORMAT(TERMIN,'%d.%m.%Y') AS DATUM, DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT FROM W_TERMINE WHERE PLAN_ID='$plan_id' && DATE_FORMAT(TERMIN,'%Y-%m-%d') BETWEEN '$ab' AND '$bis' ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $result = mysql_query ( "SELECT DATE_FORMAT(TERMIN,'%H:%i') AS ZEIT, GERAETE_ID, ABGESAGT, DAUER_MIN FROM `W_TERMINE` WHERE DATE_FORMAT( TERMIN, '%Y-%m-%d' ) = '$datum_sql'  &&  BENUTZER_ID='$benutzer_id' && AKTUELL='1' && PLAN_ID='$plan_id'   ORDER BY TERMIN ASC" );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        $numrows = mysql_numrows ( $result );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO W_TERMINE VALUES (NULL, '$plan_id', '$termin_dat_zeit', '$dauer','$geraete_id', '$benutzer_id', '0', NULL, NULL,NULL,NULL, NULL, '1')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout
    \begin_layout Paragraph
    class_wartungen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $last_dat = mysql_insert_id ();
        \end_layout
            \begin_layout Plain Layout
        // protokollieren('W_TERMINE', $last_dat, '0');
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout
\begin_layout Subsection
ZUGRIFF_ERROR
\end_layout

\begin_layout Subsubsection
Data Definition
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

CREATE TABLE `ZUGRIFF_ERROR` (

\end_layout
\begin_layout Plain Layout

  `Z_DAT` int(7) NOT NULL AUTO_INCREMENT,

\end_layout
\begin_layout Plain Layout

  `BENUTZER_ID` int(7) NOT NULL,

\end_layout
\begin_layout Plain Layout

  `NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `ZEIT` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

\end_layout
\begin_layout Plain Layout

  `MODUL_NAME` varchar(50) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `IP` varchar(15) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  `HOST` varchar(100) COLLATE latin1_german2_ci NOT NULL,

\end_layout
\begin_layout Plain Layout

  PRIMARY KEY (`Z_DAT`)

\end_layout
\begin_layout Plain Layout

) ENGINE=MyISAM AUTO_INCREMENT=604 DEFAULT CHARSET=latin1 COLLATE=latin1_german2_ci

\end_layout

\end_inset
\end_layout

\begin_layout Subsubsection
Attributes
\end_layout

\begin_layout Description
Z_DAT 
\end_layout
\begin_layout Description
BENUTZER_ID 
\end_layout
\begin_layout Description
NAME 
\end_layout
\begin_layout Description
ZEIT 
\end_layout
\begin_layout Description
MODUL_NAME 
\end_layout
\begin_layout Description
IP 
\end_layout
\begin_layout Description
HOST 
\end_layout

\begin_layout Subsubsection
Usages in Code
\end_layout

    \begin_layout Paragraph
    allgemeine_funktionen.php
    \end_layout
    \begin_layout Standard
    \begin_inset listings
    inline false
    status open

            \begin_layout Plain Layout
        $db_abfrage = "INSERT INTO ZUGRIFF_ERROR VALUES(NULL, '$benutzer_id','$wer', NULL, '$module_name', '$ip', '$host')";
        \end_layout
            \begin_layout Plain Layout
        $resultat = mysql_query ( $db_abfrage ) or die ( mysql_error () );
        \end_layout
            \begin_layout Plain Layout
        }
        \end_layout
            \begin_layout Plain Layout
        
        \end_layout
        \end_inset
    \end_layout

\end_layout

\end_body
\end_document